2022-02-23 15:56:58.319688 (MainThread): Running with dbt=1.0.1
2022-02-23 15:56:58.480207 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-02-23 15:56:58.491794 (MainThread): Tracking: tracking
2022-02-23 15:56:58.500915 (MainThread): 15:56:58  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffb078d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefe7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefe7490>]}
2022-02-23 15:56:58.501355 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-02-23 15:56:58.501628 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-02-23 15:56:58.501770 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-02-23 15:57:04.449720 (Thread-13): handling status request
2022-02-23 15:57:04.450174 (Thread-13): 15:57:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefe0250>]}
2022-02-23 15:57:04.450785 (Thread-13): sending response (<Response 361 bytes [200 OK]>) to 10.0.6.248
2022-02-23 15:57:04.654527 (Thread-14): handling status request
2022-02-23 15:57:04.654898 (Thread-14): 15:57:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefa6490>]}
2022-02-23 15:57:04.655313 (Thread-14): sending response (<Response 361 bytes [200 OK]>) to 10.0.31.140
2022-02-23 15:57:04.795516 (Thread-15): handling ps request
2022-02-23 15:57:04.795899 (Thread-15): 15:57:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefa67c0>]}
2022-02-23 15:57:04.796378 (Thread-15): sending response (<Response 105 bytes [200 OK]>) to 10.0.18.116
2022-02-23 15:57:04.816905 (Thread-16): handling status request
2022-02-23 15:57:04.817322 (Thread-16): 15:57:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefa6910>]}
2022-02-23 15:57:04.817748 (Thread-16): sending response (<Response 361 bytes [200 OK]>) to 10.0.31.140
2022-02-23 15:57:06.691235 (Thread-17): handling status request
2022-02-23 15:57:06.691637 (Thread-17): 15:57:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefa6d00>]}
2022-02-23 15:57:06.692089 (Thread-17): sending response (<Response 339 bytes [200 OK]>) to 10.0.34.45
2022-02-23 15:57:07.009678 (Thread-18): handling status request
2022-02-23 15:57:07.010092 (Thread-18): 15:57:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefa6fa0>]}
2022-02-23 15:57:07.010643 (Thread-18): sending response (<Response 361 bytes [200 OK]>) to 10.0.38.187
2022-02-23 15:57:07.963639 (Thread-19): handling status request
2022-02-23 15:57:07.964025 (Thread-19): 15:57:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefb7280>]}
2022-02-23 15:57:07.964457 (Thread-19): sending response (<Response 339 bytes [200 OK]>) to 10.0.34.45
2022-02-23 15:57:10.240830 (Thread-20): handling status request
2022-02-23 15:57:10.241279 (Thread-20): 15:57:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefe0b20>]}
2022-02-23 15:57:10.241712 (Thread-20): sending response (<Response 339 bytes [200 OK]>) to 10.0.34.45
2022-02-23 15:57:14.515136 (Thread-21): handling status request
2022-02-23 15:57:14.515512 (Thread-21): 15:57:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefb77c0>]}
2022-02-23 15:57:14.515931 (Thread-21): sending response (<Response 339 bytes [200 OK]>) to 10.0.34.45
2022-02-23 15:57:39.045063 (Thread-22): handling status request
2022-02-23 15:57:39.046786 (Thread-22): 15:57:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '4ae35ece-2d38-4e06-b33f-c01a1b45b9e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbffefb7a60>]}
2022-02-23 15:57:39.047253 (Thread-22): sending response (<Response 361 bytes [200 OK]>) to 10.0.10.60
2022-02-23 16:40:32.290994 (MainThread): Running with dbt=1.0.1
2022-02-23 16:40:32.447556 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-02-23 16:40:32.450243 (MainThread): Tracking: tracking
2022-02-23 16:40:32.459153 (MainThread): 16:40:32  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d19070f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d16f749a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d16f74a90>]}
2022-02-23 16:40:32.459537 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=21
2022-02-23 16:40:32.459803 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-02-23 16:40:32.459967 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-02-23 16:40:35.512844 (Thread-13): handling status request
2022-02-23 16:40:35.513271 (Thread-13): 16:40:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0213a0>]}
2022-02-23 16:40:35.513869 (Thread-13): sending response (<Response 361 bytes [200 OK]>) to 10.0.26.218
2022-02-23 16:40:35.673405 (Thread-14): handling status request
2022-02-23 16:40:35.673778 (Thread-14): 16:40:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d021670>]}
2022-02-23 16:40:35.674270 (Thread-14): sending response (<Response 361 bytes [200 OK]>) to 10.0.30.15
2022-02-23 16:40:35.696026 (Thread-15): handling status request
2022-02-23 16:40:35.696289 (Thread-15): 16:40:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0219a0>]}
2022-02-23 16:40:35.696653 (Thread-15): sending response (<Response 361 bytes [200 OK]>) to 10.0.12.68
2022-02-23 16:40:35.745228 (Thread-16): handling ps request
2022-02-23 16:40:35.745521 (Thread-16): 16:40:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d021c40>]}
2022-02-23 16:40:35.745943 (Thread-16): sending response (<Response 105 bytes [200 OK]>) to 10.0.19.0
2022-02-23 16:40:37.146143 (Thread-17): handling status request
2022-02-23 16:40:37.146533 (Thread-17): 16:40:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d021d90>]}
2022-02-23 16:40:37.146958 (Thread-17): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:40:37.777680 (Thread-18): handling status request
2022-02-23 16:40:37.778106 (Thread-18): 16:40:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046190>]}
2022-02-23 16:40:37.778539 (Thread-18): sending response (<Response 361 bytes [200 OK]>) to 10.0.7.232
2022-02-23 16:40:38.727363 (Thread-19): handling status request
2022-02-23 16:40:38.727752 (Thread-19): 16:40:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046460>]}
2022-02-23 16:40:38.728177 (Thread-19): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:40:41.000675 (Thread-20): handling status request
2022-02-23 16:40:41.002340 (Thread-20): 16:40:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046700>]}
2022-02-23 16:40:41.002826 (Thread-20): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:40:50.702676 (Thread-21): handling status request
2022-02-23 16:40:50.703062 (Thread-21): 16:40:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0469a0>]}
2022-02-23 16:40:50.703489 (Thread-21): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:40:51.977595 (Thread-22): handling status request
2022-02-23 16:40:51.979222 (Thread-22): 16:40:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d005820>]}
2022-02-23 16:40:51.979656 (Thread-22): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:40:54.294761 (Thread-23): handling status request
2022-02-23 16:40:54.295259 (Thread-23): 16:40:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046ee0>]}
2022-02-23 16:40:54.295773 (Thread-23): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:42:43.623294 (Thread-24): handling status request
2022-02-23 16:42:43.625035 (Thread-24): 16:42:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d005820>]}
2022-02-23 16:42:43.625488 (Thread-24): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:42:44.901734 (Thread-25): handling status request
2022-02-23 16:42:44.902170 (Thread-25): 16:42:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d005850>]}
2022-02-23 16:42:44.902609 (Thread-25): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:42:47.176303 (Thread-26): handling status request
2022-02-23 16:42:47.176681 (Thread-26): 16:42:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cf89700>]}
2022-02-23 16:42:47.177101 (Thread-26): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:42:51.439270 (Thread-27): handling status request
2022-02-23 16:42:51.439697 (Thread-27): 16:42:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046fa0>]}
2022-02-23 16:42:51.440133 (Thread-27): sending response (<Response 339 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:43:33.909186 (Thread-28): handling status request
2022-02-23 16:43:33.911080 (Thread-28): 16:43:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d140e1d30>]}
2022-02-23 16:43:33.911593 (Thread-28): sending response (<Response 361 bytes [200 OK]>) to 10.0.36.42
2022-02-23 16:43:34.197487 (Thread-29): handling status request
2022-02-23 16:43:34.197878 (Thread-29): 16:43:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046f70>]}
2022-02-23 16:43:34.198374 (Thread-29): sending response (<Response 361 bytes [200 OK]>) to 10.0.7.232
2022-02-23 16:43:34.297512 (Thread-30): handling cli_args request
2022-02-23 16:43:34.297887 (Thread-30): 16:43:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046550>]}
2022-02-23 16:43:34.298354 (Thread-30): sending response (<Response 681 bytes [200 OK]>) to 10.0.30.15
2022-02-23 16:43:41.735419 (Thread-31): handling status request
2022-02-23 16:43:41.735797 (Thread-31): 16:43:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046640>]}
2022-02-23 16:43:41.736236 (Thread-31): sending response (<Response 361 bytes [200 OK]>) to 10.0.31.140
2022-02-23 16:43:41.887303 (Thread-32): handling status request
2022-02-23 16:43:41.887673 (Thread-32): 16:43:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0460a0>]}
2022-02-23 16:43:41.888149 (Thread-32): sending response (<Response 361 bytes [200 OK]>) to 10.0.44.46
2022-02-23 16:43:52.108934 (Thread-33): handling status request
2022-02-23 16:43:52.109302 (Thread-33): 16:43:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d021dc0>]}
2022-02-23 16:43:52.109752 (Thread-33): sending response (<Response 361 bytes [200 OK]>) to 10.0.10.118
2022-02-23 16:43:52.643132 (Thread-34): handling deps request
2022-02-23 16:43:52.643535 (Thread-34): 16:43:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d021580>]}
2022-02-23 16:43:52.689308 (Thread-34): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.29
2022-02-23 16:43:52.846183 (Thread-35): handling status request
2022-02-23 16:43:52.846624 (Thread-35): 16:43:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cf898e0>]}
2022-02-23 16:43:52.847270 (Thread-35): sending response (<Response 185 bytes [200 OK]>) to 10.0.8.111
2022-02-23 16:43:53.227141 (Thread-36): handling poll request
2022-02-23 16:43:53.227538 (Thread-36): 16:43:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cf89f10>]}
2022-02-23 16:43:53.228152 (Thread-36): sending response (<Response 286 bytes [200 OK]>) to 10.0.22.63
2022-02-23 16:43:54.356299 (Thread-37): handling status request
2022-02-23 16:43:54.356699 (Thread-37): 16:43:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d046310>]}
2022-02-23 16:43:54.357129 (Thread-37): sending response (<Response 185 bytes [200 OK]>) to 10.0.22.63
2022-02-23 16:43:54.771016 (MainThread): 16:43:54  Set downloads directory='/tmp/dbt-downloads-che_nqjp'
2022-02-23 16:43:54.771542 (MainThread): 16:43:54  Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-02-23 16:43:54.788263 (MainThread): 16:43:54  Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-02-23 16:43:54.788496 (MainThread): 16:43:54  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-02-23 16:43:54.879014 (MainThread): 16:43:54  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-02-23 16:43:54.895510 (MainThread): 16:43:54  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-02-23 16:43:54.985892 (MainThread): 16:43:54  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-02-23 16:43:54.986207 (MainThread): 16:43:54  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-02-23 16:43:55.075599 (MainThread): 16:43:55  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-02-23 16:43:55.092002 (MainThread): 16:43:55  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-02-23 16:43:55.103282 (Thread-38): handling poll request
2022-02-23 16:43:55.103602 (Thread-38): 16:43:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0055b0>]}
2022-02-23 16:43:55.104160 (Thread-38): sending response (<Response 3560 bytes [200 OK]>) to 10.0.10.118
2022-02-23 16:43:55.182641 (MainThread): 16:43:55  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-02-23 16:43:55.183015 (MainThread): 16:43:55  Installing dbt-labs/dbt_utils
2022-02-23 16:43:56.337541 (Thread-39): handling status request
2022-02-23 16:43:56.337959 (Thread-39): 16:43:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0053d0>]}
2022-02-23 16:43:56.338398 (Thread-39): sending response (<Response 185 bytes [200 OK]>) to 10.0.31.140
2022-02-23 16:43:56.543134 (Thread-40): handling poll request
2022-02-23 16:43:56.543513 (Thread-40): 16:43:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfaf580>]}
2022-02-23 16:43:56.544033 (Thread-40): sending response (<Response 892 bytes [200 OK]>) to 10.0.7.232
2022-02-23 16:43:57.900046 (Thread-41): handling status request
2022-02-23 16:43:57.900412 (Thread-41): 16:43:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfaf4c0>]}
2022-02-23 16:43:57.924439 (Thread-41): sending response (<Response 185 bytes [200 OK]>) to 10.0.36.42
2022-02-23 16:43:57.989791 (Thread-42): handling poll request
2022-02-23 16:43:57.990162 (Thread-42): 16:43:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfaf7f0>]}
2022-02-23 16:43:57.990613 (Thread-42): sending response (<Response 287 bytes [200 OK]>) to 10.0.12.68
2022-02-23 16:43:59.516251 (Thread-43): handling poll request
2022-02-23 16:43:59.516644 (Thread-43): 16:43:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfafbe0>]}
2022-02-23 16:43:59.517176 (Thread-43): sending response (<Response 287 bytes [200 OK]>) to 10.0.22.63
2022-02-23 16:43:59.538054 (Thread-44): handling status request
2022-02-23 16:43:59.538307 (Thread-44): 16:43:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfafdc0>]}
2022-02-23 16:43:59.538639 (Thread-44): sending response (<Response 185 bytes [200 OK]>) to 10.0.44.46
2022-02-23 16:43:59.607901 (MainThread): 16:43:59    Installed from version 0.8.0
2022-02-23 16:43:59.608072 (MainThread): 16:43:59    Updated version available: 0.8.1
2022-02-23 16:43:59.608235 (MainThread): 16:43:59  Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a76c46b7-66d1-451b-81c7-35174c777458', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b59e0820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b59e0a30>]}
2022-02-23 16:43:59.608467 (MainThread): 16:43:59  
2022-02-23 16:43:59.608549 (MainThread): 16:43:59  Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-02-23 16:43:59.785137 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:43:59  Partial parse save file not found. Starting full parse.
2022-02-23 16:43:59.785445 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:43:59  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfc0700>]}
2022-02-23 16:44:00.193576 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/get_payment_type_description.sql
2022-02-23 16:44:00.194614 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters.sql
2022-02-23 16:44:00.218753 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/etc.sql
2022-02-23 16:44:00.221646 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/catalog.sql
2022-02-23 16:44:00.230027 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/table.sql
2022-02-23 16:44:00.235541 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/seed.sql
2022-02-23 16:44:00.239014 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/incremental.sql
2022-02-23 16:44:00.262237 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/copy.sql
2022-02-23 16:44:00.266189 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/snapshot.sql
2022-02-23 16:44:00.268793 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/view.sql
2022-02-23 16:44:00.272102 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters/metadata.sql
2022-02-23 16:44:00.281405 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters/columns.sql
2022-02-23 16:44:00.297012 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters/freshness.sql
2022-02-23 16:44:00.299823 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters/persist_docs.sql
2022-02-23 16:44:00.303994 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters/relation.sql
2022-02-23 16:44:00.313060 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters/schema.sql
2022-02-23 16:44:00.315159 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/adapters/indexes.sql
2022-02-23 16:44:00.317767 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/get_custom_name/get_custom_schema.sql
2022-02-23 16:44:00.320146 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/get_custom_name/get_custom_alias.sql
2022-02-23 16:44:00.321569 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/get_custom_name/get_custom_database.sql
2022-02-23 16:44:00.323104 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/etc/datetime.sql
2022-02-23 16:44:00.331067 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/etc/statement.sql
2022-02-23 16:44:00.335268 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/generic_test_sql/unique.sql
2022-02-23 16:44:00.335976 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/generic_test_sql/not_null.sql
2022-02-23 16:44:00.336530 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/generic_test_sql/accepted_values.sql
2022-02-23 16:44:00.337857 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/generic_test_sql/relationships.sql
2022-02-23 16:44:00.338747 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/configs.sql
2022-02-23 16:44:00.340967 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/hooks.sql
2022-02-23 16:44:00.344664 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/table/table.sql
2022-02-23 16:44:00.351734 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/table/create_table_as.sql
2022-02-23 16:44:00.354518 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-02-23 16:44:00.357030 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/view/helpers.sql
2022-02-23 16:44:00.358356 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/view/create_view_as.sql
2022-02-23 16:44:00.360546 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/view/view.sql
2022-02-23 16:44:00.367252 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/incremental/incremental.sql
2022-02-23 16:44:00.376732 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-02-23 16:44:00.391270 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-02-23 16:44:00.392701 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/incremental/merge.sql
2022-02-23 16:44:00.403209 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-02-23 16:44:00.407458 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/seeds/helpers.sql
2022-02-23 16:44:00.422777 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/seeds/seed.sql
2022-02-23 16:44:00.428465 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/tests/helpers.sql
2022-02-23 16:44:00.430240 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/tests/test.sql
2022-02-23 16:44:00.434473 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/tests/where_subquery.sql
2022-02-23 16:44:00.436231 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/snapshots/helpers.sql
2022-02-23 16:44:00.446969 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/snapshots/strategies.sql
2022-02-23 16:44:00.463454 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-02-23 16:44:00.465027 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/snapshots/snapshot.sql
2022-02-23 16:44:00.475801 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing tests/generic/builtin.sql
2022-02-23 16:44:00.478743 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/pivot.sql
2022-02-23 16:44:00.482545 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/star.sql
2022-02-23 16:44:00.486350 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/surrogate_key.sql
2022-02-23 16:44:00.489626 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/get_query_results_as_dict.sql
2022-02-23 16:44:00.491852 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/date_spine.sql
2022-02-23 16:44:00.496272 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/get_column_values.sql
2022-02-23 16:44:00.501539 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/groupby.sql
2022-02-23 16:44:00.502864 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-02-23 16:44:00.508658 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/nullcheck_table.sql
2022-02-23 16:44:00.510235 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-02-23 16:44:00.511822 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/get_relations_by_pattern.sql
2022-02-23 16:44:00.515052 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/get_relations_by_prefix.sql
2022-02-23 16:44:00.518269 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/safe_add.sql
2022-02-23 16:44:00.519846 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/haversine_distance.sql
2022-02-23 16:44:00.525493 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/unpivot.sql
2022-02-23 16:44:00.532905 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/generate_series.sql
2022-02-23 16:44:00.536997 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/nullcheck.sql
2022-02-23 16:44:00.538644 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/sql/union.sql
2022-02-23 16:44:00.546439 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/materializations/insert_by_period_materialization.sql
2022-02-23 16:44:00.569163 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/jinja_helpers/pretty_time.sql
2022-02-23 16:44:00.570469 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/jinja_helpers/slugify.sql
2022-02-23 16:44:00.571633 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/jinja_helpers/log_info.sql
2022-02-23 16:44:00.572727 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-02-23 16:44:00.573809 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/web/get_url_parameter.sql
2022-02-23 16:44:00.575347 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/web/get_url_path.sql
2022-02-23 16:44:00.577775 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/web/get_url_host.sql
2022-02-23 16:44:00.579671 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/expression_is_true.sql
2022-02-23 16:44:00.581435 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/not_constant.sql
2022-02-23 16:44:00.582688 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/sequential_values.sql
2022-02-23 16:44:00.585348 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/not_null_proportion.sql
2022-02-23 16:44:00.587460 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/at_least_one.sql
2022-02-23 16:44:00.588699 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/equality.sql
2022-02-23 16:44:00.592165 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/test_not_null_where.sql
2022-02-23 16:44:00.593561 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/equal_rowcount.sql
2022-02-23 16:44:00.595180 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/not_accepted_values.sql
2022-02-23 16:44:00.597173 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/test_unique_where.sql
2022-02-23 16:44:00.598623 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/mutually_exclusive_ranges.sql
2022-02-23 16:44:00.606862 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/relationships_where.sql
2022-02-23 16:44:00.608944 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/accepted_range.sql
2022-02-23 16:44:00.611311 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/fewer_rows_than.sql
2022-02-23 16:44:00.612901 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/unique_combination_of_columns.sql
2022-02-23 16:44:00.615587 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/recency.sql
2022-02-23 16:44:00.617288 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/schema_tests/cardinality_equality.sql
2022-02-23 16:44:00.619211 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/split_part.sql
2022-02-23 16:44:00.620974 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/length.sql
2022-02-23 16:44:00.622275 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/current_timestamp.sql
2022-02-23 16:44:00.625684 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/right.sql
2022-02-23 16:44:00.627877 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/hash.sql
2022-02-23 16:44:00.629304 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/replace.sql
2022-02-23 16:44:00.631007 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/cast_bool_to_text.sql
2022-02-23 16:44:00.633045 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/concat.sql
2022-02-23 16:44:00.634318 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/_is_relation.sql
2022-02-23 16:44:00.635916 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/identifier.sql
2022-02-23 16:44:00.638218 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/datediff.sql
2022-02-23 16:44:00.651263 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/dateadd.sql
2022-02-23 16:44:00.655790 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/datatypes.sql
2022-02-23 16:44:00.664330 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/position.sql
2022-02-23 16:44:00.665879 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/literal.sql
2022-02-23 16:44:00.666885 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/_is_ephemeral.sql
2022-02-23 16:44:00.669474 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/width_bucket.sql
2022-02-23 16:44:00.674933 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/date_trunc.sql
2022-02-23 16:44:00.677128 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/except.sql
2022-02-23 16:44:00.678876 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/safe_cast.sql
2022-02-23 16:44:00.681941 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/last_day.sql
2022-02-23 16:44:00.686259 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:00  Parsing macros/cross_db_utils/intersect.sql
2022-02-23 16:44:01.027892 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  1699: static parser successfully parsed core/dim_zones.sql
2022-02-23 16:44:01.040248 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  1699: static parser successfully parsed core/dm_monthly_zone_revenue.sql
2022-02-23 16:44:01.043395 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  1699: static parser successfully parsed core/fact_trips.sql
2022-02-23 16:44:01.046532 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  1603: static parser failed on staging/stg_green_tripdata.sql
2022-02-23 16:44:01.076820 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  1602: parser fallback to jinja rendering on staging/stg_green_tripdata.sql
2022-02-23 16:44:01.078716 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  1603: static parser failed on staging/stg_yellow_tripdata.sql
2022-02-23 16:44:01.086662 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  1602: parser fallback to jinja rendering on staging/stg_yellow_tripdata.sql
2022-02-23 16:44:01.283238 (b0f1ec95-e956-412c-b058-bad1fd494b9d-handler-deps): 16:44:01  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd130100>]}
2022-02-23 16:44:01.323430 (Thread-45): handling poll request
2022-02-23 16:44:01.323784 (Thread-45): 16:44:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd130a00>]}
2022-02-23 16:44:01.324376 (Thread-45): sending response (<Response 2076 bytes [200 OK]>) to 10.0.19.0
2022-02-23 16:44:01.603050 (Thread-46): handling status request
2022-02-23 16:44:01.603421 (Thread-46): 16:44:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd130be0>]}
2022-02-23 16:44:01.603992 (Thread-46): sending response (<Response 5780 bytes [200 OK]>) to 10.0.36.42
2022-02-23 16:44:02.398699 (Thread-47): handling status request
2022-02-23 16:44:02.399134 (Thread-47): 16:44:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0b2610>]}
2022-02-23 16:44:02.399820 (Thread-47): sending response (<Response 5780 bytes [200 OK]>) to 10.0.36.42
2022-02-23 16:44:03.372613 (Thread-48): handling status request
2022-02-23 16:44:03.372984 (Thread-48): 16:44:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd1298e0>]}
2022-02-23 16:44:03.373571 (Thread-48): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:03.379695 (Thread-49): handling list request
2022-02-23 16:44:03.379950 (Thread-49): 16:44:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd129d60>]}
2022-02-23 16:44:03.407417 (Thread-49): 16:44:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0b2610>]}
2022-02-23 16:44:03.407723 (Thread-49): 16:44:03  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:44:03.411255 (Thread-49): sending response (<Response 8310 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:16.232827 (Thread-50): handling status request
2022-02-23 16:44:16.233189 (Thread-50): 16:44:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd126100>]}
2022-02-23 16:44:16.234062 (Thread-50): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:16.263642 (Thread-51): handling list request
2022-02-23 16:44:16.263952 (Thread-51): 16:44:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d140ba1c0>]}
2022-02-23 16:44:16.296494 (Thread-51): 16:44:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd1948b0>]}
2022-02-23 16:44:16.296827 (Thread-51): 16:44:16  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:44:16.300270 (Thread-51): sending response (<Response 8287 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:17.908630 (Thread-52): handling status request
2022-02-23 16:44:17.909018 (Thread-52): 16:44:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0fe7c0>]}
2022-02-23 16:44:17.909612 (Thread-52): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:17.915545 (Thread-53): handling list request
2022-02-23 16:44:17.915831 (Thread-53): 16:44:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0fe4c0>]}
2022-02-23 16:44:17.950317 (Thread-53): 16:44:17  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0fa940>]}
2022-02-23 16:44:17.950697 (Thread-53): 16:44:17  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:44:17.954150 (Thread-53): sending response (<Response 8310 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:32.624718 (Thread-54): handling status request
2022-02-23 16:44:32.625095 (Thread-54): 16:44:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd130a60>]}
2022-02-23 16:44:32.625897 (Thread-54): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:32.632098 (Thread-55): handling list request
2022-02-23 16:44:32.632350 (Thread-55): 16:44:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd130940>]}
2022-02-23 16:44:32.677641 (Thread-55): 16:44:32  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0e5370>]}
2022-02-23 16:44:32.678065 (Thread-55): 16:44:32  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:44:32.683199 (Thread-55): sending response (<Response 8310 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:35.959205 (Thread-56): handling status request
2022-02-23 16:44:35.959607 (Thread-56): 16:44:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0ab4c0>]}
2022-02-23 16:44:35.960190 (Thread-56): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:44:35.973018 (Thread-57): handling list request
2022-02-23 16:44:35.973259 (Thread-57): 16:44:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0a9460>]}
2022-02-23 16:44:36.004423 (Thread-57): 16:44:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0fe130>]}
2022-02-23 16:44:36.004710 (Thread-57): 16:44:36  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:44:36.009365 (Thread-57): sending response (<Response 8287 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:45:35.564674 (Thread-58): handling status request
2022-02-23 16:45:35.566709 (Thread-58): 16:45:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc057040>]}
2022-02-23 16:45:35.568473 (Thread-58): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:45:35.582842 (Thread-59): handling list request
2022-02-23 16:45:35.583124 (Thread-59): 16:45:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0e5f10>]}
2022-02-23 16:45:35.630408 (Thread-59): 16:45:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc09d5e0>]}
2022-02-23 16:45:35.631008 (Thread-59): 16:45:35  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:45:35.641057 (Thread-59): sending response (<Response 8287 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:45:53.650087 (Thread-60): handling status request
2022-02-23 16:45:53.650451 (Thread-60): 16:45:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc057220>]}
2022-02-23 16:45:53.651030 (Thread-60): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:45:53.664085 (Thread-61): handling list request
2022-02-23 16:45:53.664362 (Thread-61): 16:45:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd0902b0>]}
2022-02-23 16:45:53.700582 (Thread-61): 16:45:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc057c10>]}
2022-02-23 16:45:53.700927 (Thread-61): 16:45:53  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:45:53.704561 (Thread-61): sending response (<Response 8287 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:46:19.208497 (Thread-62): handling status request
2022-02-23 16:46:19.208872 (Thread-62): 16:46:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc04f4f0>]}
2022-02-23 16:46:19.231854 (Thread-62): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:46:19.237977 (Thread-63): handling list request
2022-02-23 16:46:19.238230 (Thread-63): 16:46:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd090ca0>]}
2022-02-23 16:46:19.276932 (Thread-63): 16:46:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc04ff10>]}
2022-02-23 16:46:19.277202 (Thread-63): 16:46:19  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:46:19.281537 (Thread-63): sending response (<Response 8310 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:03.233458 (Thread-64): handling status request
2022-02-23 16:49:03.235135 (Thread-64): 16:49:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc051070>]}
2022-02-23 16:49:03.235762 (Thread-64): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:03.261308 (Thread-65): handling list request
2022-02-23 16:49:03.261596 (Thread-65): 16:49:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc051a60>]}
2022-02-23 16:49:03.304740 (Thread-65): 16:49:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd090a90>]}
2022-02-23 16:49:03.305136 (Thread-65): 16:49:03  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:49:03.314145 (Thread-65): sending response (<Response 8126 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:23.426211 (Thread-66): handling status request
2022-02-23 16:49:23.426598 (Thread-66): 16:49:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8e7defa0>]}
2022-02-23 16:49:23.427394 (Thread-66): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:23.434214 (Thread-67): handling list request
2022-02-23 16:49:23.434482 (Thread-67): 16:49:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8e7de430>]}
2022-02-23 16:49:23.473793 (Thread-67): 16:49:23  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78a640>]}
2022-02-23 16:49:23.474178 (Thread-67): 16:49:23  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:49:23.481315 (Thread-67): sending response (<Response 8126 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:31.290706 (Thread-68): handling status request
2022-02-23 16:49:31.291096 (Thread-68): 16:49:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78e550>]}
2022-02-23 16:49:31.291705 (Thread-68): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:31.298967 (Thread-69): handling list request
2022-02-23 16:49:31.299224 (Thread-69): 16:49:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78e850>]}
2022-02-23 16:49:31.333114 (Thread-69): 16:49:31  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc051d90>]}
2022-02-23 16:49:31.333492 (Thread-69): 16:49:31  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:49:31.339087 (Thread-69): sending response (<Response 14576 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:34.962990 (Thread-70): handling status request
2022-02-23 16:49:34.963358 (Thread-70): 16:49:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c7a6970>]}
2022-02-23 16:49:34.963931 (Thread-70): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:49:34.969659 (Thread-71): handling list request
2022-02-23 16:49:34.969901 (Thread-71): 16:49:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c7a6490>]}
2022-02-23 16:49:35.000305 (Thread-71): 16:49:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78e0d0>]}
2022-02-23 16:49:35.000595 (Thread-71): 16:49:35  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:49:35.005723 (Thread-71): sending response (<Response 14576 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:53:51.054501 (Thread-72): handling status request
2022-02-23 16:53:51.056376 (Thread-72): 16:53:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f91c0>]}
2022-02-23 16:53:51.056995 (Thread-72): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:53:51.073307 (Thread-73): handling list request
2022-02-23 16:53:51.073651 (Thread-73): 16:53:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f94c0>]}
2022-02-23 16:53:51.120097 (Thread-73): 16:53:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c7b72b0>]}
2022-02-23 16:53:51.120478 (Thread-73): 16:53:51  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:53:51.131644 (Thread-73): sending response (<Response 8310 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:54:00.425469 (Thread-74): handling status request
2022-02-23 16:54:00.425848 (Thread-74): 16:54:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c7b79d0>]}
2022-02-23 16:54:00.426497 (Thread-74): sending response (<Response 5780 bytes [200 OK]>) to 10.0.12.68
2022-02-23 16:54:00.621372 (Thread-75): handling status request
2022-02-23 16:54:00.621750 (Thread-75): 16:54:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8e7de430>]}
2022-02-23 16:54:00.622369 (Thread-75): sending response (<Response 5780 bytes [200 OK]>) to 10.0.18.116
2022-02-23 16:54:00.864286 (Thread-76): handling cli_args request
2022-02-23 16:54:00.864669 (Thread-76): 16:54:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdc051220>]}
2022-02-23 16:54:02.997359 (Thread-76): sending response (<Response 138 bytes [200 OK]>) to 10.0.7.232
2022-02-23 16:54:03.445204 (Thread-77): handling poll request
2022-02-23 16:54:03.445691 (Thread-77): 16:54:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c760040>]}
2022-02-23 16:54:03.446513 (Thread-77): sending response (<Response 286 bytes [200 OK]>) to 10.0.31.140
2022-02-23 16:54:03.615046 (MainThread): 16:54:03  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 16:54:03.615501 (MainThread): 16:54:03  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 16:54:03.622983 (MainThread): 16:54:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4ed15ac-59f6-4ee4-a10e-7a4cbf20f3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf9d86d8e0>]}
2022-02-23 16:54:03.656984 (MainThread): 16:54:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4ed15ac-59f6-4ee4-a10e-7a4cbf20f3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf9d920880>]}
2022-02-23 16:54:03.657233 (MainThread): 16:54:03  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:54:03.658789 (MainThread): 16:54:03  
2022-02-23 16:54:03.659095 (MainThread): 16:54:03  Acquiring new bigquery connection "master"
2022-02-23 16:54:03.660070 (ThreadPoolExecutor-0_0): 16:54:03  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 16:54:03.660222 (ThreadPoolExecutor-0_0): 16:54:03  Opening a new connection, currently in state init
2022-02-23 16:54:03.935511 (ThreadPoolExecutor-0_0): 16:54:03  Acquiring new bigquery connection "create_dtc-de-339117_dbt_orukosueva"
2022-02-23 16:54:03.935795 (ThreadPoolExecutor-0_0): 16:54:03  Acquiring new bigquery connection "create_dtc-de-339117_dbt_orukosueva"
2022-02-23 16:54:03.935906 (ThreadPoolExecutor-0_0): 16:54:03  BigQuery adapter: Creating schema "dtc-de-339117.dbt_orukosueva".
2022-02-23 16:54:03.936018 (ThreadPoolExecutor-0_0): 16:54:03  Opening a new connection, currently in state closed
2022-02-23 16:54:04.945713 (Thread-78): handling poll request
2022-02-23 16:54:04.946167 (Thread-78): 16:54:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78f730>]}
2022-02-23 16:54:04.946875 (Thread-78): sending response (<Response 4627 bytes [200 OK]>) to 10.0.7.232
2022-02-23 16:54:05.460569 (ThreadPoolExecutor-1_0): 16:54:05  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 16:54:05.460755 (ThreadPoolExecutor-1_0): 16:54:05  Opening a new connection, currently in state closed
2022-02-23 16:54:05.693478 (MainThread): 16:54:05  Concurrency: 4 threads (target='default')
2022-02-23 16:54:05.693650 (MainThread): 16:54:05  
2022-02-23 16:54:05.696601 (Thread-1): 16:54:05  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 16:54:05.696910 (Thread-1): 16:54:05  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 16:54:05.697185 (Thread-1): 16:54:05  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 16:54:05.697285 (Thread-1): 16:54:05  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 16:54:05.697378 (Thread-1): 16:54:05  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 16:54:05.700496 (Thread-1): 16:54:05  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 16:54:05.700741 (Thread-2): 16:54:05  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 16:54:05.700978 (Thread-2): 16:54:05  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 16:54:05.701245 (Thread-2): 16:54:05  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 16:54:05.701335 (Thread-2): 16:54:05  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 16:54:05.701417 (Thread-2): 16:54:05  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 16:54:05.705835 (Thread-3): 16:54:05  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 16:54:05.706091 (Thread-3): 16:54:05  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 16:54:05.706353 (Thread-3): 16:54:05  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 16:54:05.706443 (Thread-3): 16:54:05  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 16:54:05.706528 (Thread-3): 16:54:05  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 16:54:05.725474 (Thread-2): 16:54:05  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 16:54:05.731197 (Thread-3): 16:54:05  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 16:54:05.754949 (Thread-1): 16:54:05  finished collecting timing info
2022-02-23 16:54:05.755095 (Thread-1): 16:54:05  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 16:54:05.781419 (Thread-3): 16:54:05  finished collecting timing info
2022-02-23 16:54:05.781567 (Thread-3): 16:54:05  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 16:54:05.790487 (Thread-1): 16:54:05  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 16:54:05.790703 (Thread-2): 16:54:05  finished collecting timing info
2022-02-23 16:54:05.790842 (Thread-2): 16:54:05  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 16:54:05.813899 (Thread-2): 16:54:05  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 16:54:05.812543 (Thread-3): 16:54:05  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 16:54:05.846788 (Thread-1): 16:54:05  Opening a new connection, currently in state closed
2022-02-23 16:54:05.851267 (Thread-2): 16:54:05  Opening a new connection, currently in state init
2022-02-23 16:54:05.851678 (Thread-1): 16:54:05  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 16:54:05.855325 (Thread-3): 16:54:05  Opening a new connection, currently in state init
2022-02-23 16:54:05.856764 (Thread-2): 16:54:05  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `production`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 16:54:05.859775 (Thread-3): 16:54:05  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `production`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 16:54:06.166824 (Thread-2): 16:54:06  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('The project production has not enabled BigQuery.')
2022-02-23 16:54:06.167405 (Thread-1): 16:54:06  BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 16:54:06.167535 (Thread-1): 16:54:06  BigQuery adapter: 404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6

Location: europe-west6
Job ID: 0c00293f-1eaf-4097-97c0-3dc00613ea0c

2022-02-23 16:54:06.167712 (Thread-1): 16:54:06  finished collecting timing info
2022-02-23 16:54:06.168077 (Thread-1): 16:54:06  Runtime Error in model dim_zones (models/core/dim_zones.sql)
  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
  
  Location: europe-west6
  Job ID: 0c00293f-1eaf-4097-97c0-3dc00613ea0c
  
2022-02-23 16:54:06.168282 (Thread-1): 16:54:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ed15ac-59f6-4ee4-a10e-7a4cbf20f3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf9c65e250>]}
2022-02-23 16:54:06.168620 (Thread-1): 16:54:06  1 of 5 ERROR creating table model dbt_orukosueva.dim_zones...................... [ERROR in 0.47s]
2022-02-23 16:54:06.168740 (Thread-1): 16:54:06  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 16:54:06.188823 (Thread-3): 16:54:06  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('The project production has not enabled BigQuery.')
2022-02-23 16:54:06.470422 (Thread-79): handling poll request
2022-02-23 16:54:06.470800 (Thread-79): 16:54:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8e7f5340>]}
2022-02-23 16:54:06.471850 (Thread-79): sending response (<Response 24027 bytes [200 OK]>) to 10.0.38.29
2022-02-23 16:54:07.438789 (Thread-3): 16:54:07  finished collecting timing info
2022-02-23 16:54:07.439242 (Thread-3): 16:54:07  Database Error in model stg_yellow_tripdata (models/staging/stg_yellow_tripdata.sql)
  The project production has not enabled BigQuery.
  compiled SQL at target/run/taxi_rides_ny/models/staging/stg_yellow_tripdata.sql
2022-02-23 16:54:07.439436 (Thread-3): 16:54:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ed15ac-59f6-4ee4-a10e-7a4cbf20f3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf9c65ea00>]}
2022-02-23 16:54:07.439920 (Thread-3): 16:54:07  3 of 5 ERROR creating view model dbt_orukosueva.stg_yellow_tripdata............. [ERROR in 1.73s]
2022-02-23 16:54:07.440049 (Thread-3): 16:54:07  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 16:54:07.443925 (Thread-2): 16:54:07  finished collecting timing info
2022-02-23 16:54:07.444262 (Thread-2): 16:54:07  Database Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  The project production has not enabled BigQuery.
  compiled SQL at target/run/taxi_rides_ny/models/staging/stg_green_tripdata.sql
2022-02-23 16:54:07.444423 (Thread-2): 16:54:07  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ed15ac-59f6-4ee4-a10e-7a4cbf20f3a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf9c7b9e50>]}
2022-02-23 16:54:07.444948 (Thread-2): 16:54:07  2 of 5 ERROR creating view model dbt_orukosueva.stg_green_tripdata.............. [ERROR in 1.74s]
2022-02-23 16:54:07.445143 (Thread-2): 16:54:07  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 16:54:07.446024 (Thread-4): 16:54:07  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 16:54:07.446207 (Thread-4): 16:54:07  4 of 5 SKIP relation dbt_orukosueva.fact_trips.................................. [SKIP]
2022-02-23 16:54:07.446317 (Thread-4): 16:54:07  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 16:54:07.446971 (Thread-3): 16:54:07  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 16:54:07.447121 (Thread-3): 16:54:07  5 of 5 SKIP relation dbt_orukosueva.dm_monthly_zone_revenue..................... [SKIP]
2022-02-23 16:54:07.447214 (Thread-3): 16:54:07  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 16:54:07.448484 (MainThread): 16:54:07  Acquiring new bigquery connection "master"
2022-02-23 16:54:07.448804 (MainThread): 16:54:07  
2022-02-23 16:54:07.448901 (MainThread): 16:54:07  Finished running 3 table models, 2 view models in 3.79s.
2022-02-23 16:54:07.448984 (MainThread): 16:54:07  Connection 'master' was properly closed.
2022-02-23 16:54:07.449051 (MainThread): 16:54:07  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 16:54:07.449114 (MainThread): 16:54:07  Connection 'model.taxi_rides_ny.stg_green_tripdata' was properly closed.
2022-02-23 16:54:07.449175 (MainThread): 16:54:07  Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
2022-02-23 16:54:07.496716 (MainThread): 16:54:07  
2022-02-23 16:54:07.496876 (MainThread): 16:54:07  Completed with 3 errors and 0 warnings:
2022-02-23 16:54:07.496964 (MainThread): 16:54:07  
2022-02-23 16:54:07.497052 (MainThread): 16:54:07  Runtime Error in model dim_zones (models/core/dim_zones.sql)
2022-02-23 16:54:07.497128 (MainThread): 16:54:07    404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
2022-02-23 16:54:07.497195 (MainThread): 16:54:07    
2022-02-23 16:54:07.497259 (MainThread): 16:54:07    Location: europe-west6
2022-02-23 16:54:07.497321 (MainThread): 16:54:07    Job ID: 0c00293f-1eaf-4097-97c0-3dc00613ea0c
2022-02-23 16:54:07.497381 (MainThread): 16:54:07    
2022-02-23 16:54:07.497448 (MainThread): 16:54:07  
2022-02-23 16:54:07.497520 (MainThread): 16:54:07  Database Error in model stg_yellow_tripdata (models/staging/stg_yellow_tripdata.sql)
2022-02-23 16:54:07.497587 (MainThread): 16:54:07    The project production has not enabled BigQuery.
2022-02-23 16:54:07.497646 (MainThread): 16:54:07    compiled SQL at target/run/taxi_rides_ny/models/staging/stg_yellow_tripdata.sql
2022-02-23 16:54:07.497712 (MainThread): 16:54:07  
2022-02-23 16:54:07.497782 (MainThread): 16:54:07  Database Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
2022-02-23 16:54:07.497845 (MainThread): 16:54:07    The project production has not enabled BigQuery.
2022-02-23 16:54:07.497906 (MainThread): 16:54:07    compiled SQL at target/run/taxi_rides_ny/models/staging/stg_green_tripdata.sql
2022-02-23 16:54:07.498014 (MainThread): 16:54:07  
2022-02-23 16:54:07.498090 (MainThread): 16:54:07  Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
2022-02-23 16:54:07.902351 (Thread-80): handling poll request
2022-02-23 16:54:07.902776 (Thread-80): 16:54:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8e7eb880>]}
2022-02-23 16:54:07.904687 (Thread-80): sending response (<Response 48473 bytes [200 OK]>) to 10.0.26.218
2022-02-23 16:54:08.934208 (Thread-81): handling status request
2022-02-23 16:54:08.934580 (Thread-81): 16:54:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c743850>]}
2022-02-23 16:54:08.935234 (Thread-81): sending response (<Response 5780 bytes [200 OK]>) to 10.0.31.140
2022-02-23 16:54:09.256236 (Thread-82): handling status request
2022-02-23 16:54:09.256621 (Thread-82): 16:54:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c743c40>]}
2022-02-23 16:54:09.257193 (Thread-82): sending response (<Response 5780 bytes [200 OK]>) to 10.0.8.111
2022-02-23 16:54:09.885573 (Thread-83): handling status request
2022-02-23 16:54:09.885965 (Thread-83): 16:54:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c743e80>]}
2022-02-23 16:54:09.886561 (Thread-83): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:54:09.892613 (Thread-84): handling list request
2022-02-23 16:54:09.892861 (Thread-84): 16:54:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c7050a0>]}
2022-02-23 16:54:09.921876 (Thread-84): 16:54:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c7437f0>]}
2022-02-23 16:54:09.922224 (Thread-84): 16:54:09  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:54:09.926056 (Thread-84): sending response (<Response 8310 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:56:58.701424 (Thread-85): handling status request
2022-02-23 16:56:58.703073 (Thread-85): 16:56:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c705b80>]}
2022-02-23 16:56:58.728840 (Thread-85): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:56:58.745196 (Thread-86): handling list request
2022-02-23 16:56:58.745559 (Thread-86): 16:56:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c743d90>]}
2022-02-23 16:56:58.789342 (Thread-86): 16:56:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c705070>]}
2022-02-23 16:56:58.789720 (Thread-86): 16:56:58  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:56:58.799274 (Thread-86): sending response (<Response 8310 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:57:02.757998 (Thread-87): handling status request
2022-02-23 16:57:02.758388 (Thread-87): 16:57:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfa6370>]}
2022-02-23 16:57:02.759079 (Thread-87): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:57:02.772524 (Thread-88): handling list request
2022-02-23 16:57:02.772795 (Thread-88): 16:57:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd1106a0>]}
2022-02-23 16:57:02.806033 (Thread-88): 16:57:02  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c722580>]}
2022-02-23 16:57:02.806342 (Thread-88): 16:57:02  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:57:02.812532 (Thread-88): sending response (<Response 8126 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:57:18.270164 (Thread-89): handling status request
2022-02-23 16:57:18.270536 (Thread-89): 16:57:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c71ba00>]}
2022-02-23 16:57:18.271143 (Thread-89): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 16:57:18.277641 (Thread-90): handling list request
2022-02-23 16:57:18.277966 (Thread-90): 16:57:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c722190>]}
2022-02-23 16:57:18.308723 (Thread-90): 16:57:18  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c705ac0>]}
2022-02-23 16:57:18.309032 (Thread-90): 16:57:18  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 16:57:18.314165 (Thread-90): sending response (<Response 14576 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:05:05.145342 (Thread-91): handling status request
2022-02-23 17:05:05.147124 (Thread-91): 17:05:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6b9910>]}
2022-02-23 17:05:05.147729 (Thread-91): sending response (<Response 5780 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:05:05.513436 (Thread-92): handling status request
2022-02-23 17:05:05.513816 (Thread-92): 17:05:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6b9c10>]}
2022-02-23 17:05:05.514412 (Thread-92): sending response (<Response 5780 bytes [200 OK]>) to 10.0.18.116
2022-02-23 17:05:05.559637 (Thread-93): handling cli_args request
2022-02-23 17:05:05.559890 (Thread-93): 17:05:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6b9e80>]}
2022-02-23 17:05:07.702762 (Thread-93): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:05:08.054447 (MainThread): 17:05:08  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:05:08.054880 (MainThread): 17:05:08  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:05:08.062251 (MainThread): 17:05:08  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44476994-9860-4b33-acc7-40e23e7c5029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5ab637c0>]}
2022-02-23 17:05:08.099345 (MainThread): 17:05:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44476994-9860-4b33-acc7-40e23e7c5029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5ac1efa0>]}
2022-02-23 17:05:08.099630 (MainThread): 17:05:08  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:05:08.101189 (MainThread): 17:05:08  
2022-02-23 17:05:08.101520 (MainThread): 17:05:08  Acquiring new bigquery connection "master"
2022-02-23 17:05:08.102570 (ThreadPoolExecutor-0_0): 17:05:08  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:05:08.102724 (ThreadPoolExecutor-0_0): 17:05:08  Opening a new connection, currently in state init
2022-02-23 17:05:08.131501 (Thread-94): handling poll request
2022-02-23 17:05:08.131906 (Thread-94): 17:05:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f53a0>]}
2022-02-23 17:05:08.132759 (Thread-94): sending response (<Response 3339 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:05:08.382276 (ThreadPoolExecutor-1_0): 17:05:08  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:05:08.382465 (ThreadPoolExecutor-1_0): 17:05:08  Opening a new connection, currently in state closed
2022-02-23 17:05:08.607826 (MainThread): 17:05:08  Concurrency: 4 threads (target='default')
2022-02-23 17:05:08.607996 (MainThread): 17:05:08  
2022-02-23 17:05:08.610732 (Thread-1): 17:05:08  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:05:08.611048 (Thread-1): 17:05:08  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:05:08.611320 (Thread-1): 17:05:08  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:05:08.611423 (Thread-1): 17:05:08  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:05:08.611520 (Thread-1): 17:05:08  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:05:08.614691 (Thread-1): 17:05:08  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:05:08.614933 (Thread-2): 17:05:08  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:05:08.615160 (Thread-2): 17:05:08  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:05:08.615408 (Thread-2): 17:05:08  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:05:08.615494 (Thread-2): 17:05:08  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:05:08.615574 (Thread-2): 17:05:08  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:05:08.620041 (Thread-3): 17:05:08  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:05:08.620262 (Thread-3): 17:05:08  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:05:08.620506 (Thread-3): 17:05:08  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:05:08.620592 (Thread-3): 17:05:08  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:05:08.620672 (Thread-3): 17:05:08  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:05:08.643843 (Thread-2): 17:05:08  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:05:08.649792 (Thread-3): 17:05:08  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:05:08.650279 (Thread-1): 17:05:08  finished collecting timing info
2022-02-23 17:05:08.650442 (Thread-1): 17:05:08  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:05:08.681528 (Thread-1): 17:05:08  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:05:08.687680 (Thread-3): 17:05:08  finished collecting timing info
2022-02-23 17:05:08.687850 (Thread-3): 17:05:08  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:05:08.692882 (Thread-2): 17:05:08  finished collecting timing info
2022-02-23 17:05:08.693036 (Thread-2): 17:05:08  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:05:08.712352 (Thread-3): 17:05:08  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:05:08.714545 (Thread-2): 17:05:08  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:05:08.720521 (Thread-1): 17:05:08  Opening a new connection, currently in state closed
2022-02-23 17:05:08.724866 (Thread-1): 17:05:08  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:05:08.732298 (Thread-3): 17:05:08  Opening a new connection, currently in state init
2022-02-23 17:05:08.732729 (Thread-2): 17:05:08  Opening a new connection, currently in state init
2022-02-23 17:05:08.737006 (Thread-3): 17:05:08  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `production`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:05:08.737949 (Thread-2): 17:05:08  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `production`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:05:09.007197 (Thread-2): 17:05:09  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('The project production has not enabled BigQuery.')
2022-02-23 17:05:09.014433 (Thread-1): 17:05:09  BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:05:09.014594 (Thread-1): 17:05:09  BigQuery adapter: 404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6

Location: europe-west6
Job ID: 2f1be2f6-6634-44d0-b414-ed77acf15e18

2022-02-23 17:05:09.014767 (Thread-1): 17:05:09  finished collecting timing info
2022-02-23 17:05:09.015129 (Thread-1): 17:05:09  Runtime Error in model dim_zones (models/core/dim_zones.sql)
  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
  
  Location: europe-west6
  Job ID: 2f1be2f6-6634-44d0-b414-ed77acf15e18
  
2022-02-23 17:05:09.015317 (Thread-1): 17:05:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44476994-9860-4b33-acc7-40e23e7c5029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a5814bca0>]}
2022-02-23 17:05:09.015659 (Thread-1): 17:05:09  1 of 5 ERROR creating table model dbt_orukosueva.dim_zones...................... [ERROR in 0.40s]
2022-02-23 17:05:09.015781 (Thread-1): 17:05:09  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:05:09.034636 (Thread-3): 17:05:09  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('The project production has not enabled BigQuery.')
2022-02-23 17:05:09.538539 (Thread-95): handling poll request
2022-02-23 17:05:09.538932 (Thread-95): 17:05:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6b9b20>]}
2022-02-23 17:05:09.539924 (Thread-95): sending response (<Response 24027 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:05:09.682269 (Thread-2): 17:05:09  finished collecting timing info
2022-02-23 17:05:09.682836 (Thread-2): 17:05:09  Database Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
  The project production has not enabled BigQuery.
  compiled SQL at target/run/taxi_rides_ny/models/staging/stg_green_tripdata.sql
2022-02-23 17:05:09.683059 (Thread-2): 17:05:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44476994-9860-4b33-acc7-40e23e7c5029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a58152070>]}
2022-02-23 17:05:09.683553 (Thread-2): 17:05:09  2 of 5 ERROR creating view model dbt_orukosueva.stg_green_tripdata.............. [ERROR in 1.07s]
2022-02-23 17:05:09.683668 (Thread-2): 17:05:09  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:05:10.296023 (Thread-3): 17:05:10  finished collecting timing info
2022-02-23 17:05:10.296452 (Thread-3): 17:05:10  Database Error in model stg_yellow_tripdata (models/staging/stg_yellow_tripdata.sql)
  The project production has not enabled BigQuery.
  compiled SQL at target/run/taxi_rides_ny/models/staging/stg_yellow_tripdata.sql
2022-02-23 17:05:10.296633 (Thread-3): 17:05:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44476994-9860-4b33-acc7-40e23e7c5029', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a58152d00>]}
2022-02-23 17:05:10.297104 (Thread-3): 17:05:10  3 of 5 ERROR creating view model dbt_orukosueva.stg_yellow_tripdata............. [ERROR in 1.68s]
2022-02-23 17:05:10.297217 (Thread-3): 17:05:10  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:05:10.298168 (Thread-4): 17:05:10  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:05:10.298376 (Thread-4): 17:05:10  4 of 5 SKIP relation dbt_orukosueva.fact_trips.................................. [SKIP]
2022-02-23 17:05:10.298489 (Thread-4): 17:05:10  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:05:10.299272 (Thread-2): 17:05:10  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:05:10.299463 (Thread-2): 17:05:10  5 of 5 SKIP relation dbt_orukosueva.dm_monthly_zone_revenue..................... [SKIP]
2022-02-23 17:05:10.299568 (Thread-2): 17:05:10  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:05:10.300810 (MainThread): 17:05:10  Acquiring new bigquery connection "master"
2022-02-23 17:05:10.301116 (MainThread): 17:05:10  
2022-02-23 17:05:10.301212 (MainThread): 17:05:10  Finished running 3 table models, 2 view models in 2.20s.
2022-02-23 17:05:10.301293 (MainThread): 17:05:10  Connection 'master' was properly closed.
2022-02-23 17:05:10.301360 (MainThread): 17:05:10  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:05:10.301434 (MainThread): 17:05:10  Connection 'model.taxi_rides_ny.stg_green_tripdata' was properly closed.
2022-02-23 17:05:10.301529 (MainThread): 17:05:10  Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
2022-02-23 17:05:10.388688 (MainThread): 17:05:10  
2022-02-23 17:05:10.388908 (MainThread): 17:05:10  Completed with 3 errors and 0 warnings:
2022-02-23 17:05:10.388999 (MainThread): 17:05:10  
2022-02-23 17:05:10.389087 (MainThread): 17:05:10  Runtime Error in model dim_zones (models/core/dim_zones.sql)
2022-02-23 17:05:10.389163 (MainThread): 17:05:10    404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
2022-02-23 17:05:10.389231 (MainThread): 17:05:10    
2022-02-23 17:05:10.389296 (MainThread): 17:05:10    Location: europe-west6
2022-02-23 17:05:10.389360 (MainThread): 17:05:10    Job ID: 2f1be2f6-6634-44d0-b414-ed77acf15e18
2022-02-23 17:05:10.389422 (MainThread): 17:05:10    
2022-02-23 17:05:10.389489 (MainThread): 17:05:10  
2022-02-23 17:05:10.389560 (MainThread): 17:05:10  Database Error in model stg_green_tripdata (models/staging/stg_green_tripdata.sql)
2022-02-23 17:05:10.389626 (MainThread): 17:05:10    The project production has not enabled BigQuery.
2022-02-23 17:05:10.389688 (MainThread): 17:05:10    compiled SQL at target/run/taxi_rides_ny/models/staging/stg_green_tripdata.sql
2022-02-23 17:05:10.389753 (MainThread): 17:05:10  
2022-02-23 17:05:10.389824 (MainThread): 17:05:10  Database Error in model stg_yellow_tripdata (models/staging/stg_yellow_tripdata.sql)
2022-02-23 17:05:10.389888 (MainThread): 17:05:10    The project production has not enabled BigQuery.
2022-02-23 17:05:10.389989 (MainThread): 17:05:10    compiled SQL at target/run/taxi_rides_ny/models/staging/stg_yellow_tripdata.sql
2022-02-23 17:05:10.390066 (MainThread): 17:05:10  
2022-02-23 17:05:10.390142 (MainThread): 17:05:10  Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
2022-02-23 17:05:11.065885 (Thread-96): handling poll request
2022-02-23 17:05:11.066315 (Thread-96): 17:05:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78f3a0>]}
2022-02-23 17:05:11.068247 (Thread-96): sending response (<Response 48472 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:05:12.234014 (Thread-97): handling status request
2022-02-23 17:05:12.234398 (Thread-97): 17:05:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f9520>]}
2022-02-23 17:05:12.235050 (Thread-97): sending response (<Response 5780 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:05:12.308479 (Thread-98): handling status request
2022-02-23 17:05:12.308802 (Thread-98): 17:05:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f25b0>]}
2022-02-23 17:05:12.309347 (Thread-98): sending response (<Response 5780 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:06:45.882792 (Thread-99): handling status request
2022-02-23 17:06:45.885025 (Thread-99): 17:06:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c7600a0>]}
2022-02-23 17:06:45.885620 (Thread-99): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:06:45.896943 (Thread-100): handling list request
2022-02-23 17:06:45.897277 (Thread-100): 17:06:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78f280>]}
2022-02-23 17:06:45.946374 (Thread-100): 17:06:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f2c40>]}
2022-02-23 17:06:45.946786 (Thread-100): 17:06:45  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:06:45.956981 (Thread-100): sending response (<Response 8289 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:07:12.637707 (Thread-101): handling status request
2022-02-23 17:07:12.638117 (Thread-101): 17:07:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f5190>]}
2022-02-23 17:07:12.638718 (Thread-101): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:07:12.644910 (Thread-102): handling list request
2022-02-23 17:07:12.645181 (Thread-102): 17:07:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f59d0>]}
2022-02-23 17:07:12.686632 (Thread-102): 17:07:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78f700>]}
2022-02-23 17:07:12.686921 (Thread-102): 17:07:12  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:07:12.692612 (Thread-102): sending response (<Response 8128 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:07:26.488604 (Thread-103): handling status request
2022-02-23 17:07:26.488996 (Thread-103): 17:07:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c78f580>]}
2022-02-23 17:07:26.489604 (Thread-103): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:07:26.500616 (Thread-104): handling list request
2022-02-23 17:07:26.500869 (Thread-104): 17:07:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f5e50>]}
2022-02-23 17:07:26.556534 (Thread-104): 17:07:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c68fa90>]}
2022-02-23 17:07:26.557021 (Thread-104): 17:07:26  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:07:26.569767 (Thread-104): 17:07:26  The selection criterion '+logs/dbt.log.legacy+' does not match any nodes
2022-02-23 17:07:26.570061 (Thread-104): 17:07:26  No nodes selected!
2022-02-23 17:07:26.572237 (Thread-104): sending response (<Response 1936 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:07:49.294266 (Thread-105): handling status request
2022-02-23 17:07:49.294630 (Thread-105): 17:07:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c69eb50>]}
2022-02-23 17:07:49.295211 (Thread-105): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:07:49.308410 (Thread-106): handling list request
2022-02-23 17:07:49.308675 (Thread-106): 17:07:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c69ecd0>]}
2022-02-23 17:07:49.344863 (Thread-106): 17:07:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f5e50>]}
2022-02-23 17:07:49.345214 (Thread-106): 17:07:49  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:07:49.354207 (Thread-106): sending response (<Response 14578 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:08:06.261342 (Thread-107): handling status request
2022-02-23 17:08:06.261693 (Thread-107): 17:08:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c70bfa0>]}
2022-02-23 17:08:06.262353 (Thread-107): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:08:06.267799 (Thread-108): handling list request
2022-02-23 17:08:06.268089 (Thread-108): 17:08:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6f2ca0>]}
2022-02-23 17:08:06.327291 (Thread-108): 17:08:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c653430>]}
2022-02-23 17:08:06.327586 (Thread-108): 17:08:06  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:08:06.333696 (Thread-108): sending response (<Response 8128 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:08:20.834213 (Thread-109): handling status request
2022-02-23 17:08:20.834638 (Thread-109): 17:08:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c653a30>]}
2022-02-23 17:08:20.835288 (Thread-109): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:08:20.849712 (Thread-110): handling list request
2022-02-23 17:08:20.850033 (Thread-110): 17:08:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c653e20>]}
2022-02-23 17:08:20.882058 (Thread-110): 17:08:20  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c653a90>]}
2022-02-23 17:08:20.882371 (Thread-110): 17:08:20  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:08:20.885500 (Thread-110): sending response (<Response 8128 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:15:04.316566 (Thread-111): handling status request
2022-02-23 17:15:04.321557 (Thread-111): 17:15:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c65c6d0>]}
2022-02-23 17:15:04.322195 (Thread-111): sending response (<Response 5758 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:15:04.338036 (Thread-112): handling list request
2022-02-23 17:15:04.338310 (Thread-112): 17:15:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c65caf0>]}
2022-02-23 17:15:04.383602 (Thread-112): 17:15:04  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c65c610>]}
2022-02-23 17:15:04.383960 (Thread-112): 17:15:04  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:15:04.413089 (Thread-112): sending response (<Response 8289 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:15:28.829153 (Thread-113): 17:15:28  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-02-23 17:15:28.830206 (Thread-113): 17:15:28  Partial parsing: deleted source source.taxi_rides_ny.staging.green_tripdata
2022-02-23 17:15:28.830527 (Thread-113): 17:15:28  Partial parsing: deleted source source.taxi_rides_ny.staging.yellow_tripdata
2022-02-23 17:15:28.830675 (Thread-113): 17:15:28  Partial parsing: update schema file: taxi_rides_ny://models/staging/schema.yml
2022-02-23 17:15:28.836738 (Thread-113): 17:15:28  1699: static parser successfully parsed core/dm_monthly_zone_revenue.sql
2022-02-23 17:15:28.840581 (Thread-113): 17:15:28  1699: static parser successfully parsed core/fact_trips.sql
2022-02-23 17:15:28.842671 (Thread-113): 17:15:28  1603: static parser failed on staging/stg_green_tripdata.sql
2022-02-23 17:15:28.848584 (Thread-113): 17:15:28  1602: parser fallback to jinja rendering on staging/stg_green_tripdata.sql
2022-02-23 17:15:28.849678 (Thread-113): 17:15:28  1603: static parser failed on staging/stg_yellow_tripdata.sql
2022-02-23 17:15:28.854883 (Thread-113): 17:15:28  1602: parser fallback to jinja rendering on staging/stg_yellow_tripdata.sql
2022-02-23 17:15:29.143214 (Thread-113): 17:15:29  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6b8be0>]}
2022-02-23 17:15:29.557696 (Thread-114): handling status request
2022-02-23 17:15:29.558117 (Thread-114): 17:15:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c66f8e0>]}
2022-02-23 17:15:29.558688 (Thread-114): sending response (<Response 3751 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:15:30.058613 (Thread-115): handling status request
2022-02-23 17:15:30.059006 (Thread-115): 17:15:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c65c700>]}
2022-02-23 17:15:30.059547 (Thread-115): sending response (<Response 3751 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:15:33.132130 (Thread-116): handling status request
2022-02-23 17:15:33.132505 (Thread-116): 17:15:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d04fb20>]}
2022-02-23 17:15:33.133058 (Thread-116): sending response (<Response 3729 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:15:33.139735 (Thread-117): handling list request
2022-02-23 17:15:33.140003 (Thread-117): 17:15:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1408c910>]}
2022-02-23 17:15:33.177518 (Thread-117): 17:15:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c51c130>]}
2022-02-23 17:15:33.177834 (Thread-117): 17:15:33  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:15:33.189863 (Thread-117): 17:15:33  The selection criterion '+logs/dbt.log.legacy+' does not match any nodes
2022-02-23 17:15:33.190053 (Thread-117): 17:15:33  No nodes selected!
2022-02-23 17:15:33.191441 (Thread-117): sending response (<Response 1936 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:15:37.931625 (Thread-118): handling status request
2022-02-23 17:15:37.932005 (Thread-118): 17:15:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0882e0>]}
2022-02-23 17:15:37.932559 (Thread-118): sending response (<Response 3729 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:15:37.939458 (Thread-119): handling list request
2022-02-23 17:15:37.939726 (Thread-119): 17:15:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0651c0>]}
2022-02-23 17:15:37.968587 (Thread-119): 17:15:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0a3880>]}
2022-02-23 17:15:37.968930 (Thread-119): 17:15:37  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:15:37.972378 (Thread-119): sending response (<Response 8289 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:16:06.472586 (Thread-120): handling status request
2022-02-23 17:16:06.472963 (Thread-120): 17:16:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1d0ca280>]}
2022-02-23 17:16:06.473502 (Thread-120): sending response (<Response 3751 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:16:06.887076 (Thread-121): handling status request
2022-02-23 17:16:06.887477 (Thread-121): 17:16:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d140e6910>]}
2022-02-23 17:16:06.888010 (Thread-121): sending response (<Response 3751 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:16:06.908392 (Thread-122): handling cli_args request
2022-02-23 17:16:06.908707 (Thread-122): 17:16:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c65cfd0>]}
2022-02-23 17:16:09.072432 (Thread-122): sending response (<Response 138 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:16:09.434453 (MainThread): 17:16:09  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:16:09.434933 (MainThread): 17:16:09  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:16:09.442014 (MainThread): 17:16:09  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4bb3434-e13a-4b27-b77c-d6f2d780b7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0af602bb0>]}
2022-02-23 17:16:09.481153 (MainThread): 17:16:09  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4bb3434-e13a-4b27-b77c-d6f2d780b7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0aff14b50>]}
2022-02-23 17:16:09.481431 (MainThread): 17:16:09  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:16:09.483000 (MainThread): 17:16:09  
2022-02-23 17:16:09.483312 (MainThread): 17:16:09  Acquiring new bigquery connection "master"
2022-02-23 17:16:09.484340 (ThreadPoolExecutor-0_0): 17:16:09  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:16:09.484499 (ThreadPoolExecutor-0_0): 17:16:09  Opening a new connection, currently in state init
2022-02-23 17:16:09.592515 (Thread-123): handling poll request
2022-02-23 17:16:09.592932 (Thread-123): 17:16:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6088b0>]}
2022-02-23 17:16:09.593826 (Thread-123): sending response (<Response 3339 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:16:10.135348 (ThreadPoolExecutor-1_0): 17:16:10  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:16:10.135545 (ThreadPoolExecutor-1_0): 17:16:10  Opening a new connection, currently in state closed
2022-02-23 17:16:10.372254 (MainThread): 17:16:10  Concurrency: 4 threads (target='default')
2022-02-23 17:16:10.372424 (MainThread): 17:16:10  
2022-02-23 17:16:10.375245 (Thread-1): 17:16:10  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:16:10.375562 (Thread-1): 17:16:10  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:16:10.375838 (Thread-1): 17:16:10  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:16:10.375932 (Thread-1): 17:16:10  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:16:10.376031 (Thread-1): 17:16:10  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:16:10.379046 (Thread-1): 17:16:10  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:16:10.379291 (Thread-2): 17:16:10  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:16:10.379531 (Thread-2): 17:16:10  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:16:10.379794 (Thread-2): 17:16:10  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:16:10.379880 (Thread-2): 17:16:10  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:16:10.379964 (Thread-2): 17:16:10  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:16:10.383985 (Thread-3): 17:16:10  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:16:10.384210 (Thread-3): 17:16:10  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:16:10.384470 (Thread-3): 17:16:10  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:16:10.384556 (Thread-3): 17:16:10  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:16:10.384637 (Thread-3): 17:16:10  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:16:10.406256 (Thread-3): 17:16:10  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:16:10.408894 (Thread-2): 17:16:10  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:16:10.419831 (Thread-1): 17:16:10  finished collecting timing info
2022-02-23 17:16:10.419993 (Thread-1): 17:16:10  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:16:10.450772 (Thread-1): 17:16:10  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:16:10.451052 (Thread-3): 17:16:10  finished collecting timing info
2022-02-23 17:16:10.451212 (Thread-3): 17:16:10  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:16:10.456238 (Thread-2): 17:16:10  finished collecting timing info
2022-02-23 17:16:10.456393 (Thread-2): 17:16:10  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:16:10.479410 (Thread-3): 17:16:10  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:16:10.480228 (Thread-2): 17:16:10  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:16:10.490799 (Thread-1): 17:16:10  Opening a new connection, currently in state closed
2022-02-23 17:16:10.495185 (Thread-1): 17:16:10  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:16:10.503976 (Thread-2): 17:16:10  Opening a new connection, currently in state init
2022-02-23 17:16:10.504371 (Thread-3): 17:16:10  Opening a new connection, currently in state init
2022-02-23 17:16:10.508705 (Thread-2): 17:16:10  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:16:10.509677 (Thread-3): 17:16:10  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:16:10.779663 (Thread-1): 17:16:10  BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:16:10.779844 (Thread-1): 17:16:10  BigQuery adapter: 404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6

Location: europe-west6
Job ID: 8c567fb4-a6ca-41bc-a201-3a8ebf8e88fe

2022-02-23 17:16:10.780013 (Thread-1): 17:16:10  finished collecting timing info
2022-02-23 17:16:10.780374 (Thread-1): 17:16:10  Runtime Error in model dim_zones (models/core/dim_zones.sql)
  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
  
  Location: europe-west6
  Job ID: 8c567fb4-a6ca-41bc-a201-3a8ebf8e88fe
  
2022-02-23 17:16:10.780557 (Thread-1): 17:16:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4bb3434-e13a-4b27-b77c-d6f2d780b7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac4a7070>]}
2022-02-23 17:16:10.781082 (Thread-1): 17:16:10  1 of 5 ERROR creating table model dbt_orukosueva.dim_zones...................... [ERROR in 0.40s]
2022-02-23 17:16:10.781213 (Thread-1): 17:16:10  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:16:11.154338 (Thread-124): handling poll request
2022-02-23 17:16:11.154717 (Thread-124): 17:16:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c44b430>]}
2022-02-23 17:16:11.156110 (Thread-124): sending response (<Response 23212 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:16:11.667834 (Thread-3): 17:16:11  finished collecting timing info
2022-02-23 17:16:11.668260 (Thread-3): 17:16:11  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4bb3434-e13a-4b27-b77c-d6f2d780b7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac4d2a60>]}
2022-02-23 17:16:11.668877 (Thread-3): 17:16:11  3 of 5 OK created view model dbt_orukosueva.stg_yellow_tripdata................. [OK in 1.28s]
2022-02-23 17:16:11.669031 (Thread-3): 17:16:11  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:16:12.428885 (Thread-2): 17:16:12  finished collecting timing info
2022-02-23 17:16:12.429355 (Thread-2): 17:16:12  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4bb3434-e13a-4b27-b77c-d6f2d780b7ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac4a7a00>]}
2022-02-23 17:16:12.429707 (Thread-2): 17:16:12  2 of 5 OK created view model dbt_orukosueva.stg_green_tripdata.................. [OK in 2.05s]
2022-02-23 17:16:12.429825 (Thread-2): 17:16:12  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:16:12.430636 (Thread-4): 17:16:12  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:16:12.430813 (Thread-4): 17:16:12  4 of 5 SKIP relation dbt_orukosueva.fact_trips.................................. [SKIP]
2022-02-23 17:16:12.430919 (Thread-4): 17:16:12  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:16:12.431861 (Thread-3): 17:16:12  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:16:12.432112 (Thread-3): 17:16:12  5 of 5 SKIP relation dbt_orukosueva.dm_monthly_zone_revenue..................... [SKIP]
2022-02-23 17:16:12.432286 (Thread-3): 17:16:12  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:16:12.433750 (MainThread): 17:16:12  Acquiring new bigquery connection "master"
2022-02-23 17:16:12.434120 (MainThread): 17:16:12  
2022-02-23 17:16:12.434223 (MainThread): 17:16:12  Finished running 3 table models, 2 view models in 2.95s.
2022-02-23 17:16:12.434307 (MainThread): 17:16:12  Connection 'master' was properly closed.
2022-02-23 17:16:12.434374 (MainThread): 17:16:12  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:16:12.434438 (MainThread): 17:16:12  Connection 'model.taxi_rides_ny.stg_green_tripdata' was properly closed.
2022-02-23 17:16:12.434499 (MainThread): 17:16:12  Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
2022-02-23 17:16:12.511641 (MainThread): 17:16:12  
2022-02-23 17:16:12.511837 (MainThread): 17:16:12  Completed with 1 error and 0 warnings:
2022-02-23 17:16:12.511929 (MainThread): 17:16:12  
2022-02-23 17:16:12.512018 (MainThread): 17:16:12  Runtime Error in model dim_zones (models/core/dim_zones.sql)
2022-02-23 17:16:12.512095 (MainThread): 17:16:12    404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
2022-02-23 17:16:12.512161 (MainThread): 17:16:12    
2022-02-23 17:16:12.512227 (MainThread): 17:16:12    Location: europe-west6
2022-02-23 17:16:12.512290 (MainThread): 17:16:12    Job ID: 8c567fb4-a6ca-41bc-a201-3a8ebf8e88fe
2022-02-23 17:16:12.512353 (MainThread): 17:16:12    
2022-02-23 17:16:12.512430 (MainThread): 17:16:12  
2022-02-23 17:16:12.512508 (MainThread): 17:16:12  Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
2022-02-23 17:16:12.688193 (Thread-125): handling poll request
2022-02-23 17:16:12.688582 (Thread-125): 17:16:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4080a0>]}
2022-02-23 17:16:12.690610 (Thread-125): sending response (<Response 43566 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:16:13.772244 (Thread-126): handling status request
2022-02-23 17:16:13.772611 (Thread-126): 17:16:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c408310>]}
2022-02-23 17:16:13.773211 (Thread-126): sending response (<Response 3751 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:16:13.894208 (Thread-127): handling status request
2022-02-23 17:16:13.894595 (Thread-127): 17:16:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c41ceb0>]}
2022-02-23 17:16:13.895154 (Thread-127): sending response (<Response 3751 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:16:14.560220 (Thread-128): handling status request
2022-02-23 17:16:14.560587 (Thread-128): 17:16:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c41c430>]}
2022-02-23 17:16:14.561107 (Thread-128): sending response (<Response 3729 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:16:14.566876 (Thread-129): handling list request
2022-02-23 17:16:14.567126 (Thread-129): 17:16:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c41c850>]}
2022-02-23 17:16:14.600477 (Thread-129): 17:16:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c41cc70>]}
2022-02-23 17:16:14.600806 (Thread-129): 17:16:14  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:16:14.604416 (Thread-129): sending response (<Response 8289 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:16:53.385735 (Thread-130): handling status request
2022-02-23 17:16:53.386144 (Thread-130): 17:16:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4211c0>]}
2022-02-23 17:16:53.386703 (Thread-130): sending response (<Response 3729 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:16:53.392962 (Thread-131): handling list request
2022-02-23 17:16:53.393211 (Thread-131): 17:16:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4048b0>]}
2022-02-23 17:16:53.428906 (Thread-131): 17:16:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c404490>]}
2022-02-23 17:16:53.451695 (Thread-131): 17:16:53  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:16:53.454996 (Thread-131): sending response (<Response 8128 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:16:57.912433 (Thread-132): handling status request
2022-02-23 17:16:57.912801 (Thread-132): 17:16:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3fc730>]}
2022-02-23 17:16:57.913336 (Thread-132): sending response (<Response 3729 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:16:57.924826 (Thread-133): handling list request
2022-02-23 17:16:57.925071 (Thread-133): 17:16:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3fcca0>]}
2022-02-23 17:16:57.959624 (Thread-133): 17:16:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c404460>]}
2022-02-23 17:16:57.959934 (Thread-133): 17:16:57  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:16:57.963255 (Thread-133): sending response (<Response 8128 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:17:52.645332 (Thread-134): handling status request
2022-02-23 17:17:52.645784 (Thread-134): 17:17:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c410130>]}
2022-02-23 17:17:52.646454 (Thread-134): sending response (<Response 3729 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:17:52.659991 (Thread-135): handling list request
2022-02-23 17:17:52.660365 (Thread-135): 17:17:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c410550>]}
2022-02-23 17:17:52.700457 (Thread-135): 17:17:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c41c400>]}
2022-02-23 17:17:52.700813 (Thread-135): 17:17:52  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:17:52.711707 (Thread-135): sending response (<Response 8128 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:18:07.414785 (Thread-136): handling status request
2022-02-23 17:18:07.415198 (Thread-136): 17:18:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c410550>]}
2022-02-23 17:18:07.415773 (Thread-136): sending response (<Response 3729 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:18:07.421962 (Thread-137): handling list request
2022-02-23 17:18:07.422205 (Thread-137): 17:18:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c412d60>]}
2022-02-23 17:18:07.457349 (Thread-137): 17:18:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4100d0>]}
2022-02-23 17:18:07.457716 (Thread-137): 17:18:07  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:18:07.461165 (Thread-137): sending response (<Response 8128 bytes [200 OK]>) to 10.0.12.141
2022-02-23 17:18:13.791979 (Thread-138): handling status request
2022-02-23 17:18:13.792351 (Thread-138): 17:18:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfedee0>]}
2022-02-23 17:18:13.792897 (Thread-138): sending response (<Response 3751 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:18:14.172928 (Thread-139): handling run_sql request
2022-02-23 17:18:14.173298 (Thread-139): 17:18:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d1cfedf40>]}
2022-02-23 17:18:16.348309 (Thread-139): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:18:16.376068 (MainThread): 17:18:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1cf42ee-f23a-4088-8cf3-8406e11cb958', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2cc987550>]}
2022-02-23 17:18:16.376640 (MainThread): 17:18:16  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:18:16.377272 (Thread-1): 17:18:16  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:18:16.377412 (Thread-1): 17:18:16  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:18:16.377509 (Thread-1): 17:18:16  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:18:16.380090 (Thread-1): 17:18:16  finished collecting timing info
2022-02-23 17:18:16.380222 (Thread-1): 17:18:16  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:18:16.380330 (Thread-1): 17:18:16  Opening a new connection, currently in state init
2022-02-23 17:18:16.384869 (Thread-1): 17:18:16  On rpc.taxi_rides_ny.request: 


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:18:16.763927 (Thread-140): handling poll request
2022-02-23 17:18:16.764400 (Thread-140): 17:18:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c5d01f0>]}
2022-02-23 17:18:16.765276 (Thread-140): sending response (<Response 3577 bytes [200 OK]>) to 10.0.10.118
2022-02-23 17:18:16.784095 (Thread-1): 17:18:16  BigQuery adapter: Unhandled error while running:



select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:18:16.784271 (Thread-1): 17:18:16  BigQuery adapter: 404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6

Location: europe-west6
Job ID: dd27125e-3287-4d71-bd1c-00d5c2df144f

2022-02-23 17:18:16.784442 (Thread-1): 17:18:16  finished collecting timing info
2022-02-23 17:18:16.784562 (Thread-1): Got an exception: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
  
  Location: europe-west6
  Job ID: dd27125e-3287-4d71-bd1c-00d5c2df144f
  
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 174, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 378, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 535, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1451, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 283, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1441, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 728, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 137, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6

Location: europe-west6
Job ID: dd27125e-3287-4d71-bd1c-00d5c2df144f


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 389, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 380, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 206, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
  
  Location: europe-west6
  Job ID: dd27125e-3287-4d71-bd1c-00d5c2df144f
2022-02-23 17:18:16.786694 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: dd27125e-3287-4d71-bd1c-00d5c2df144f\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\n\r\nselect \r\n    locationid, \r\n    borough, \r\n    zone, \r\n    replace(service_zone,'Boro','Green') as service_zone\r\nfrom {{ ref('taxi_zone_lookup') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n\nselect \n    locationid, \n    borough, \n    zone, \n    replace(service_zone,'Boro','Green') as service_zone\nfrom `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: dd27125e-3287-4d71-bd1c-00d5c2df144f\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\n\r\nselect \r\n    locationid, \r\n    borough, \r\n    zone, \r\n    replace(service_zone,'Boro','Green') as service_zone\r\nfrom {{ ref('taxi_zone_lookup') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n\nselect \n    locationid, \n    borough, \n    zone, \n    replace(service_zone,'Boro','Green') as service_zone\nfrom `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-02-23 17:18:18.201084 (Thread-141): handling poll request
2022-02-23 17:18:18.201485 (Thread-141): 17:18:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c5d0d00>]}
2022-02-23 17:18:18.202135 (Thread-141): sending response (<Response 12236 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:18:32.787034 (Thread-142): handling status request
2022-02-23 17:18:32.788348 (Thread-142): 17:18:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c48bac0>]}
2022-02-23 17:18:32.788976 (Thread-142): sending response (<Response 3751 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:18:33.160134 (Thread-143): handling compile_sql request
2022-02-23 17:18:33.160575 (Thread-143): 17:18:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c6b9670>]}
2022-02-23 17:18:35.265208 (Thread-143): sending response (<Response 138 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:18:35.292604 (MainThread): 17:18:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed20c60a-72ef-4f79-81c5-2b5d40774bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb70d31a4f0>]}
2022-02-23 17:18:35.293162 (MainThread): 17:18:35  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:18:35.293767 (Thread-1): 17:18:35  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:18:35.293902 (Thread-1): 17:18:35  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:18:35.294034 (Thread-1): 17:18:35  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:18:35.296608 (Thread-1): 17:18:35  finished collecting timing info
2022-02-23 17:18:35.296739 (Thread-1): 17:18:35  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:18:35.296837 (Thread-1): 17:18:35  finished collecting timing info
2022-02-23 17:18:35.709591 (Thread-144): handling poll request
2022-02-23 17:18:35.710137 (Thread-144): 17:18:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c557c40>]}
2022-02-23 17:18:35.711381 (Thread-144): sending response (<Response 5913 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:19:04.339815 (Thread-145): handling status request
2022-02-23 17:19:04.340193 (Thread-145): 17:19:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c557a00>]}
2022-02-23 17:19:04.340805 (Thread-145): sending response (<Response 3751 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:19:04.839683 (Thread-146): handling compile_sql request
2022-02-23 17:19:04.840042 (Thread-146): 17:19:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c5578e0>]}
2022-02-23 17:19:06.947081 (Thread-146): sending response (<Response 138 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:19:06.978284 (MainThread): 17:19:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e18de547-ca16-4924-8bba-7c8348bf2aba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe758159610>]}
2022-02-23 17:19:06.978802 (MainThread): 17:19:06  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:19:06.979382 (Thread-1): 17:19:06  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:19:06.979511 (Thread-1): 17:19:06  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:19:06.979615 (Thread-1): 17:19:06  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:19:06.982681 (Thread-1): 17:19:06  finished collecting timing info
2022-02-23 17:19:06.982812 (Thread-1): 17:19:06  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:19:06.982907 (Thread-1): 17:19:06  finished collecting timing info
2022-02-23 17:19:07.391832 (Thread-147): handling poll request
2022-02-23 17:19:07.392477 (Thread-147): 17:19:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4b3550>]}
2022-02-23 17:19:07.393839 (Thread-147): sending response (<Response 12268 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:20:09.389219 (Thread-148): handling status request
2022-02-23 17:20:09.389610 (Thread-148): 17:20:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4b36a0>]}
2022-02-23 17:20:09.390245 (Thread-148): sending response (<Response 3751 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:20:09.813355 (Thread-149): handling run_sql request
2022-02-23 17:20:09.813729 (Thread-149): 17:20:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4b3070>]}
2022-02-23 17:20:11.933001 (Thread-149): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:20:11.979162 (MainThread): 17:20:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0a0fd52-8c4a-42cb-83e3-f0d5b22e6576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df2982e20>]}
2022-02-23 17:20:11.979752 (MainThread): 17:20:11  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:20:11.980370 (Thread-1): 17:20:11  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:20:11.980501 (Thread-1): 17:20:11  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:20:11.980592 (Thread-1): 17:20:11  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:20:11.985856 (Thread-1): 17:20:11  finished collecting timing info
2022-02-23 17:20:11.986039 (Thread-1): 17:20:11  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:20:11.986154 (Thread-1): 17:20:11  Opening a new connection, currently in state init
2022-02-23 17:20:11.990653 (Thread-1): 17:20:11  On rpc.taxi_rides_ny.request: 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100


2022-02-23 17:20:12.415805 (Thread-150): handling poll request
2022-02-23 17:20:12.416278 (Thread-150): 17:20:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd189b50>]}
2022-02-23 17:20:12.417173 (Thread-150): sending response (<Response 5240 bytes [200 OK]>) to 10.0.18.116
2022-02-23 17:20:13.417967 (Thread-1): 17:20:13  finished collecting timing info
2022-02-23 17:20:13.990210 (Thread-151): handling poll request
2022-02-23 17:20:13.990631 (Thread-151): 17:20:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc09d5b0>]}
2022-02-23 17:20:13.993599 (Thread-151): sending response (<Response 31011 bytes [200 OK]>) to 10.0.18.116
2022-02-23 17:20:21.977157 (Thread-152): handling status request
2022-02-23 17:20:21.977553 (Thread-152): 17:20:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc078f10>]}
2022-02-23 17:20:21.978199 (Thread-152): sending response (<Response 3751 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:20:22.351424 (Thread-153): handling run_sql request
2022-02-23 17:20:22.351785 (Thread-153): 17:20:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0940a0>]}
2022-02-23 17:20:24.454011 (Thread-153): sending response (<Response 138 bytes [200 OK]>) to 10.0.18.116
2022-02-23 17:20:24.497721 (MainThread): 17:20:24  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5a10977-8c7f-4ad9-a010-43922dbd2f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52799e95e0>]}
2022-02-23 17:20:24.498292 (MainThread): 17:20:24  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:20:24.498932 (Thread-1): 17:20:24  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:20:24.499069 (Thread-1): 17:20:24  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:20:24.499164 (Thread-1): 17:20:24  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:20:24.504050 (Thread-1): 17:20:24  finished collecting timing info
2022-02-23 17:20:24.504185 (Thread-1): 17:20:24  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:20:24.504295 (Thread-1): 17:20:24  Opening a new connection, currently in state init
2022-02-23 17:20:24.508773 (Thread-1): 17:20:24  On rpc.taxi_rides_ny.request: 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100



2022-02-23 17:20:24.978496 (Thread-154): handling poll request
2022-02-23 17:20:24.978965 (Thread-154): 17:20:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc045250>]}
2022-02-23 17:20:24.979834 (Thread-154): sending response (<Response 5252 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:20:26.402975 (Thread-155): handling poll request
2022-02-23 17:20:26.403374 (Thread-155): 17:20:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd1c1e20>]}
2022-02-23 17:20:26.403875 (Thread-155): sending response (<Response 399 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:20:27.640542 (Thread-1): 17:20:27  finished collecting timing info
2022-02-23 17:20:27.902997 (Thread-156): handling poll request
2022-02-23 17:20:27.903415 (Thread-156): 17:20:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0b4eb0>]}
2022-02-23 17:20:27.906364 (Thread-156): sending response (<Response 30968 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:20:36.054050 (Thread-157): handling status request
2022-02-23 17:20:36.054431 (Thread-157): 17:20:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc128eb0>]}
2022-02-23 17:20:36.055036 (Thread-157): sending response (<Response 3751 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:20:36.566338 (Thread-158): handling run_sql request
2022-02-23 17:20:36.566707 (Thread-158): 17:20:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc11f940>]}
2022-02-23 17:20:38.701236 (Thread-158): sending response (<Response 138 bytes [200 OK]>) to 10.0.30.15
2022-02-23 17:20:38.729543 (MainThread): 17:20:38  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff7e1467-dec2-4f7c-94a8-d2272566997c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc96be0c640>]}
2022-02-23 17:20:38.730135 (MainThread): 17:20:38  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:20:38.730757 (Thread-1): 17:20:38  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:20:38.730893 (Thread-1): 17:20:38  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:20:38.730986 (Thread-1): 17:20:38  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:20:38.733564 (Thread-1): 17:20:38  finished collecting timing info
2022-02-23 17:20:38.733694 (Thread-1): 17:20:38  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:20:38.733803 (Thread-1): 17:20:38  Opening a new connection, currently in state init
2022-02-23 17:20:38.738286 (Thread-1): 17:20:38  On rpc.taxi_rides_ny.request: 


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:20:39.038637 (Thread-1): 17:20:39  BigQuery adapter: Unhandled error while running:



select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:20:39.038809 (Thread-1): 17:20:39  BigQuery adapter: 404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6

Location: europe-west6
Job ID: a5a76be6-6f37-4591-9057-14cabdf379c1

2022-02-23 17:20:39.038948 (Thread-1): 17:20:39  finished collecting timing info
2022-02-23 17:20:39.039086 (Thread-1): Got an exception: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
  
  Location: europe-west6
  Job ID: a5a76be6-6f37-4591-9057-14cabdf379c1
  
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 174, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 378, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 535, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1451, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 283, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1441, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 728, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 137, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6

Location: europe-west6
Job ID: a5a76be6-6f37-4591-9057-14cabdf379c1


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 389, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 380, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 206, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6
  
  Location: europe-west6
  Job ID: a5a76be6-6f37-4591-9057-14cabdf379c1
2022-02-23 17:20:39.041144 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: a5a76be6-6f37-4591-9057-14cabdf379c1\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\n\r\nselect \r\n    locationid, \r\n    borough, \r\n    zone, \r\n    replace(service_zone,'Boro','Green') as service_zone\r\nfrom {{ ref('taxi_zone_lookup') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n\nselect \n    locationid, \n    borough, \n    zone, \n    replace(service_zone,'Boro','Green') as service_zone\nfrom `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.taxi_zone_lookup was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: a5a76be6-6f37-4591-9057-14cabdf379c1\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\n\r\nselect \r\n    locationid, \r\n    borough, \r\n    zone, \r\n    replace(service_zone,'Boro','Green') as service_zone\r\nfrom {{ ref('taxi_zone_lookup') }}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\n\nselect \n    locationid, \n    borough, \n    zone, \n    replace(service_zone,'Boro','Green') as service_zone\nfrom `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-02-23 17:20:39.123848 (Thread-159): handling poll request
2022-02-23 17:20:39.124298 (Thread-159): 17:20:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0bd7c0>]}
2022-02-23 17:20:39.125252 (Thread-159): sending response (<Response 11686 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:20:40.963465 (Thread-160): handling poll request
2022-02-23 17:20:40.963854 (Thread-160): 17:20:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0bd880>]}
2022-02-23 17:20:40.964463 (Thread-160): sending response (<Response 12236 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:23:07.768696 (Thread-161): handling status request
2022-02-23 17:23:07.770634 (Thread-161): 17:23:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0d90a0>]}
2022-02-23 17:23:07.771255 (Thread-161): sending response (<Response 3751 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:23:08.087512 (Thread-162): handling status request
2022-02-23 17:23:08.087885 (Thread-162): 17:23:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0d9b50>]}
2022-02-23 17:23:08.088412 (Thread-162): sending response (<Response 3751 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:23:08.271078 (Thread-163): handling cli_args request
2022-02-23 17:23:08.271446 (Thread-163): 17:23:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0d9c40>]}
2022-02-23 17:23:10.397602 (Thread-163): sending response (<Response 138 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:23:10.773750 (MainThread): 17:23:10  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:23:10.774233 (MainThread): 17:23:10  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:23:10.781139 (MainThread): 17:23:10  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbdb24dc-5b3f-4069-9b7f-62c3f9230d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a1a378b80>]}
2022-02-23 17:23:10.818859 (MainThread): 17:23:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbdb24dc-5b3f-4069-9b7f-62c3f9230d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a1ac8eb80>]}
2022-02-23 17:23:10.819131 (MainThread): 17:23:10  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:23:10.820596 (MainThread): 17:23:10  
2022-02-23 17:23:10.820898 (MainThread): 17:23:10  Acquiring new bigquery connection "master"
2022-02-23 17:23:10.821760 (ThreadPoolExecutor-0_0): 17:23:10  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:23:10.821943 (ThreadPoolExecutor-0_0): 17:23:10  Opening a new connection, currently in state init
2022-02-23 17:23:10.895904 (Thread-164): handling poll request
2022-02-23 17:23:10.896335 (Thread-164): 17:23:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd136ca0>]}
2022-02-23 17:23:10.897167 (Thread-164): sending response (<Response 3340 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:23:11.077445 (ThreadPoolExecutor-1_0): 17:23:11  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:23:11.077624 (ThreadPoolExecutor-1_0): 17:23:11  Opening a new connection, currently in state closed
2022-02-23 17:23:11.281636 (MainThread): 17:23:11  Concurrency: 4 threads (target='default')
2022-02-23 17:23:11.281801 (MainThread): 17:23:11  
2022-02-23 17:23:11.284534 (Thread-1): 17:23:11  Began running node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:23:11.284838 (Thread-1): 17:23:11  1 of 1 START seed file dbt_orukosueva.taxi_zone_lookup.......................... [RUN]
2022-02-23 17:23:11.285100 (Thread-1): 17:23:11  Acquiring new bigquery connection "seed.taxi_rides_ny.taxi_zone_lookup"
2022-02-23 17:23:11.285199 (Thread-1): 17:23:11  Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:23:11.285303 (Thread-1): 17:23:11  finished collecting timing info
2022-02-23 17:23:11.285410 (Thread-1): 17:23:11  Began executing node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:23:11.318596 (Thread-1): 17:23:11  Opening a new connection, currently in state closed
2022-02-23 17:23:12.549521 (Thread-165): handling poll request
2022-02-23 17:23:12.549894 (Thread-165): 17:23:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc177a00>]}
2022-02-23 17:23:12.550531 (Thread-165): sending response (<Response 4399 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:23:13.987950 (Thread-166): handling poll request
2022-02-23 17:23:13.988330 (Thread-166): 17:23:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0d97c0>]}
2022-02-23 17:23:13.988821 (Thread-166): sending response (<Response 286 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:23:15.386367 (Thread-167): handling poll request
2022-02-23 17:23:15.386750 (Thread-167): 17:23:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0bd790>]}
2022-02-23 17:23:15.387242 (Thread-167): sending response (<Response 287 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:23:15.432770 (Thread-1): 17:23:15  Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
2022-02-23 17:23:15.461064 (Thread-1): 17:23:15  finished collecting timing info
2022-02-23 17:23:15.461480 (Thread-1): 17:23:15  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbdb24dc-5b3f-4069-9b7f-62c3f9230d93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a182d2820>]}
2022-02-23 17:23:15.461865 (Thread-1): 17:23:15  1 of 1 OK loaded seed file dbt_orukosueva.taxi_zone_lookup...................... [INSERT 265 in 4.18s]
2022-02-23 17:23:15.462013 (Thread-1): 17:23:15  Finished running node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:23:15.463373 (MainThread): 17:23:15  Acquiring new bigquery connection "master"
2022-02-23 17:23:15.463654 (MainThread): 17:23:15  
2022-02-23 17:23:15.463749 (MainThread): 17:23:15  Finished running 1 seed in 4.64s.
2022-02-23 17:23:15.463830 (MainThread): 17:23:15  Connection 'master' was properly closed.
2022-02-23 17:23:15.463896 (MainThread): 17:23:15  Connection 'seed.taxi_rides_ny.taxi_zone_lookup' was properly closed.
2022-02-23 17:23:15.539505 (MainThread): 17:23:15  
2022-02-23 17:23:15.539719 (MainThread): 17:23:15  Completed successfully
2022-02-23 17:23:15.539816 (MainThread): 17:23:15  
2022-02-23 17:23:15.539904 (MainThread): 17:23:15  Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-02-23 17:23:16.849899 (Thread-168): handling poll request
2022-02-23 17:23:16.850328 (Thread-168): 17:23:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd136910>]}
2022-02-23 17:23:16.851272 (Thread-168): sending response (<Response 7934 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:23:17.825271 (Thread-169): handling status request
2022-02-23 17:23:17.825656 (Thread-169): 17:23:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0c1400>]}
2022-02-23 17:23:17.826337 (Thread-169): sending response (<Response 3751 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:23:17.941623 (Thread-170): handling status request
2022-02-23 17:23:17.946494 (Thread-170): 17:23:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0c19a0>]}
2022-02-23 17:23:17.947036 (Thread-170): sending response (<Response 3751 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:23:27.189125 (Thread-171): handling status request
2022-02-23 17:23:27.189525 (Thread-171): 17:23:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc0c1ca0>]}
2022-02-23 17:23:27.190102 (Thread-171): sending response (<Response 3751 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:23:27.685014 (Thread-172): handling run_sql request
2022-02-23 17:23:27.685403 (Thread-172): 17:23:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc172d30>]}
2022-02-23 17:23:29.807928 (Thread-172): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:23:29.835896 (MainThread): 17:23:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49615038-653b-495c-b726-f5e0d79582af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4a4b3e520>]}
2022-02-23 17:23:29.836436 (MainThread): 17:23:29  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:23:29.837038 (Thread-1): 17:23:29  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:23:29.837173 (Thread-1): 17:23:29  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:23:29.837270 (Thread-1): 17:23:29  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:23:29.839756 (Thread-1): 17:23:29  finished collecting timing info
2022-02-23 17:23:29.839886 (Thread-1): 17:23:29  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:23:29.839993 (Thread-1): 17:23:29  Opening a new connection, currently in state init
2022-02-23 17:23:29.844533 (Thread-1): 17:23:29  On rpc.taxi_rides_ny.request: 


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:23:30.652929 (Thread-173): handling poll request
2022-02-23 17:23:30.653413 (Thread-173): 17:23:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c43edc0>]}
2022-02-23 17:23:30.654339 (Thread-173): sending response (<Response 3577 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:23:31.620420 (Thread-1): 17:23:31  finished collecting timing info
2022-02-23 17:23:32.237719 (Thread-174): handling poll request
2022-02-23 17:23:32.238125 (Thread-174): 17:23:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4b61f0>]}
2022-02-23 17:23:32.239480 (Thread-174): sending response (<Response 17936 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:23:39.384382 (Thread-175): handling status request
2022-02-23 17:23:39.384766 (Thread-175): 17:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4b6610>]}
2022-02-23 17:23:39.385709 (Thread-175): sending response (<Response 3751 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:23:39.883515 (Thread-176): handling run_sql request
2022-02-23 17:23:39.883914 (Thread-176): 17:23:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc04af10>]}
2022-02-23 17:23:42.042685 (Thread-176): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:23:42.071294 (MainThread): 17:23:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e7c0cf2-1ae6-408b-8a23-d277df9729ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42d168a520>]}
2022-02-23 17:23:42.071812 (MainThread): 17:23:42  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:23:42.072403 (Thread-1): 17:23:42  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:23:42.072539 (Thread-1): 17:23:42  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:23:42.072636 (Thread-1): 17:23:42  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:23:42.075236 (Thread-1): 17:23:42  finished collecting timing info
2022-02-23 17:23:42.075363 (Thread-1): 17:23:42  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:23:42.075470 (Thread-1): 17:23:42  Opening a new connection, currently in state init
2022-02-23 17:23:42.079994 (Thread-1): 17:23:42  On rpc.taxi_rides_ny.request: 

with trips_data as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    date_trunc('month', pickup_datetime) as revenue_month, 
    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,
    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_montly_passenger_count,
    avg(trip_distance) as avg_montly_trip_distance

    from trips_data
    group by 1,2,3
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:23:42.343234 (Thread-1): 17:23:42  BigQuery adapter: Unhandled error while running:


with trips_data as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    date_trunc('month', pickup_datetime) as revenue_month, 
    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,
    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_montly_passenger_count,
    avg(trip_distance) as avg_montly_trip_distance

    from trips_data
    group by 1,2,3
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:23:42.343419 (Thread-1): 17:23:42  BigQuery adapter: 404 Not found: Table dtc-de-339117:dbt_orukosueva.fact_trips was not found in location europe-west6

Location: europe-west6
Job ID: 959b86cd-b7f9-4946-b59d-6ae8e4263655

2022-02-23 17:23:42.343559 (Thread-1): 17:23:42  finished collecting timing info
2022-02-23 17:23:42.343687 (Thread-1): Got an exception: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.fact_trips was not found in location europe-west6
  
  Location: europe-west6
  Job ID: 959b86cd-b7f9-4946-b59d-6ae8e4263655
  
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 174, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 378, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 535, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1451, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 283, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1441, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 728, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 137, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table dtc-de-339117:dbt_orukosueva.fact_trips was not found in location europe-west6

Location: europe-west6
Job ID: 959b86cd-b7f9-4946-b59d-6ae8e4263655


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 389, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 380, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 206, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.fact_trips was not found in location europe-west6
  
  Location: europe-west6
  Job ID: 959b86cd-b7f9-4946-b59d-6ae8e4263655
2022-02-23 17:23:42.345690 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.fact_trips was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: 959b86cd-b7f9-4946-b59d-6ae8e4263655\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\nwith trips_data as (\r\n    select * from {{ ref('fact_trips') }}\r\n)\r\n    select \r\n    -- Reveneue grouping \r\n    pickup_zone as revenue_zone,\r\n    date_trunc('month', pickup_datetime) as revenue_month, \r\n    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, \r\n\r\n    service_type, \r\n\r\n    -- Revenue calculation \r\n    sum(fare_amount) as revenue_monthly_fare,\r\n    sum(extra) as revenue_monthly_extra,\r\n    sum(mta_tax) as revenue_monthly_mta_tax,\r\n    sum(tip_amount) as revenue_monthly_tip_amount,\r\n    sum(tolls_amount) as revenue_monthly_tolls_amount,\r\n    sum(ehail_fee) as revenue_monthly_ehail_fee,\r\n    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,\r\n    sum(total_amount) as revenue_monthly_total_amount,\r\n    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,\r\n\r\n    -- Additional calculations\r\n    count(tripid) as total_monthly_trips,\r\n    avg(passenger_count) as avg_montly_passenger_count,\r\n    avg(trip_distance) as avg_montly_trip_distance\r\n\r\n    from trips_data\r\n    group by 1,2,3\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\nwith trips_data as (\n    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`\n)\n    select \n    -- Reveneue grouping \n    pickup_zone as revenue_zone,\n    date_trunc('month', pickup_datetime) as revenue_month, \n    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, \n\n    service_type, \n\n    -- Revenue calculation \n    sum(fare_amount) as revenue_monthly_fare,\n    sum(extra) as revenue_monthly_extra,\n    sum(mta_tax) as revenue_monthly_mta_tax,\n    sum(tip_amount) as revenue_monthly_tip_amount,\n    sum(tolls_amount) as revenue_monthly_tolls_amount,\n    sum(ehail_fee) as revenue_monthly_ehail_fee,\n    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,\n    sum(total_amount) as revenue_monthly_total_amount,\n    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,\n\n    -- Additional calculations\n    count(tripid) as total_monthly_trips,\n    avg(passenger_count) as avg_montly_passenger_count,\n    avg(trip_distance) as avg_montly_trip_distance\n\n    from trips_data\n    group by 1,2,3\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.fact_trips was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: 959b86cd-b7f9-4946-b59d-6ae8e4263655\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\nwith trips_data as (\r\n    select * from {{ ref('fact_trips') }}\r\n)\r\n    select \r\n    -- Reveneue grouping \r\n    pickup_zone as revenue_zone,\r\n    date_trunc('month', pickup_datetime) as revenue_month, \r\n    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, \r\n\r\n    service_type, \r\n\r\n    -- Revenue calculation \r\n    sum(fare_amount) as revenue_monthly_fare,\r\n    sum(extra) as revenue_monthly_extra,\r\n    sum(mta_tax) as revenue_monthly_mta_tax,\r\n    sum(tip_amount) as revenue_monthly_tip_amount,\r\n    sum(tolls_amount) as revenue_monthly_tolls_amount,\r\n    sum(ehail_fee) as revenue_monthly_ehail_fee,\r\n    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,\r\n    sum(total_amount) as revenue_monthly_total_amount,\r\n    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,\r\n\r\n    -- Additional calculations\r\n    count(tripid) as total_monthly_trips,\r\n    avg(passenger_count) as avg_montly_passenger_count,\r\n    avg(trip_distance) as avg_montly_trip_distance\r\n\r\n    from trips_data\r\n    group by 1,2,3\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\nwith trips_data as (\n    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`\n)\n    select \n    -- Reveneue grouping \n    pickup_zone as revenue_zone,\n    date_trunc('month', pickup_datetime) as revenue_month, \n    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, \n\n    service_type, \n\n    -- Revenue calculation \n    sum(fare_amount) as revenue_monthly_fare,\n    sum(extra) as revenue_monthly_extra,\n    sum(mta_tax) as revenue_monthly_mta_tax,\n    sum(tip_amount) as revenue_monthly_tip_amount,\n    sum(tolls_amount) as revenue_monthly_tolls_amount,\n    sum(ehail_fee) as revenue_monthly_ehail_fee,\n    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,\n    sum(total_amount) as revenue_monthly_total_amount,\n    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,\n\n    -- Additional calculations\n    count(tripid) as total_monthly_trips,\n    avg(passenger_count) as avg_montly_passenger_count,\n    avg(trip_distance) as avg_montly_trip_distance\n\n    from trips_data\n    group by 1,2,3\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-02-23 17:23:42.563008 (Thread-177): handling poll request
2022-02-23 17:23:42.563498 (Thread-177): 17:23:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4b6640>]}
2022-02-23 17:23:42.564380 (Thread-177): sending response (<Response 19808 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:23:56.514518 (Thread-178): handling status request
2022-02-23 17:23:56.514934 (Thread-178): 17:23:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c45a880>]}
2022-02-23 17:23:56.515566 (Thread-178): sending response (<Response 3751 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:23:56.962515 (Thread-179): handling run_sql request
2022-02-23 17:23:56.962918 (Thread-179): 17:23:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c45afd0>]}
2022-02-23 17:23:59.064887 (Thread-179): sending response (<Response 138 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:23:59.100884 (MainThread): 17:23:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4587659-89f9-42c9-9c12-17a00c8ae744', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4a562a4c0>]}
2022-02-23 17:23:59.101696 (MainThread): 17:23:59  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:23:59.102272 (Thread-1): 17:23:59  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:23:59.102412 (Thread-1): 17:23:59  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:23:59.102527 (Thread-1): 17:23:59  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:23:59.105814 (Thread-1): 17:23:59  finished collecting timing info
2022-02-23 17:23:59.105987 (Thread-1): 17:23:59  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:23:59.106101 (Thread-1): 17:23:59  Opening a new connection, currently in state init
2022-02-23 17:23:59.110977 (Thread-1): 17:23:59  On rpc.taxi_rides_ny.request: 

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
    select * from green_data
    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:23:59.366906 (Thread-1): 17:23:59  BigQuery adapter: Unhandled error while running:


with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
    select * from green_data
    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:23:59.367085 (Thread-1): 17:23:59  BigQuery adapter: 404 Not found: Table dtc-de-339117:dbt_orukosueva.dim_zones was not found in location europe-west6

Location: europe-west6
Job ID: 235b8d59-5da3-4989-b70a-0936addd67ad

2022-02-23 17:23:59.367220 (Thread-1): 17:23:59  finished collecting timing info
2022-02-23 17:23:59.367338 (Thread-1): Got an exception: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.dim_zones was not found in location europe-west6
  
  Location: europe-west6
  Job ID: 235b8d59-5da3-4989-b70a-0936addd67ad
  
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 174, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 378, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 535, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1451, in result
    do_get_result()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 283, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 190, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1441, in do_get_result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 728, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 137, in result
    raise self._exception
google.api_core.exceptions.NotFound: 404 Not found: Table dtc-de-339117:dbt_orukosueva.dim_zones was not found in location europe-west6

Location: europe-west6
Job ID: 235b8d59-5da3-4989-b70a-0936addd67ad


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 361, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 314, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 90, in execute
    _, execute_result = self.adapter.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 225, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 389, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 380, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 549, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 206, in exception_handler
    raise RuntimeException(exc_message)
dbt.exceptions.RuntimeException: Runtime Error
  404 Not found: Table dtc-de-339117:dbt_orukosueva.dim_zones was not found in location europe-west6
  
  Location: europe-west6
  Job ID: 235b8d59-5da3-4989-b70a-0936addd67ad
2022-02-23 17:23:59.369401 (Thread-1): Got exception RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.dim_zones was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: 235b8d59-5da3-4989-b70a-0936addd67ad\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\nwith green_data as (\r\n    select *, \r\n        'Green' as service_type \r\n    from {{ ref('stg_green_tripdata') }}\r\n), \r\n\r\nyellow_data as (\r\n    select *, \r\n        'Yellow' as service_type\r\n    from {{ ref('stg_yellow_tripdata') }}\r\n), \r\n\r\ntrips_unioned as (\r\n    select * from green_data\r\n    union all\r\n    select * from yellow_data\r\n), \r\n\r\ndim_zones as (\r\n    select * from {{ ref('dim_zones') }}\r\n    where borough != 'Unknown'\r\n)\r\nselect \r\n    trips_unioned.tripid, \r\n    trips_unioned.vendorid, \r\n    trips_unioned.service_type,\r\n    trips_unioned.ratecodeid, \r\n    trips_unioned.pickup_locationid, \r\n    pickup_zone.borough as pickup_borough, \r\n    pickup_zone.zone as pickup_zone, \r\n    trips_unioned.dropoff_locationid,\r\n    dropoff_zone.borough as dropoff_borough, \r\n    dropoff_zone.zone as dropoff_zone,  \r\n    trips_unioned.pickup_datetime, \r\n    trips_unioned.dropoff_datetime, \r\n    trips_unioned.store_and_fwd_flag, \r\n    trips_unioned.passenger_count, \r\n    trips_unioned.trip_distance, \r\n    trips_unioned.trip_type, \r\n    trips_unioned.fare_amount, \r\n    trips_unioned.extra, \r\n    trips_unioned.mta_tax, \r\n    trips_unioned.tip_amount, \r\n    trips_unioned.tolls_amount, \r\n    trips_unioned.ehail_fee, \r\n    trips_unioned.improvement_surcharge, \r\n    trips_unioned.total_amount, \r\n    trips_unioned.payment_type, \r\n    trips_unioned.payment_type_description, \r\n    trips_unioned.congestion_surcharge\r\nfrom trips_unioned\r\ninner join dim_zones as pickup_zone\r\non trips_unioned.pickup_locationid = pickup_zone.locationid\r\ninner join dim_zones as dropoff_zone\r\non trips_unioned.dropoff_locationid = dropoff_zone.locationid\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\nwith green_data as (\n    select *, \n        'Green' as service_type \n    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`\n), \n\nyellow_data as (\n    select *, \n        'Yellow' as service_type\n    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`\n), \n\ntrips_unioned as (\n    select * from green_data\n    union all\n    select * from yellow_data\n), \n\ndim_zones as (\n    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`\n    where borough != 'Unknown'\n)\nselect \n    trips_unioned.tripid, \n    trips_unioned.vendorid, \n    trips_unioned.service_type,\n    trips_unioned.ratecodeid, \n    trips_unioned.pickup_locationid, \n    pickup_zone.borough as pickup_borough, \n    pickup_zone.zone as pickup_zone, \n    trips_unioned.dropoff_locationid,\n    dropoff_zone.borough as dropoff_borough, \n    dropoff_zone.zone as dropoff_zone,  \n    trips_unioned.pickup_datetime, \n    trips_unioned.dropoff_datetime, \n    trips_unioned.store_and_fwd_flag, \n    trips_unioned.passenger_count, \n    trips_unioned.trip_distance, \n    trips_unioned.trip_type, \n    trips_unioned.fare_amount, \n    trips_unioned.extra, \n    trips_unioned.mta_tax, \n    trips_unioned.tip_amount, \n    trips_unioned.tolls_amount, \n    trips_unioned.ehail_fee, \n    trips_unioned.improvement_surcharge, \n    trips_unioned.total_amount, \n    trips_unioned.payment_type, \n    trips_unioned.payment_type_description, \n    trips_unioned.congestion_surcharge\nfrom trips_unioned\ninner join dim_zones as pickup_zone\non trips_unioned.pickup_locationid = pickup_zone.locationid\ninner join dim_zones as dropoff_zone\non trips_unioned.dropoff_locationid = dropoff_zone.locationid\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 147, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 377, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 56, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10001, Runtime error, {'type': 'RuntimeException', 'message': 'Runtime Error in rpc request (from remote system)\n  404 Not found: Table dtc-de-339117:dbt_orukosueva.dim_zones was not found in location europe-west6\n  \n  Location: europe-west6\n  Job ID: 235b8d59-5da3-4989-b70a-0936addd67ad\n  ', 'raw_sql': "{{ config(materialized='table') }}\r\n\r\nwith green_data as (\r\n    select *, \r\n        'Green' as service_type \r\n    from {{ ref('stg_green_tripdata') }}\r\n), \r\n\r\nyellow_data as (\r\n    select *, \r\n        'Yellow' as service_type\r\n    from {{ ref('stg_yellow_tripdata') }}\r\n), \r\n\r\ntrips_unioned as (\r\n    select * from green_data\r\n    union all\r\n    select * from yellow_data\r\n), \r\n\r\ndim_zones as (\r\n    select * from {{ ref('dim_zones') }}\r\n    where borough != 'Unknown'\r\n)\r\nselect \r\n    trips_unioned.tripid, \r\n    trips_unioned.vendorid, \r\n    trips_unioned.service_type,\r\n    trips_unioned.ratecodeid, \r\n    trips_unioned.pickup_locationid, \r\n    pickup_zone.borough as pickup_borough, \r\n    pickup_zone.zone as pickup_zone, \r\n    trips_unioned.dropoff_locationid,\r\n    dropoff_zone.borough as dropoff_borough, \r\n    dropoff_zone.zone as dropoff_zone,  \r\n    trips_unioned.pickup_datetime, \r\n    trips_unioned.dropoff_datetime, \r\n    trips_unioned.store_and_fwd_flag, \r\n    trips_unioned.passenger_count, \r\n    trips_unioned.trip_distance, \r\n    trips_unioned.trip_type, \r\n    trips_unioned.fare_amount, \r\n    trips_unioned.extra, \r\n    trips_unioned.mta_tax, \r\n    trips_unioned.tip_amount, \r\n    trips_unioned.tolls_amount, \r\n    trips_unioned.ehail_fee, \r\n    trips_unioned.improvement_surcharge, \r\n    trips_unioned.total_amount, \r\n    trips_unioned.payment_type, \r\n    trips_unioned.payment_type_description, \r\n    trips_unioned.congestion_surcharge\r\nfrom trips_unioned\r\ninner join dim_zones as pickup_zone\r\non trips_unioned.pickup_locationid = pickup_zone.locationid\r\ninner join dim_zones as dropoff_zone\r\non trips_unioned.dropoff_locationid = dropoff_zone.locationid\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_sql': "\n\nwith green_data as (\n    select *, \n        'Green' as service_type \n    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`\n), \n\nyellow_data as (\n    select *, \n        'Yellow' as service_type\n    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`\n), \n\ntrips_unioned as (\n    select * from green_data\n    union all\n    select * from yellow_data\n), \n\ndim_zones as (\n    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`\n    where borough != 'Unknown'\n)\nselect \n    trips_unioned.tripid, \n    trips_unioned.vendorid, \n    trips_unioned.service_type,\n    trips_unioned.ratecodeid, \n    trips_unioned.pickup_locationid, \n    pickup_zone.borough as pickup_borough, \n    pickup_zone.zone as pickup_zone, \n    trips_unioned.dropoff_locationid,\n    dropoff_zone.borough as dropoff_borough, \n    dropoff_zone.zone as dropoff_zone,  \n    trips_unioned.pickup_datetime, \n    trips_unioned.dropoff_datetime, \n    trips_unioned.store_and_fwd_flag, \n    trips_unioned.passenger_count, \n    trips_unioned.trip_distance, \n    trips_unioned.trip_type, \n    trips_unioned.fare_amount, \n    trips_unioned.extra, \n    trips_unioned.mta_tax, \n    trips_unioned.tip_amount, \n    trips_unioned.tolls_amount, \n    trips_unioned.ehail_fee, \n    trips_unioned.improvement_surcharge, \n    trips_unioned.total_amount, \n    trips_unioned.payment_type, \n    trips_unioned.payment_type_description, \n    trips_unioned.congestion_surcharge\nfrom trips_unioned\ninner join dim_zones as pickup_zone\non trips_unioned.pickup_locationid = pickup_zone.locationid\ninner join dim_zones as dropoff_zone\non trips_unioned.dropoff_locationid = dropoff_zone.locationid\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-02-23 17:23:59.681012 (Thread-180): handling poll request
2022-02-23 17:23:59.681451 (Thread-180): 17:23:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c4b4df0>]}
2022-02-23 17:23:59.682354 (Thread-180): sending response (<Response 24888 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:24:11.434202 (Thread-181): handling status request
2022-02-23 17:24:11.434598 (Thread-181): 17:24:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3db310>]}
2022-02-23 17:24:11.435204 (Thread-181): sending response (<Response 3751 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:24:11.881158 (Thread-182): handling run_sql request
2022-02-23 17:24:11.881545 (Thread-182): 17:24:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3db610>]}
2022-02-23 17:24:13.997069 (Thread-182): sending response (<Response 138 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:24:14.027354 (MainThread): 17:24:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a6a5506-f938-49b2-982d-c055f0a054cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02c0aa610>]}
2022-02-23 17:24:14.027880 (MainThread): 17:24:14  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:24:14.028470 (Thread-1): 17:24:14  Acquiring new bigquery connection "rpc.taxi_rides_ny.request"
2022-02-23 17:24:14.028610 (Thread-1): 17:24:14  Began compiling node rpc.taxi_rides_ny.request
2022-02-23 17:24:14.028700 (Thread-1): 17:24:14  Compiling rpc.taxi_rides_ny.request
2022-02-23 17:24:14.031177 (Thread-1): 17:24:14  finished collecting timing info
2022-02-23 17:24:14.031305 (Thread-1): 17:24:14  Began executing node rpc.taxi_rides_ny.request
2022-02-23 17:24:14.031412 (Thread-1): 17:24:14  Opening a new connection, currently in state init
2022-02-23 17:24:14.035967 (Thread-1): 17:24:14  On rpc.taxi_rides_ny.request: 


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
limit 500
/* limit added automatically by dbt cloud */
2022-02-23 17:24:14.986848 (Thread-1): 17:24:14  finished collecting timing info
2022-02-23 17:24:15.046996 (Thread-183): handling poll request
2022-02-23 17:24:15.047510 (Thread-183): 17:24:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3855b0>]}
2022-02-23 17:24:15.048484 (Thread-183): sending response (<Response 3997 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:24:16.450436 (Thread-184): handling poll request
2022-02-23 17:24:16.450828 (Thread-184): 17:24:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c385550>]}
2022-02-23 17:24:16.452116 (Thread-184): sending response (<Response 17518 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:24:33.671226 (Thread-185): handling status request
2022-02-23 17:24:33.671595 (Thread-185): 17:24:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3858e0>]}
2022-02-23 17:24:33.672180 (Thread-185): sending response (<Response 3751 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:24:34.175729 (Thread-186): handling status request
2022-02-23 17:24:34.176111 (Thread-186): 17:24:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c385c70>]}
2022-02-23 17:24:34.176656 (Thread-186): sending response (<Response 3751 bytes [200 OK]>) to 10.0.18.116
2022-02-23 17:24:34.315518 (Thread-187): handling cli_args request
2022-02-23 17:24:34.315899 (Thread-187): 17:24:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c385eb0>]}
2022-02-23 17:24:36.502953 (Thread-187): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:24:36.920775 (MainThread): 17:24:36  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:24:36.921268 (MainThread): 17:24:36  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:24:36.929927 (MainThread): 17:24:36  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a3db618-fd25-4155-a71e-f1251cae9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d162bbe0>]}
2022-02-23 17:24:36.965136 (MainThread): 17:24:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a3db618-fd25-4155-a71e-f1251cae9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1f3db80>]}
2022-02-23 17:24:36.965402 (MainThread): 17:24:36  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:24:36.966920 (MainThread): 17:24:36  
2022-02-23 17:24:36.967224 (MainThread): 17:24:36  Acquiring new bigquery connection "master"
2022-02-23 17:24:36.968267 (ThreadPoolExecutor-0_0): 17:24:36  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:24:36.968420 (ThreadPoolExecutor-0_0): 17:24:36  Opening a new connection, currently in state init
2022-02-23 17:24:37.013564 (Thread-188): handling poll request
2022-02-23 17:24:37.014045 (Thread-188): 17:24:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c38e6d0>]}
2022-02-23 17:24:37.038653 (Thread-188): sending response (<Response 3339 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:24:37.625853 (ThreadPoolExecutor-1_0): 17:24:37  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:24:37.626061 (ThreadPoolExecutor-1_0): 17:24:37  Opening a new connection, currently in state closed
2022-02-23 17:24:37.834585 (MainThread): 17:24:37  Concurrency: 4 threads (target='default')
2022-02-23 17:24:37.834757 (MainThread): 17:24:37  
2022-02-23 17:24:37.837399 (Thread-1): 17:24:37  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:24:37.837719 (Thread-1): 17:24:37  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:24:37.838051 (Thread-1): 17:24:37  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:24:37.838165 (Thread-1): 17:24:37  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:24:37.838263 (Thread-1): 17:24:37  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:24:37.841316 (Thread-1): 17:24:37  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:24:37.841566 (Thread-2): 17:24:37  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:24:37.841804 (Thread-2): 17:24:37  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:24:37.842107 (Thread-2): 17:24:37  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:24:37.842199 (Thread-2): 17:24:37  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:24:37.842279 (Thread-2): 17:24:37  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:24:37.845626 (Thread-3): 17:24:37  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:24:37.845860 (Thread-3): 17:24:37  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:24:37.846141 (Thread-3): 17:24:37  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:24:37.846230 (Thread-3): 17:24:37  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:24:37.846309 (Thread-3): 17:24:37  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:24:37.868395 (Thread-3): 17:24:37  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:24:37.872102 (Thread-2): 17:24:37  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:24:37.873238 (Thread-1): 17:24:37  finished collecting timing info
2022-02-23 17:24:37.873409 (Thread-1): 17:24:37  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:24:37.905338 (Thread-1): 17:24:37  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:24:37.910753 (Thread-2): 17:24:37  finished collecting timing info
2022-02-23 17:24:37.910920 (Thread-2): 17:24:37  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:24:37.915840 (Thread-3): 17:24:37  finished collecting timing info
2022-02-23 17:24:37.915981 (Thread-3): 17:24:37  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:24:37.935623 (Thread-3): 17:24:37  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:24:37.936566 (Thread-2): 17:24:37  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:24:37.944056 (Thread-1): 17:24:37  Opening a new connection, currently in state closed
2022-02-23 17:24:37.948516 (Thread-1): 17:24:37  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:24:37.952844 (Thread-3): 17:24:37  Opening a new connection, currently in state init
2022-02-23 17:24:37.953199 (Thread-2): 17:24:37  Opening a new connection, currently in state init
2022-02-23 17:24:37.957523 (Thread-3): 17:24:37  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:24:37.958461 (Thread-2): 17:24:37  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:24:38.532218 (Thread-3): 17:24:38  finished collecting timing info
2022-02-23 17:24:38.532647 (Thread-3): 17:24:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3db618-fd25-4155-a71e-f1251cae9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d05a85b0>]}
2022-02-23 17:24:38.532995 (Thread-3): 17:24:38  3 of 5 OK created view model dbt_orukosueva.stg_yellow_tripdata................. [OK in 0.69s]
2022-02-23 17:24:38.533116 (Thread-3): 17:24:38  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:24:38.535620 (Thread-2): 17:24:38  finished collecting timing info
2022-02-23 17:24:38.535979 (Thread-2): 17:24:38  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3db618-fd25-4155-a71e-f1251cae9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d04d71c0>]}
2022-02-23 17:24:38.536275 (Thread-2): 17:24:38  2 of 5 OK created view model dbt_orukosueva.stg_green_tripdata.................. [OK in 0.69s]
2022-02-23 17:24:38.536383 (Thread-2): 17:24:38  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:24:38.575771 (Thread-189): handling poll request
2022-02-23 17:24:38.576072 (Thread-189): 17:24:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd1366d0>]}
2022-02-23 17:24:38.577002 (Thread-189): sending response (<Response 22986 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:24:40.112596 (Thread-190): handling poll request
2022-02-23 17:24:40.112976 (Thread-190): 17:24:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdd136d30>]}
2022-02-23 17:24:40.113484 (Thread-190): sending response (<Response 286 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:24:40.611707 (Thread-1): 17:24:40  finished collecting timing info
2022-02-23 17:24:40.612154 (Thread-1): 17:24:40  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3db618-fd25-4155-a71e-f1251cae9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d1e8f850>]}
2022-02-23 17:24:40.612491 (Thread-1): 17:24:40  1 of 5 OK created table model dbt_orukosueva.dim_zones.......................... [CREATE TABLE (265.0 rows, 14.2 KB processed) in 2.77s]
2022-02-23 17:24:40.612603 (Thread-1): 17:24:40  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:24:40.613575 (Thread-4): 17:24:40  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:24:40.613847 (Thread-4): 17:24:40  4 of 5 START table model dbt_orukosueva.fact_trips.............................. [RUN]
2022-02-23 17:24:40.614158 (Thread-4): 17:24:40  Acquiring new bigquery connection "model.taxi_rides_ny.fact_trips"
2022-02-23 17:24:40.614255 (Thread-4): 17:24:40  Began compiling node model.taxi_rides_ny.fact_trips
2022-02-23 17:24:40.614339 (Thread-4): 17:24:40  Compiling model.taxi_rides_ny.fact_trips
2022-02-23 17:24:40.617836 (Thread-4): 17:24:40  Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:24:40.627305 (Thread-4): 17:24:40  finished collecting timing info
2022-02-23 17:24:40.627441 (Thread-4): 17:24:40  Began executing node model.taxi_rides_ny.fact_trips
2022-02-23 17:24:40.631127 (Thread-4): 17:24:40  Writing runtime SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:24:40.640648 (Thread-4): 17:24:40  Opening a new connection, currently in state init
2022-02-23 17:24:40.645159 (Thread-4): 17:24:40  On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.fact_trips"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
  
  
  OPTIONS()
  as (
    

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
    select * from green_data
    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
  );
  
2022-02-23 17:24:41.235092 (Thread-4): 17:24:41  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column 8 in UNION ALL has incompatible types: BOOL, STRING at [26:5]')
2022-02-23 17:24:41.926814 (Thread-191): handling poll request
2022-02-23 17:24:41.927222 (Thread-191): 17:24:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c38e460>]}
2022-02-23 17:24:41.927902 (Thread-191): sending response (<Response 8820 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:24:42.723802 (Thread-4): 17:24:42  finished collecting timing info
2022-02-23 17:24:42.724260 (Thread-4): 17:24:42  Database Error in model fact_trips (models/core/fact_trips.sql)
  Column 8 in UNION ALL has incompatible types: BOOL, STRING at [26:5]
  compiled SQL at target/run/taxi_rides_ny/models/core/fact_trips.sql
2022-02-23 17:24:42.724448 (Thread-4): 17:24:42  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a3db618-fd25-4155-a71e-f1251cae9102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5d0536d60>]}
2022-02-23 17:24:42.724787 (Thread-4): 17:24:42  4 of 5 ERROR creating table model dbt_orukosueva.fact_trips..................... [ERROR in 2.11s]
2022-02-23 17:24:42.724899 (Thread-4): 17:24:42  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:24:42.726039 (Thread-2): 17:24:42  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:24:42.726223 (Thread-2): 17:24:42  5 of 5 SKIP relation dbt_orukosueva.dm_monthly_zone_revenue..................... [SKIP]
2022-02-23 17:24:42.726327 (Thread-2): 17:24:42  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:24:42.727841 (MainThread): 17:24:42  Acquiring new bigquery connection "master"
2022-02-23 17:24:42.728350 (MainThread): 17:24:42  
2022-02-23 17:24:42.728524 (MainThread): 17:24:42  Finished running 2 view models, 3 table models in 5.76s.
2022-02-23 17:24:42.728661 (MainThread): 17:24:42  Connection 'master' was properly closed.
2022-02-23 17:24:42.728738 (MainThread): 17:24:42  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:24:42.728803 (MainThread): 17:24:42  Connection 'model.taxi_rides_ny.stg_green_tripdata' was properly closed.
2022-02-23 17:24:42.728866 (MainThread): 17:24:42  Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
2022-02-23 17:24:42.728927 (MainThread): 17:24:42  Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
2022-02-23 17:24:42.802934 (MainThread): 17:24:42  
2022-02-23 17:24:42.803102 (MainThread): 17:24:42  Completed with 1 error and 0 warnings:
2022-02-23 17:24:42.803192 (MainThread): 17:24:42  
2022-02-23 17:24:42.803280 (MainThread): 17:24:42  Database Error in model fact_trips (models/core/fact_trips.sql)
2022-02-23 17:24:42.803355 (MainThread): 17:24:42    Column 8 in UNION ALL has incompatible types: BOOL, STRING at [26:5]
2022-02-23 17:24:42.803424 (MainThread): 17:24:42    compiled SQL at target/run/taxi_rides_ny/models/core/fact_trips.sql
2022-02-23 17:24:42.803505 (MainThread): 17:24:42  
2022-02-23 17:24:42.803583 (MainThread): 17:24:42  Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
2022-02-23 17:24:43.342004 (Thread-192): handling poll request
2022-02-23 17:24:43.342626 (Thread-192): 17:24:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c38e430>]}
2022-02-23 17:24:43.344288 (Thread-192): sending response (<Response 42389 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:24:44.692565 (Thread-193): handling status request
2022-02-23 17:24:44.692939 (Thread-193): 17:24:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc137be0>]}
2022-02-23 17:24:44.693529 (Thread-193): sending response (<Response 3751 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:24:44.777035 (Thread-194): handling status request
2022-02-23 17:24:44.777375 (Thread-194): 17:24:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c38c1c0>]}
2022-02-23 17:24:44.777897 (Thread-194): sending response (<Response 3751 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:26:00.718751 (Thread-195): handling status request
2022-02-23 17:26:00.720520 (Thread-195): 17:26:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3b5730>]}
2022-02-23 17:26:00.721100 (Thread-195): sending response (<Response 3751 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:26:00.975960 (Thread-196): handling status request
2022-02-23 17:26:00.976369 (Thread-196): 17:26:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3b5b20>]}
2022-02-23 17:26:00.976948 (Thread-196): sending response (<Response 3751 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:26:01.332954 (Thread-197): handling cli_args request
2022-02-23 17:26:01.333322 (Thread-197): 17:26:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3b5dc0>]}
2022-02-23 17:26:03.562263 (Thread-197): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:26:03.945504 (MainThread): 17:26:03  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:26:03.946020 (MainThread): 17:26:03  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:26:03.953102 (MainThread): 17:26:03  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f2b4e35-7c51-4b6f-a4e9-b5e4f26244da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836e509c40>]}
2022-02-23 17:26:03.983258 (MainThread): 17:26:03  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f2b4e35-7c51-4b6f-a4e9-b5e4f26244da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836ed63cd0>]}
2022-02-23 17:26:03.983543 (MainThread): 17:26:03  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:26:03.985270 (MainThread): 17:26:03  
2022-02-23 17:26:03.985588 (MainThread): 17:26:03  Acquiring new bigquery connection "master"
2022-02-23 17:26:03.986681 (ThreadPoolExecutor-0_0): 17:26:03  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:26:03.986835 (ThreadPoolExecutor-0_0): 17:26:03  Opening a new connection, currently in state init
2022-02-23 17:26:04.242471 (ThreadPoolExecutor-1_0): 17:26:04  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:26:04.242654 (ThreadPoolExecutor-1_0): 17:26:04  Opening a new connection, currently in state closed
2022-02-23 17:26:04.449813 (MainThread): 17:26:04  Concurrency: 4 threads (target='default')
2022-02-23 17:26:04.450021 (MainThread): 17:26:04  
2022-02-23 17:26:04.451621 (Thread-198): handling poll request
2022-02-23 17:26:04.451992 (Thread-198): 17:26:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c339550>]}
2022-02-23 17:26:04.452891 (Thread-198): sending response (<Response 4536 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:26:04.452745 (Thread-1): 17:26:04  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:04.453041 (Thread-1): 17:26:04  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:26:04.453349 (Thread-1): 17:26:04  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:26:04.453455 (Thread-1): 17:26:04  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:04.453553 (Thread-1): 17:26:04  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:26:04.456595 (Thread-1): 17:26:04  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:26:04.456850 (Thread-2): 17:26:04  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:04.457075 (Thread-2): 17:26:04  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:26:04.457352 (Thread-2): 17:26:04  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:26:04.457455 (Thread-2): 17:26:04  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:04.457537 (Thread-2): 17:26:04  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:04.460753 (Thread-3): 17:26:04  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:04.460977 (Thread-3): 17:26:04  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:26:04.461234 (Thread-3): 17:26:04  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:26:04.461321 (Thread-3): 17:26:04  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:04.461400 (Thread-3): 17:26:04  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:04.482082 (Thread-3): 17:26:04  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:26:04.485893 (Thread-2): 17:26:04  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:26:04.488293 (Thread-1): 17:26:04  finished collecting timing info
2022-02-23 17:26:04.488445 (Thread-1): 17:26:04  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:04.502282 (Thread-1): 17:26:04  Opening a new connection, currently in state closed
2022-02-23 17:26:04.508615 (Thread-2): 17:26:04  finished collecting timing info
2022-02-23 17:26:04.508759 (Thread-2): 17:26:04  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:04.513795 (Thread-3): 17:26:04  finished collecting timing info
2022-02-23 17:26:04.513964 (Thread-3): 17:26:04  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:04.541692 (Thread-3): 17:26:04  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:26:04.543073 (Thread-2): 17:26:04  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:26:04.560110 (Thread-3): 17:26:04  Opening a new connection, currently in state init
2022-02-23 17:26:04.560375 (Thread-2): 17:26:04  Opening a new connection, currently in state init
2022-02-23 17:26:04.564823 (Thread-2): 17:26:04  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:26:04.565793 (Thread-3): 17:26:04  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:26:04.747852 (Thread-1): 17:26:04  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:26:04.763746 (Thread-1): 17:26:04  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:26:05.894590 (Thread-2): 17:26:05  finished collecting timing info
2022-02-23 17:26:05.895024 (Thread-2): 17:26:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2b4e35-7c51-4b6f-a4e9-b5e4f26244da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836c472490>]}
2022-02-23 17:26:05.895362 (Thread-2): 17:26:05  2 of 5 OK created view model dbt_orukosueva.stg_green_tripdata.................. [OK in 1.44s]
2022-02-23 17:26:05.895480 (Thread-2): 17:26:05  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:05.959975 (Thread-3): 17:26:05  finished collecting timing info
2022-02-23 17:26:05.960376 (Thread-3): 17:26:05  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2b4e35-7c51-4b6f-a4e9-b5e4f26244da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836c3a9610>]}
2022-02-23 17:26:05.960686 (Thread-3): 17:26:05  3 of 5 OK created view model dbt_orukosueva.stg_yellow_tripdata................. [OK in 1.50s]
2022-02-23 17:26:05.960793 (Thread-3): 17:26:05  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:06.092187 (Thread-199): handling poll request
2022-02-23 17:26:06.092575 (Thread-199): 17:26:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c355b20>]}
2022-02-23 17:26:06.093617 (Thread-199): sending response (<Response 21789 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:26:06.472900 (Thread-1): 17:26:06  finished collecting timing info
2022-02-23 17:26:06.473352 (Thread-1): 17:26:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2b4e35-7c51-4b6f-a4e9-b5e4f26244da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836c43d8b0>]}
2022-02-23 17:26:06.473689 (Thread-1): 17:26:06  1 of 5 OK created table model dbt_orukosueva.dim_zones.......................... [CREATE TABLE (265.0 rows, 14.2 KB processed) in 2.02s]
2022-02-23 17:26:06.473801 (Thread-1): 17:26:06  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:06.474747 (Thread-4): 17:26:06  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:26:06.475004 (Thread-4): 17:26:06  4 of 5 START table model dbt_orukosueva.fact_trips.............................. [RUN]
2022-02-23 17:26:06.475277 (Thread-4): 17:26:06  Acquiring new bigquery connection "model.taxi_rides_ny.fact_trips"
2022-02-23 17:26:06.475370 (Thread-4): 17:26:06  Began compiling node model.taxi_rides_ny.fact_trips
2022-02-23 17:26:06.475455 (Thread-4): 17:26:06  Compiling model.taxi_rides_ny.fact_trips
2022-02-23 17:26:06.479140 (Thread-4): 17:26:06  Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:26:06.492559 (Thread-4): 17:26:06  finished collecting timing info
2022-02-23 17:26:06.492753 (Thread-4): 17:26:06  Began executing node model.taxi_rides_ny.fact_trips
2022-02-23 17:26:06.496316 (Thread-4): 17:26:06  Writing runtime SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:26:06.510032 (Thread-4): 17:26:06  Opening a new connection, currently in state init
2022-02-23 17:26:06.514406 (Thread-4): 17:26:06  On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.fact_trips"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
  
  
  OPTIONS()
  as (
    

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
    select * from green_data
    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
  );
  
2022-02-23 17:26:07.497103 (Thread-200): handling poll request
2022-02-23 17:26:07.497475 (Thread-200): 17:26:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c36f3a0>]}
2022-02-23 17:26:07.498141 (Thread-200): sending response (<Response 8398 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:26:07.550117 (Thread-4): 17:26:07  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column 8 in UNION ALL has incompatible types: BOOL, STRING at [26:5]')
2022-02-23 17:26:08.926267 (Thread-201): handling poll request
2022-02-23 17:26:08.926633 (Thread-201): 17:26:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c36f6d0>]}
2022-02-23 17:26:08.927132 (Thread-201): sending response (<Response 706 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:26:09.110837 (Thread-4): 17:26:09  finished collecting timing info
2022-02-23 17:26:09.111287 (Thread-4): 17:26:09  Database Error in model fact_trips (models/core/fact_trips.sql)
  Column 8 in UNION ALL has incompatible types: BOOL, STRING at [26:5]
  compiled SQL at target/run/taxi_rides_ny/models/core/fact_trips.sql
2022-02-23 17:26:09.111483 (Thread-4): 17:26:09  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f2b4e35-7c51-4b6f-a4e9-b5e4f26244da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f836c47fa60>]}
2022-02-23 17:26:09.112000 (Thread-4): 17:26:09  4 of 5 ERROR creating table model dbt_orukosueva.fact_trips..................... [ERROR in 2.64s]
2022-02-23 17:26:09.112123 (Thread-4): 17:26:09  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:26:09.112972 (Thread-3): 17:26:09  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:26:09.113145 (Thread-3): 17:26:09  5 of 5 SKIP relation dbt_orukosueva.dm_monthly_zone_revenue..................... [SKIP]
2022-02-23 17:26:09.113251 (Thread-3): 17:26:09  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:26:09.114608 (MainThread): 17:26:09  Acquiring new bigquery connection "master"
2022-02-23 17:26:09.114933 (MainThread): 17:26:09  
2022-02-23 17:26:09.115031 (MainThread): 17:26:09  Finished running 2 view models, 3 table models in 5.13s.
2022-02-23 17:26:09.115114 (MainThread): 17:26:09  Connection 'master' was properly closed.
2022-02-23 17:26:09.115182 (MainThread): 17:26:09  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:26:09.115245 (MainThread): 17:26:09  Connection 'model.taxi_rides_ny.stg_green_tripdata' was properly closed.
2022-02-23 17:26:09.115306 (MainThread): 17:26:09  Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
2022-02-23 17:26:09.115367 (MainThread): 17:26:09  Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
2022-02-23 17:26:09.173784 (MainThread): 17:26:09  
2022-02-23 17:26:09.173992 (MainThread): 17:26:09  Completed with 1 error and 0 warnings:
2022-02-23 17:26:09.174087 (MainThread): 17:26:09  
2022-02-23 17:26:09.174176 (MainThread): 17:26:09  Database Error in model fact_trips (models/core/fact_trips.sql)
2022-02-23 17:26:09.174257 (MainThread): 17:26:09    Column 8 in UNION ALL has incompatible types: BOOL, STRING at [26:5]
2022-02-23 17:26:09.174330 (MainThread): 17:26:09    compiled SQL at target/run/taxi_rides_ny/models/core/fact_trips.sql
2022-02-23 17:26:09.174409 (MainThread): 17:26:09  
2022-02-23 17:26:09.174488 (MainThread): 17:26:09  Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
2022-02-23 17:26:10.391046 (Thread-202): handling poll request
2022-02-23 17:26:10.391422 (Thread-202): 17:26:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c2fb700>]}
2022-02-23 17:26:10.393046 (Thread-202): sending response (<Response 42390 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:26:11.364758 (Thread-203): handling status request
2022-02-23 17:26:11.365127 (Thread-203): 17:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c2fb8b0>]}
2022-02-23 17:26:11.365742 (Thread-203): sending response (<Response 3751 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:26:11.429755 (Thread-204): handling status request
2022-02-23 17:26:11.430101 (Thread-204): 17:26:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c2fbca0>]}
2022-02-23 17:26:11.430608 (Thread-204): sending response (<Response 3751 bytes [200 OK]>) to 10.0.30.15
2022-02-23 17:26:47.726085 (Thread-205): 17:26:47  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-02-23 17:26:47.726742 (Thread-205): 17:26:47  Partial parsing: updated file: taxi_rides_ny://models/core/fact_trips.sql
2022-02-23 17:26:47.733014 (Thread-205): 17:26:47  1699: static parser successfully parsed core/fact_trips.sql
2022-02-23 17:26:47.811565 (Thread-205): 17:26:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1893a0>]}
2022-02-23 17:26:48.325611 (Thread-206): handling status request
2022-02-23 17:26:48.326033 (Thread-206): 17:26:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cfc135d00>]}
2022-02-23 17:26:48.326548 (Thread-206): sending response (<Response 1559 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:26:48.541117 (Thread-207): handling status request
2022-02-23 17:26:48.541485 (Thread-207): 17:26:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1e9e50>]}
2022-02-23 17:26:48.541980 (Thread-207): sending response (<Response 1559 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:26:51.675488 (Thread-208): handling status request
2022-02-23 17:26:51.675864 (Thread-208): 17:26:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1e9d00>]}
2022-02-23 17:26:51.676341 (Thread-208): sending response (<Response 1559 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:26:51.997687 (Thread-209): handling status request
2022-02-23 17:26:51.998104 (Thread-209): 17:26:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1e9b20>]}
2022-02-23 17:26:51.998590 (Thread-209): sending response (<Response 1559 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:26:52.076015 (Thread-210): handling cli_args request
2022-02-23 17:26:52.076366 (Thread-210): 17:26:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c355880>]}
2022-02-23 17:26:54.209606 (Thread-210): sending response (<Response 138 bytes [200 OK]>) to 10.0.30.15
2022-02-23 17:26:54.497472 (MainThread): 17:26:54  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:26:54.497944 (MainThread): 17:26:54  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:26:54.504766 (MainThread): 17:26:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a98728da-0e4d-4810-a0f6-de754877d952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd72a49a0>]}
2022-02-23 17:26:54.540918 (MainThread): 17:26:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a98728da-0e4d-4810-a0f6-de754877d952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd7bd6940>]}
2022-02-23 17:26:54.541153 (MainThread): 17:26:54  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:26:54.542649 (MainThread): 17:26:54  
2022-02-23 17:26:54.542925 (MainThread): 17:26:54  Acquiring new bigquery connection "master"
2022-02-23 17:26:54.543874 (ThreadPoolExecutor-0_0): 17:26:54  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:26:54.544025 (ThreadPoolExecutor-0_0): 17:26:54  Opening a new connection, currently in state init
2022-02-23 17:26:54.630594 (Thread-211): handling poll request
2022-02-23 17:26:54.631027 (Thread-211): 17:26:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c189b20>]}
2022-02-23 17:26:54.631960 (Thread-211): sending response (<Response 3339 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:26:55.185190 (ThreadPoolExecutor-1_0): 17:26:55  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:26:55.185371 (ThreadPoolExecutor-1_0): 17:26:55  Opening a new connection, currently in state closed
2022-02-23 17:26:55.397083 (MainThread): 17:26:55  Concurrency: 4 threads (target='default')
2022-02-23 17:26:55.397251 (MainThread): 17:26:55  
2022-02-23 17:26:55.399962 (Thread-1): 17:26:55  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:55.400272 (Thread-1): 17:26:55  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:26:55.400535 (Thread-1): 17:26:55  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:26:55.400634 (Thread-1): 17:26:55  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:55.400737 (Thread-1): 17:26:55  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:26:55.403718 (Thread-1): 17:26:55  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:26:55.403955 (Thread-2): 17:26:55  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:55.404192 (Thread-2): 17:26:55  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:26:55.404442 (Thread-2): 17:26:55  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:26:55.404527 (Thread-2): 17:26:55  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:55.404607 (Thread-2): 17:26:55  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:55.407549 (Thread-3): 17:26:55  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:55.407765 (Thread-3): 17:26:55  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:26:55.408014 (Thread-3): 17:26:55  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:26:55.408099 (Thread-3): 17:26:55  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:55.408178 (Thread-3): 17:26:55  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:55.427282 (Thread-3): 17:26:55  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:26:55.433133 (Thread-2): 17:26:55  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:26:55.433680 (Thread-1): 17:26:55  finished collecting timing info
2022-02-23 17:26:55.433825 (Thread-1): 17:26:55  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:55.447171 (Thread-1): 17:26:55  Opening a new connection, currently in state closed
2022-02-23 17:26:55.453530 (Thread-3): 17:26:55  finished collecting timing info
2022-02-23 17:26:55.453672 (Thread-3): 17:26:55  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:55.468851 (Thread-2): 17:26:55  finished collecting timing info
2022-02-23 17:26:55.468994 (Thread-2): 17:26:55  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:55.482293 (Thread-3): 17:26:55  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:26:55.484047 (Thread-2): 17:26:55  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:26:55.498982 (Thread-2): 17:26:55  Opening a new connection, currently in state init
2022-02-23 17:26:55.499329 (Thread-3): 17:26:55  Opening a new connection, currently in state init
2022-02-23 17:26:55.503944 (Thread-3): 17:26:55  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:26:55.507666 (Thread-2): 17:26:55  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:26:55.691141 (Thread-1): 17:26:55  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:26:55.706476 (Thread-1): 17:26:55  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:26:56.083826 (Thread-212): handling poll request
2022-02-23 17:26:56.084214 (Thread-212): 17:26:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c186c70>]}
2022-02-23 17:26:56.085180 (Thread-212): sending response (<Response 19365 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:26:56.090119 (Thread-2): 17:26:56  finished collecting timing info
2022-02-23 17:26:56.090553 (Thread-2): 17:26:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a98728da-0e4d-4810-a0f6-de754877d952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd4208250>]}
2022-02-23 17:26:56.090890 (Thread-2): 17:26:56  2 of 5 OK created view model dbt_orukosueva.stg_green_tripdata.................. [OK in 0.69s]
2022-02-23 17:26:56.091005 (Thread-2): 17:26:56  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:26:56.585584 (Thread-3): 17:26:56  finished collecting timing info
2022-02-23 17:26:56.586087 (Thread-3): 17:26:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a98728da-0e4d-4810-a0f6-de754877d952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd4131fa0>]}
2022-02-23 17:26:56.586436 (Thread-3): 17:26:56  3 of 5 OK created view model dbt_orukosueva.stg_yellow_tripdata................. [OK in 1.18s]
2022-02-23 17:26:56.586549 (Thread-3): 17:26:56  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:26:57.588650 (Thread-213): handling poll request
2022-02-23 17:26:57.589026 (Thread-213): 17:26:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c2f04c0>]}
2022-02-23 17:26:57.589624 (Thread-213): sending response (<Response 3905 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:26:57.949379 (Thread-1): 17:26:57  finished collecting timing info
2022-02-23 17:26:57.949832 (Thread-1): 17:26:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a98728da-0e4d-4810-a0f6-de754877d952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd417d2e0>]}
2022-02-23 17:26:57.950218 (Thread-1): 17:26:57  1 of 5 OK created table model dbt_orukosueva.dim_zones.......................... [CREATE TABLE (265.0 rows, 14.2 KB processed) in 2.55s]
2022-02-23 17:26:57.950336 (Thread-1): 17:26:57  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:26:57.951344 (Thread-4): 17:26:57  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:26:57.951605 (Thread-4): 17:26:57  4 of 5 START table model dbt_orukosueva.fact_trips.............................. [RUN]
2022-02-23 17:26:57.951881 (Thread-4): 17:26:57  Acquiring new bigquery connection "model.taxi_rides_ny.fact_trips"
2022-02-23 17:26:57.951974 (Thread-4): 17:26:57  Began compiling node model.taxi_rides_ny.fact_trips
2022-02-23 17:26:57.952058 (Thread-4): 17:26:57  Compiling model.taxi_rides_ny.fact_trips
2022-02-23 17:26:57.955706 (Thread-4): 17:26:57  Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:26:57.971002 (Thread-4): 17:26:57  finished collecting timing info
2022-02-23 17:26:57.971305 (Thread-4): 17:26:57  Began executing node model.taxi_rides_ny.fact_trips
2022-02-23 17:26:57.974895 (Thread-4): 17:26:57  Writing runtime SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:26:57.989411 (Thread-4): 17:26:57  Opening a new connection, currently in state init
2022-02-23 17:26:57.993763 (Thread-4): 17:26:57  On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.fact_trips"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
  
  
  OPTIONS()
  as (
    

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
--    select * from green_data
--    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
  );
  
2022-02-23 17:26:59.045579 (Thread-214): handling poll request
2022-02-23 17:26:59.046022 (Thread-214): 17:26:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c2f0d00>]}
2022-02-23 17:26:59.046725 (Thread-214): sending response (<Response 8402 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:27:00.608201 (Thread-215): handling poll request
2022-02-23 17:27:00.608570 (Thread-215): 17:27:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c2f0eb0>]}
2022-02-23 17:27:00.609054 (Thread-215): sending response (<Response 286 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:27:02.125436 (Thread-216): handling poll request
2022-02-23 17:27:02.125829 (Thread-216): 17:27:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1ee160>]}
2022-02-23 17:27:02.126351 (Thread-216): sending response (<Response 286 bytes [200 OK]>) to 10.0.10.118
2022-02-23 17:27:02.273351 (Thread-4): 17:27:02  finished collecting timing info
2022-02-23 17:27:02.273824 (Thread-4): 17:27:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a98728da-0e4d-4810-a0f6-de754877d952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd41723d0>]}
2022-02-23 17:27:02.274248 (Thread-4): 17:27:02  4 of 5 OK created table model dbt_orukosueva.fact_trips......................... [CREATE TABLE (96.0 rows, 14.0 GB processed) in 4.32s]
2022-02-23 17:27:02.274374 (Thread-4): 17:27:02  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:27:02.275345 (Thread-3): 17:27:02  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:27:02.275597 (Thread-3): 17:27:02  5 of 5 START table model dbt_orukosueva.dm_monthly_zone_revenue................. [RUN]
2022-02-23 17:27:02.275849 (Thread-3): 17:27:02  Acquiring new bigquery connection "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:27:02.275940 (Thread-3): 17:27:02  Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:27:02.276027 (Thread-3): 17:27:02  Compiling model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:27:02.279332 (Thread-3): 17:27:02  Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:27:02.289625 (Thread-3): 17:27:02  finished collecting timing info
2022-02-23 17:27:02.289766 (Thread-3): 17:27:02  Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:27:02.291989 (Thread-3): 17:27:02  Writing runtime SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:27:02.301975 (Thread-3): 17:27:02  Opening a new connection, currently in state closed
2022-02-23 17:27:02.306344 (Thread-3): 17:27:02  On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dm_monthly_zone_revenue`
  
  
  OPTIONS()
  as (
    

with trips_data as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    date_trunc('month', pickup_datetime) as revenue_month, 
    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,
    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_montly_passenger_count,
    avg(trip_distance) as avg_montly_trip_distance

    from trips_data
    group by 1,2,3
  );
  
2022-02-23 17:27:02.895075 (Thread-3): 17:27:02  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('A valid date part name is required but found pickup_datetime at [17:25]')
2022-02-23 17:27:03.672246 (Thread-217): handling poll request
2022-02-23 17:27:03.672625 (Thread-217): 17:27:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1eea90>]}
2022-02-23 17:27:03.673310 (Thread-217): sending response (<Response 8456 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:27:04.380473 (Thread-3): 17:27:04  finished collecting timing info
2022-02-23 17:27:04.380927 (Thread-3): 17:27:04  Database Error in model dm_monthly_zone_revenue (models/core/dm_monthly_zone_revenue.sql)
  A valid date part name is required but found pickup_datetime at [17:25]
  compiled SQL at target/run/taxi_rides_ny/models/core/dm_monthly_zone_revenue.sql
2022-02-23 17:27:04.381117 (Thread-3): 17:27:04  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a98728da-0e4d-4810-a0f6-de754877d952', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0bd4189bb0>]}
2022-02-23 17:27:04.381598 (Thread-3): 17:27:04  5 of 5 ERROR creating table model dbt_orukosueva.dm_monthly_zone_revenue........ [ERROR in 2.11s]
2022-02-23 17:27:04.381716 (Thread-3): 17:27:04  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:27:04.383297 (MainThread): 17:27:04  Acquiring new bigquery connection "master"
2022-02-23 17:27:04.383627 (MainThread): 17:27:04  
2022-02-23 17:27:04.383724 (MainThread): 17:27:04  Finished running 2 view models, 3 table models in 9.84s.
2022-02-23 17:27:04.383805 (MainThread): 17:27:04  Connection 'master' was properly closed.
2022-02-23 17:27:04.383872 (MainThread): 17:27:04  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:27:04.383936 (MainThread): 17:27:04  Connection 'model.taxi_rides_ny.stg_green_tripdata' was properly closed.
2022-02-23 17:27:04.383997 (MainThread): 17:27:04  Connection 'model.taxi_rides_ny.dm_monthly_zone_revenue' was properly closed.
2022-02-23 17:27:04.384057 (MainThread): 17:27:04  Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
2022-02-23 17:27:04.456502 (MainThread): 17:27:04  
2022-02-23 17:27:04.456692 (MainThread): 17:27:04  Completed with 1 error and 0 warnings:
2022-02-23 17:27:04.456782 (MainThread): 17:27:04  
2022-02-23 17:27:04.456872 (MainThread): 17:27:04  Database Error in model dm_monthly_zone_revenue (models/core/dm_monthly_zone_revenue.sql)
2022-02-23 17:27:04.456947 (MainThread): 17:27:04    A valid date part name is required but found pickup_datetime at [17:25]
2022-02-23 17:27:04.457031 (MainThread): 17:27:04    compiled SQL at target/run/taxi_rides_ny/models/core/dm_monthly_zone_revenue.sql
2022-02-23 17:27:04.457129 (MainThread): 17:27:04  
2022-02-23 17:27:04.457223 (MainThread): 17:27:04  Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-02-23 17:27:05.135832 (Thread-218): handling poll request
2022-02-23 17:27:05.136225 (Thread-218): 17:27:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c2527f0>]}
2022-02-23 17:27:05.159888 (Thread-218): sending response (<Response 42934 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:27:06.341018 (Thread-219): handling status request
2022-02-23 17:27:06.341393 (Thread-219): 17:27:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c252b80>]}
2022-02-23 17:27:06.341993 (Thread-219): sending response (<Response 1559 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:27:06.498116 (Thread-220): handling status request
2022-02-23 17:27:06.498447 (Thread-220): 17:27:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c252d90>]}
2022-02-23 17:27:06.498950 (Thread-220): sending response (<Response 1559 bytes [200 OK]>) to 10.0.30.15
2022-02-23 17:29:11.692955 (Thread-221): 17:29:11  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:29:11.694404 (Thread-221): 17:29:11  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:29:11.700859 (Thread-221): 17:29:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c05ceb0>]}
2022-02-23 17:29:12.292306 (Thread-222): handling status request
2022-02-23 17:29:12.292713 (Thread-222): 17:29:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1d2100>]}
2022-02-23 17:29:12.293225 (Thread-222): sending response (<Response 1244 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:29:12.364128 (Thread-223): handling status request
2022-02-23 17:29:12.364537 (Thread-223): 17:29:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c30fc10>]}
2022-02-23 17:29:12.371774 (Thread-223): sending response (<Response 1244 bytes [200 OK]>) to 10.0.10.118
2022-02-23 17:29:30.504174 (Thread-224): 17:29:30  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:29:30.504404 (Thread-224): 17:29:30  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:29:30.510579 (Thread-224): 17:29:30  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6c46a0>]}
2022-02-23 17:29:31.116947 (Thread-225): handling status request
2022-02-23 17:29:31.117356 (Thread-225): 17:29:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c0465e0>]}
2022-02-23 17:29:31.117865 (Thread-225): sending response (<Response 1244 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:29:31.688918 (Thread-226): handling status request
2022-02-23 17:29:31.689271 (Thread-226): 17:29:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c0465e0>]}
2022-02-23 17:29:31.689731 (Thread-226): sending response (<Response 1244 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:29:45.545143 (Thread-227): 17:29:45  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:29:45.545395 (Thread-227): 17:29:45  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:29:45.551606 (Thread-227): 17:29:45  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c09ce80>]}
2022-02-23 17:29:46.699282 (Thread-228): handling status request
2022-02-23 17:29:46.699668 (Thread-228): 17:29:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c0c2be0>]}
2022-02-23 17:29:46.700145 (Thread-228): sending response (<Response 1244 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:29:46.857038 (Thread-229): handling status request
2022-02-23 17:29:46.857418 (Thread-229): 17:29:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c0c2580>]}
2022-02-23 17:29:46.857945 (Thread-229): sending response (<Response 1244 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:29:52.557359 (Thread-230): handling status request
2022-02-23 17:29:52.557734 (Thread-230): 17:29:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c3db610>]}
2022-02-23 17:29:52.558245 (Thread-230): sending response (<Response 1244 bytes [200 OK]>) to 10.0.18.116
2022-02-23 17:29:52.713668 (Thread-231): handling status request
2022-02-23 17:29:52.714077 (Thread-231): 17:29:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1b27f0>]}
2022-02-23 17:29:52.714548 (Thread-231): sending response (<Response 1244 bytes [200 OK]>) to 10.0.18.116
2022-02-23 17:29:52.967346 (Thread-232): handling cli_args request
2022-02-23 17:29:52.967759 (Thread-232): 17:29:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1b2fa0>]}
2022-02-23 17:29:56.820136 (Thread-232): sending response (<Response 138 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:29:57.245022 (MainThread): 17:29:57  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:29:57.245443 (MainThread): 17:29:57  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:29:57.252361 (MainThread): 17:29:57  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '409794b0-c86c-4858-9453-1a9b0281e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b49411ac0>]}
2022-02-23 17:29:57.294201 (MainThread): 17:29:57  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '409794b0-c86c-4858-9453-1a9b0281e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b49d35a60>]}
2022-02-23 17:29:57.294469 (MainThread): 17:29:57  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:29:57.295969 (MainThread): 17:29:57  
2022-02-23 17:29:57.296272 (MainThread): 17:29:57  Acquiring new bigquery connection "master"
2022-02-23 17:29:57.297262 (ThreadPoolExecutor-0_0): 17:29:57  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:29:57.297413 (ThreadPoolExecutor-0_0): 17:29:57  Opening a new connection, currently in state init
2022-02-23 17:29:57.354635 (Thread-233): handling poll request
2022-02-23 17:29:57.355089 (Thread-233): 17:29:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1b2df0>]}
2022-02-23 17:29:57.356005 (Thread-233): sending response (<Response 3338 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:29:57.954584 (ThreadPoolExecutor-1_0): 17:29:57  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:29:57.954771 (ThreadPoolExecutor-1_0): 17:29:57  Opening a new connection, currently in state closed
2022-02-23 17:29:58.162037 (MainThread): 17:29:58  Concurrency: 4 threads (target='default')
2022-02-23 17:29:58.162203 (MainThread): 17:29:58  
2022-02-23 17:29:58.164815 (Thread-1): 17:29:58  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:29:58.165106 (Thread-1): 17:29:58  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:29:58.165379 (Thread-1): 17:29:58  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:29:58.165477 (Thread-1): 17:29:58  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:29:58.165573 (Thread-1): 17:29:58  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:29:58.168596 (Thread-1): 17:29:58  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:29:58.168856 (Thread-2): 17:29:58  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:29:58.169123 (Thread-2): 17:29:58  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:29:58.169389 (Thread-2): 17:29:58  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:29:58.169478 (Thread-2): 17:29:58  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:29:58.169560 (Thread-2): 17:29:58  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:29:58.172889 (Thread-3): 17:29:58  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:29:58.173116 (Thread-3): 17:29:58  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:29:58.173378 (Thread-3): 17:29:58  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:29:58.173472 (Thread-3): 17:29:58  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:29:58.173556 (Thread-3): 17:29:58  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:29:58.193552 (Thread-3): 17:29:58  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:29:58.197908 (Thread-2): 17:29:58  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:29:58.205693 (Thread-1): 17:29:58  finished collecting timing info
2022-02-23 17:29:58.205844 (Thread-1): 17:29:58  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:29:58.219457 (Thread-1): 17:29:58  Opening a new connection, currently in state closed
2022-02-23 17:29:58.221015 (Thread-2): 17:29:58  finished collecting timing info
2022-02-23 17:29:58.221203 (Thread-2): 17:29:58  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:29:58.226419 (Thread-3): 17:29:58  finished collecting timing info
2022-02-23 17:29:58.226552 (Thread-3): 17:29:58  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:29:58.257503 (Thread-3): 17:29:58  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:29:58.258745 (Thread-2): 17:29:58  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:29:58.276834 (Thread-3): 17:29:58  Opening a new connection, currently in state init
2022-02-23 17:29:58.277142 (Thread-2): 17:29:58  Opening a new connection, currently in state init
2022-02-23 17:29:58.281618 (Thread-2): 17:29:58  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:29:58.282676 (Thread-3): 17:29:58  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:29:58.517995 (Thread-1): 17:29:58  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:29:58.534792 (Thread-1): 17:29:58  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:29:58.914247 (Thread-2): 17:29:58  finished collecting timing info
2022-02-23 17:29:58.914678 (Thread-2): 17:29:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409794b0-c86c-4858-9453-1a9b0281e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4837d4c0>]}
2022-02-23 17:29:58.915031 (Thread-2): 17:29:58  2 of 5 OK created view model dbt_orukosueva.stg_green_tripdata.................. [OK in 0.75s]
2022-02-23 17:29:58.915155 (Thread-2): 17:29:58  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:29:58.965151 (Thread-234): handling poll request
2022-02-23 17:29:58.965490 (Thread-234): 17:29:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c046100>]}
2022-02-23 17:29:58.966595 (Thread-234): sending response (<Response 21173 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:29:59.450746 (Thread-3): 17:29:59  finished collecting timing info
2022-02-23 17:29:59.451197 (Thread-3): 17:29:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409794b0-c86c-4858-9453-1a9b0281e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b482fb070>]}
2022-02-23 17:29:59.451691 (Thread-3): 17:29:59  3 of 5 OK created view model dbt_orukosueva.stg_yellow_tripdata................. [OK in 1.28s]
2022-02-23 17:29:59.451810 (Thread-3): 17:29:59  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:30:00.297748 (Thread-1): 17:30:00  finished collecting timing info
2022-02-23 17:30:00.298228 (Thread-1): 17:30:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409794b0-c86c-4858-9453-1a9b0281e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b49419e20>]}
2022-02-23 17:30:00.298565 (Thread-1): 17:30:00  1 of 5 OK created table model dbt_orukosueva.dim_zones.......................... [CREATE TABLE (265.0 rows, 14.2 KB processed) in 2.13s]
2022-02-23 17:30:00.298681 (Thread-1): 17:30:00  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:30:00.299740 (Thread-4): 17:30:00  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:30:00.300100 (Thread-4): 17:30:00  4 of 5 START table model dbt_orukosueva.fact_trips.............................. [RUN]
2022-02-23 17:30:00.300384 (Thread-4): 17:30:00  Acquiring new bigquery connection "model.taxi_rides_ny.fact_trips"
2022-02-23 17:30:00.300494 (Thread-4): 17:30:00  Began compiling node model.taxi_rides_ny.fact_trips
2022-02-23 17:30:00.300587 (Thread-4): 17:30:00  Compiling model.taxi_rides_ny.fact_trips
2022-02-23 17:30:00.304248 (Thread-4): 17:30:00  Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:30:00.322115 (Thread-4): 17:30:00  finished collecting timing info
2022-02-23 17:30:00.322260 (Thread-4): 17:30:00  Began executing node model.taxi_rides_ny.fact_trips
2022-02-23 17:30:00.325339 (Thread-4): 17:30:00  Opening a new connection, currently in state init
2022-02-23 17:30:00.440693 (Thread-235): handling poll request
2022-02-23 17:30:00.441095 (Thread-235): 17:30:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c09ceb0>]}
2022-02-23 17:30:00.441790 (Thread-235): sending response (<Response 7550 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:30:00.531374 (Thread-4): 17:30:00  Writing runtime SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:30:00.548035 (Thread-4): 17:30:00  On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.fact_trips"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
  
  
  OPTIONS()
  as (
    

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
--    select * from green_data
--    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
  );
  
2022-02-23 17:30:01.931167 (Thread-236): handling poll request
2022-02-23 17:30:01.931551 (Thread-236): 17:30:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c099a30>]}
2022-02-23 17:30:01.932084 (Thread-236): sending response (<Response 2949 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:30:03.466866 (Thread-237): handling poll request
2022-02-23 17:30:03.467309 (Thread-237): 17:30:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c099760>]}
2022-02-23 17:30:03.467850 (Thread-237): sending response (<Response 287 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:30:04.603035 (Thread-4): 17:30:04  finished collecting timing info
2022-02-23 17:30:04.603498 (Thread-4): 17:30:04  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409794b0-c86c-4858-9453-1a9b0281e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b482bd9d0>]}
2022-02-23 17:30:04.603839 (Thread-4): 17:30:04  4 of 5 OK created table model dbt_orukosueva.fact_trips......................... [CREATE TABLE (95.0 rows, 14.0 GB processed) in 4.30s]
2022-02-23 17:30:04.603977 (Thread-4): 17:30:04  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:30:04.604940 (Thread-3): 17:30:04  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:30:04.605197 (Thread-3): 17:30:04  5 of 5 START table model dbt_orukosueva.dm_monthly_zone_revenue................. [RUN]
2022-02-23 17:30:04.605449 (Thread-3): 17:30:04  Acquiring new bigquery connection "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:30:04.605552 (Thread-3): 17:30:04  Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:30:04.605651 (Thread-3): 17:30:04  Compiling model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:30:04.608608 (Thread-3): 17:30:04  Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:30:04.625398 (Thread-3): 17:30:04  finished collecting timing info
2022-02-23 17:30:04.625634 (Thread-3): 17:30:04  Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:30:04.628199 (Thread-3): 17:30:04  Writing runtime SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:30:04.645572 (Thread-3): 17:30:04  Opening a new connection, currently in state closed
2022-02-23 17:30:04.650749 (Thread-3): 17:30:04  On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dm_monthly_zone_revenue`
  
  
  OPTIONS()
  as (
    

with trips_data as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    date_trunc('month', pickup_datetime) as revenue_month, 
    --Note: For BQ use instead: date_trunc(pickup_datetime, month) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,
    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_montly_passenger_count,
    avg(trip_distance) as avg_montly_trip_distance

    from trips_data
    group by 1,2,3
  );
  
2022-02-23 17:30:04.971242 (Thread-238): handling poll request
2022-02-23 17:30:04.971616 (Thread-238): 17:30:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c099400>]}
2022-02-23 17:30:04.972287 (Thread-238): sending response (<Response 8018 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:30:05.800396 (Thread-3): 17:30:05  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('A valid date part name is required but found pickup_datetime at [17:25]')
2022-02-23 17:30:06.404465 (Thread-239): handling poll request
2022-02-23 17:30:06.404836 (Thread-239): 17:30:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c09a160>]}
2022-02-23 17:30:06.405331 (Thread-239): sending response (<Response 723 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:30:06.405652 (Thread-3): 17:30:06  finished collecting timing info
2022-02-23 17:30:06.406161 (Thread-3): 17:30:06  Database Error in model dm_monthly_zone_revenue (models/core/dm_monthly_zone_revenue.sql)
  A valid date part name is required but found pickup_datetime at [17:25]
  compiled SQL at target/run/taxi_rides_ny/models/core/dm_monthly_zone_revenue.sql
2022-02-23 17:30:06.406373 (Thread-3): 17:30:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409794b0-c86c-4858-9453-1a9b0281e329', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b482f2730>]}
2022-02-23 17:30:06.406691 (Thread-3): 17:30:06  5 of 5 ERROR creating table model dbt_orukosueva.dm_monthly_zone_revenue........ [ERROR in 1.80s]
2022-02-23 17:30:06.406803 (Thread-3): 17:30:06  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:30:06.408454 (MainThread): 17:30:06  Acquiring new bigquery connection "master"
2022-02-23 17:30:06.408766 (MainThread): 17:30:06  
2022-02-23 17:30:06.408863 (MainThread): 17:30:06  Finished running 2 view models, 3 table models in 9.11s.
2022-02-23 17:30:06.408942 (MainThread): 17:30:06  Connection 'master' was properly closed.
2022-02-23 17:30:06.409007 (MainThread): 17:30:06  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:30:06.409071 (MainThread): 17:30:06  Connection 'model.taxi_rides_ny.stg_green_tripdata' was properly closed.
2022-02-23 17:30:06.409132 (MainThread): 17:30:06  Connection 'model.taxi_rides_ny.dm_monthly_zone_revenue' was properly closed.
2022-02-23 17:30:06.409192 (MainThread): 17:30:06  Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
2022-02-23 17:30:06.488918 (MainThread): 17:30:06  
2022-02-23 17:30:06.489145 (MainThread): 17:30:06  Completed with 1 error and 0 warnings:
2022-02-23 17:30:06.489238 (MainThread): 17:30:06  
2022-02-23 17:30:06.489328 (MainThread): 17:30:06  Database Error in model dm_monthly_zone_revenue (models/core/dm_monthly_zone_revenue.sql)
2022-02-23 17:30:06.489407 (MainThread): 17:30:06    A valid date part name is required but found pickup_datetime at [17:25]
2022-02-23 17:30:06.489476 (MainThread): 17:30:06    compiled SQL at target/run/taxi_rides_ny/models/core/dm_monthly_zone_revenue.sql
2022-02-23 17:30:06.489560 (MainThread): 17:30:06  
2022-02-23 17:30:06.489641 (MainThread): 17:30:06  Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-02-23 17:30:07.863796 (Thread-240): handling poll request
2022-02-23 17:30:07.864182 (Thread-240): 17:30:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c09ae50>]}
2022-02-23 17:30:07.866004 (Thread-240): sending response (<Response 42934 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:30:09.044370 (Thread-241): handling status request
2022-02-23 17:30:09.044749 (Thread-241): 17:30:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c169040>]}
2022-02-23 17:30:09.045269 (Thread-241): sending response (<Response 1244 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:30:09.256289 (Thread-242): handling status request
2022-02-23 17:30:09.256665 (Thread-242): 17:30:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1693d0>]}
2022-02-23 17:30:09.257133 (Thread-242): sending response (<Response 1244 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:31:53.522763 (Thread-243): 17:31:53  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-02-23 17:31:53.524657 (Thread-243): 17:31:53  Partial parsing: updated file: taxi_rides_ny://models/core/dm_monthly_zone_revenue.sql
2022-02-23 17:31:53.531218 (Thread-243): 17:31:53  1699: static parser successfully parsed core/dm_monthly_zone_revenue.sql
2022-02-23 17:31:53.610429 (Thread-243): 17:31:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c69d370>]}
2022-02-23 17:31:54.290116 (Thread-244): handling status request
2022-02-23 17:31:54.290502 (Thread-244): 17:31:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c7077c0>]}
2022-02-23 17:31:54.290982 (Thread-244): sending response (<Response 1585 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:31:54.421043 (Thread-245): handling status request
2022-02-23 17:31:54.421427 (Thread-245): 17:31:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c707430>]}
2022-02-23 17:31:54.421947 (Thread-245): sending response (<Response 1585 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:31:57.212879 (Thread-246): handling status request
2022-02-23 17:31:57.213259 (Thread-246): 17:31:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c707250>]}
2022-02-23 17:31:57.213735 (Thread-246): sending response (<Response 1585 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:31:57.450840 (Thread-247): handling status request
2022-02-23 17:31:57.451207 (Thread-247): 17:31:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c707070>]}
2022-02-23 17:31:57.451679 (Thread-247): sending response (<Response 1585 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:31:57.677625 (Thread-248): handling cli_args request
2022-02-23 17:31:57.678029 (Thread-248): 17:31:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c72c3d0>]}
2022-02-23 17:31:59.802217 (Thread-248): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.118
2022-02-23 17:32:00.057174 (MainThread): 17:32:00  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:32:00.057612 (MainThread): 17:32:00  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:32:00.064590 (MainThread): 17:32:00  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d779c0a-cfc6-4d6f-98f4-8639bba3a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db4fbcbb0>]}
2022-02-23 17:32:00.096334 (MainThread): 17:32:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d779c0a-cfc6-4d6f-98f4-8639bba3a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db58f2b50>]}
2022-02-23 17:32:00.096577 (MainThread): 17:32:00  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:32:00.098071 (MainThread): 17:32:00  
2022-02-23 17:32:00.098359 (MainThread): 17:32:00  Acquiring new bigquery connection "master"
2022-02-23 17:32:00.099332 (ThreadPoolExecutor-0_0): 17:32:00  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:32:00.099483 (ThreadPoolExecutor-0_0): 17:32:00  Opening a new connection, currently in state init
2022-02-23 17:32:00.304653 (Thread-249): handling poll request
2022-02-23 17:32:00.305103 (Thread-249): 17:32:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c707550>]}
2022-02-23 17:32:00.306045 (Thread-249): sending response (<Response 3348 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:32:00.360989 (ThreadPoolExecutor-1_0): 17:32:00  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:32:00.361175 (ThreadPoolExecutor-1_0): 17:32:00  Opening a new connection, currently in state closed
2022-02-23 17:32:00.597537 (MainThread): 17:32:00  Concurrency: 4 threads (target='default')
2022-02-23 17:32:00.597707 (MainThread): 17:32:00  
2022-02-23 17:32:00.600418 (Thread-1): 17:32:00  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:32:00.600722 (Thread-1): 17:32:00  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:32:00.600981 (Thread-1): 17:32:00  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:32:00.601084 (Thread-1): 17:32:00  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:32:00.601182 (Thread-1): 17:32:00  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:32:00.604168 (Thread-1): 17:32:00  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:32:00.604413 (Thread-2): 17:32:00  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:32:00.604652 (Thread-2): 17:32:00  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:32:00.604910 (Thread-2): 17:32:00  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:32:00.604997 (Thread-2): 17:32:00  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:32:00.605075 (Thread-2): 17:32:00  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:32:00.608100 (Thread-3): 17:32:00  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:32:00.608321 (Thread-3): 17:32:00  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:32:00.608571 (Thread-3): 17:32:00  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:32:00.608658 (Thread-3): 17:32:00  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:32:00.608738 (Thread-3): 17:32:00  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:32:00.628605 (Thread-3): 17:32:00  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:32:00.633365 (Thread-2): 17:32:00  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:32:00.633698 (Thread-1): 17:32:00  finished collecting timing info
2022-02-23 17:32:00.633849 (Thread-1): 17:32:00  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:32:00.646881 (Thread-1): 17:32:00  Opening a new connection, currently in state closed
2022-02-23 17:32:00.653656 (Thread-3): 17:32:00  finished collecting timing info
2022-02-23 17:32:00.653819 (Thread-3): 17:32:00  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:32:00.659032 (Thread-2): 17:32:00  finished collecting timing info
2022-02-23 17:32:00.659177 (Thread-2): 17:32:00  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:32:00.694681 (Thread-2): 17:32:00  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:32:00.695543 (Thread-3): 17:32:00  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:32:00.708678 (Thread-2): 17:32:00  Opening a new connection, currently in state init
2022-02-23 17:32:00.709256 (Thread-3): 17:32:00  Opening a new connection, currently in state init
2022-02-23 17:32:00.713271 (Thread-2): 17:32:00  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:32:00.714660 (Thread-3): 17:32:00  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'


  limit 100

;


2022-02-23 17:32:00.897697 (Thread-1): 17:32:00  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:32:00.913680 (Thread-1): 17:32:00  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:32:01.420968 (Thread-3): 17:32:01  finished collecting timing info
2022-02-23 17:32:01.421421 (Thread-3): 17:32:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d779c0a-cfc6-4d6f-98f4-8639bba3a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db4668820>]}
2022-02-23 17:32:01.421795 (Thread-3): 17:32:01  3 of 5 OK created view model dbt_orukosueva.stg_yellow_tripdata................. [OK in 0.81s]
2022-02-23 17:32:01.421946 (Thread-3): 17:32:01  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:32:01.755312 (Thread-2): 17:32:01  finished collecting timing info
2022-02-23 17:32:01.755772 (Thread-2): 17:32:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d779c0a-cfc6-4d6f-98f4-8639bba3a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db46525b0>]}
2022-02-23 17:32:01.756109 (Thread-2): 17:32:01  2 of 5 OK created view model dbt_orukosueva.stg_green_tripdata.................. [OK in 1.15s]
2022-02-23 17:32:01.756220 (Thread-2): 17:32:01  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:32:01.904325 (Thread-250): handling poll request
2022-02-23 17:32:01.904714 (Thread-250): 17:32:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c7d0190>]}
2022-02-23 17:32:01.905792 (Thread-250): sending response (<Response 23031 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:32:02.653722 (Thread-1): 17:32:02  finished collecting timing info
2022-02-23 17:32:02.654239 (Thread-1): 17:32:02  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d779c0a-cfc6-4d6f-98f4-8639bba3a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db4fc2400>]}
2022-02-23 17:32:02.654592 (Thread-1): 17:32:02  1 of 5 OK created table model dbt_orukosueva.dim_zones.......................... [CREATE TABLE (265.0 rows, 14.2 KB processed) in 2.05s]
2022-02-23 17:32:02.654704 (Thread-1): 17:32:02  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:32:02.655758 (Thread-4): 17:32:02  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:32:02.656047 (Thread-4): 17:32:02  4 of 5 START table model dbt_orukosueva.fact_trips.............................. [RUN]
2022-02-23 17:32:02.656313 (Thread-4): 17:32:02  Acquiring new bigquery connection "model.taxi_rides_ny.fact_trips"
2022-02-23 17:32:02.656407 (Thread-4): 17:32:02  Began compiling node model.taxi_rides_ny.fact_trips
2022-02-23 17:32:02.656494 (Thread-4): 17:32:02  Compiling model.taxi_rides_ny.fact_trips
2022-02-23 17:32:02.660612 (Thread-4): 17:32:02  Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:32:02.672220 (Thread-4): 17:32:02  finished collecting timing info
2022-02-23 17:32:02.672368 (Thread-4): 17:32:02  Began executing node model.taxi_rides_ny.fact_trips
2022-02-23 17:32:02.675373 (Thread-4): 17:32:02  Opening a new connection, currently in state init
2022-02-23 17:32:03.054511 (Thread-4): 17:32:03  Writing runtime SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:32:03.079862 (Thread-4): 17:32:03  On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.fact_trips"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
  
  
  OPTIONS()
  as (
    

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
--    select * from green_data
--    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
  );
  
2022-02-23 17:32:03.369079 (Thread-251): handling poll request
2022-02-23 17:32:03.369481 (Thread-251): 17:32:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c704100>]}
2022-02-23 17:32:03.370267 (Thread-251): sending response (<Response 8417 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:32:04.857814 (Thread-252): handling poll request
2022-02-23 17:32:04.858254 (Thread-252): 17:32:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c7042b0>]}
2022-02-23 17:32:04.858773 (Thread-252): sending response (<Response 286 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:32:06.262249 (Thread-4): 17:32:06  finished collecting timing info
2022-02-23 17:32:06.262711 (Thread-4): 17:32:06  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d779c0a-cfc6-4d6f-98f4-8639bba3a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db46b91f0>]}
2022-02-23 17:32:06.263059 (Thread-4): 17:32:06  4 of 5 OK created table model dbt_orukosueva.fact_trips......................... [CREATE TABLE (93.0 rows, 14.0 GB processed) in 3.61s]
2022-02-23 17:32:06.263178 (Thread-4): 17:32:06  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:32:06.264287 (Thread-2): 17:32:06  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:32:06.264581 (Thread-2): 17:32:06  5 of 5 START table model dbt_orukosueva.dm_monthly_zone_revenue................. [RUN]
2022-02-23 17:32:06.264834 (Thread-2): 17:32:06  Acquiring new bigquery connection "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:32:06.264927 (Thread-2): 17:32:06  Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:32:06.265014 (Thread-2): 17:32:06  Compiling model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:32:06.267975 (Thread-2): 17:32:06  Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:32:06.281680 (Thread-2): 17:32:06  finished collecting timing info
2022-02-23 17:32:06.281824 (Thread-2): 17:32:06  Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:32:06.284235 (Thread-2): 17:32:06  Writing runtime SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:32:06.295959 (Thread-2): 17:32:06  Opening a new connection, currently in state closed
2022-02-23 17:32:06.300528 (Thread-2): 17:32:06  On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dm_monthly_zone_revenue`
  
  
  OPTIONS()
  as (
    

with trips_data as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    --date_trunc('month', pickup_datetime) as revenue_month, 
    date_trunc(pickup_datetime, month) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,
    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_montly_passenger_count,
    avg(trip_distance) as avg_montly_trip_distance

    from trips_data
    group by 1,2,3
  );
  
2022-02-23 17:32:06.318749 (Thread-253): handling poll request
2022-02-23 17:32:06.319087 (Thread-253): 17:32:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c704b80>]}
2022-02-23 17:32:06.319746 (Thread-253): sending response (<Response 8006 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:32:07.814771 (Thread-254): handling poll request
2022-02-23 17:32:07.815151 (Thread-254): 17:32:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c704d30>]}
2022-02-23 17:32:07.815649 (Thread-254): sending response (<Response 287 bytes [200 OK]>) to 10.0.30.15
2022-02-23 17:32:08.136805 (Thread-2): 17:32:08  finished collecting timing info
2022-02-23 17:32:08.137282 (Thread-2): 17:32:08  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d779c0a-cfc6-4d6f-98f4-8639bba3a50b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3db461c3a0>]}
2022-02-23 17:32:08.137642 (Thread-2): 17:32:08  5 of 5 OK created table model dbt_orukosueva.dm_monthly_zone_revenue............ [CREATE TABLE (45.0 rows, 20.0 KB processed) in 1.87s]
2022-02-23 17:32:08.137764 (Thread-2): 17:32:08  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:32:08.139528 (MainThread): 17:32:08  Acquiring new bigquery connection "master"
2022-02-23 17:32:08.139866 (MainThread): 17:32:08  
2022-02-23 17:32:08.139967 (MainThread): 17:32:08  Finished running 2 view models, 3 table models in 8.04s.
2022-02-23 17:32:08.140047 (MainThread): 17:32:08  Connection 'master' was properly closed.
2022-02-23 17:32:08.140113 (MainThread): 17:32:08  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:32:08.140174 (MainThread): 17:32:08  Connection 'model.taxi_rides_ny.dm_monthly_zone_revenue' was properly closed.
2022-02-23 17:32:08.140235 (MainThread): 17:32:08  Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
2022-02-23 17:32:08.140294 (MainThread): 17:32:08  Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
2022-02-23 17:32:08.196448 (MainThread): 17:32:08  
2022-02-23 17:32:08.196662 (MainThread): 17:32:08  Completed successfully
2022-02-23 17:32:08.196767 (MainThread): 17:32:08  
2022-02-23 17:32:08.196856 (MainThread): 17:32:08  Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-02-23 17:32:09.503289 (Thread-255): handling poll request
2022-02-23 17:32:09.503672 (Thread-255): 17:32:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c70bd00>]}
2022-02-23 17:32:09.505376 (Thread-255): sending response (<Response 40473 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:32:10.781521 (Thread-256): handling status request
2022-02-23 17:32:10.781897 (Thread-256): 17:32:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c70beb0>]}
2022-02-23 17:32:10.782478 (Thread-256): sending response (<Response 1585 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:32:10.890737 (Thread-257): handling status request
2022-02-23 17:32:10.891051 (Thread-257): 17:32:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6952e0>]}
2022-02-23 17:32:10.891488 (Thread-257): sending response (<Response 1585 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:34:10.011156 (Thread-258): handling status request
2022-02-23 17:34:10.013363 (Thread-258): 17:34:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c695550>]}
2022-02-23 17:34:10.013835 (Thread-258): sending response (<Response 1585 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:34:10.279847 (Thread-259): handling status request
2022-02-23 17:34:10.280233 (Thread-259): 17:34:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6957c0>]}
2022-02-23 17:34:10.280704 (Thread-259): sending response (<Response 1585 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:34:10.450094 (Thread-260): handling cli_args request
2022-02-23 17:34:10.450441 (Thread-260): 17:34:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c695a30>]}
2022-02-23 17:34:10.463022 (Thread-260): sending response (<Response 299 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:34:18.447230 (Thread-261): handling status request
2022-02-23 17:34:18.447601 (Thread-261): 17:34:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1577c0>]}
2022-02-23 17:34:18.448078 (Thread-261): sending response (<Response 1585 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:34:18.522892 (Thread-262): handling status request
2022-02-23 17:34:18.523235 (Thread-262): 17:34:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8c1928b0>]}
2022-02-23 17:34:18.523691 (Thread-262): sending response (<Response 1585 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:36:50.793155 (Thread-263): handling status request
2022-02-23 17:36:50.795132 (Thread-263): 17:36:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c69dc70>]}
2022-02-23 17:36:50.795642 (Thread-263): sending response (<Response 1585 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:36:51.039863 (Thread-264): handling status request
2022-02-23 17:36:51.040256 (Thread-264): 17:36:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c69d550>]}
2022-02-23 17:36:51.040727 (Thread-264): sending response (<Response 1585 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:36:51.243023 (Thread-265): handling cli_args request
2022-02-23 17:36:51.243401 (Thread-265): 17:36:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c69d370>]}
2022-02-23 17:36:53.420829 (Thread-265): sending response (<Response 138 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:36:53.785105 (MainThread): 17:36:53  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:36:53.785544 (MainThread): 17:36:53  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:36:53.792802 (MainThread): 17:36:53  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773a44fb50>]}
2022-02-23 17:36:53.825617 (MainThread): 17:36:53  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773ad62d00>]}
2022-02-23 17:36:53.825904 (MainThread): 17:36:53  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:36:53.827608 (MainThread): 17:36:53  
2022-02-23 17:36:53.827941 (MainThread): 17:36:53  Acquiring new bigquery connection "master"
2022-02-23 17:36:53.829032 (ThreadPoolExecutor-0_0): 17:36:53  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:36:53.829188 (ThreadPoolExecutor-0_0): 17:36:53  Opening a new connection, currently in state init
2022-02-23 17:36:53.898092 (Thread-266): handling poll request
2022-02-23 17:36:53.898537 (Thread-266): 17:36:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6a3b50>]}
2022-02-23 17:36:53.899417 (Thread-266): sending response (<Response 3377 bytes [200 OK]>) to 10.0.38.187
2022-02-23 17:36:54.473509 (ThreadPoolExecutor-1_0): 17:36:54  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:36:54.473689 (ThreadPoolExecutor-1_0): 17:36:54  Opening a new connection, currently in state closed
2022-02-23 17:36:54.677835 (MainThread): 17:36:54  Concurrency: 4 threads (target='default')
2022-02-23 17:36:54.678033 (MainThread): 17:36:54  
2022-02-23 17:36:54.680781 (Thread-1): 17:36:54  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:36:54.681095 (Thread-1): 17:36:54  1 of 17 START view model dbt_orukosueva.stg_green_tripdata...................... [RUN]
2022-02-23 17:36:54.681366 (Thread-1): 17:36:54  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:36:54.681465 (Thread-1): 17:36:54  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:36:54.681557 (Thread-1): 17:36:54  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:36:54.685867 (Thread-2): 17:36:54  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:36:54.686151 (Thread-2): 17:36:54  2 of 17 START view model dbt_orukosueva.stg_yellow_tripdata..................... [RUN]
2022-02-23 17:36:54.686421 (Thread-2): 17:36:54  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:36:54.686509 (Thread-2): 17:36:54  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:36:54.686590 (Thread-2): 17:36:54  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:36:54.688200 (Thread-3): 17:36:54  Began running node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:36:54.688419 (Thread-3): 17:36:54  3 of 17 START seed file dbt_orukosueva.taxi_zone_lookup......................... [RUN]
2022-02-23 17:36:54.688670 (Thread-3): 17:36:54  Acquiring new bigquery connection "seed.taxi_rides_ny.taxi_zone_lookup"
2022-02-23 17:36:54.688756 (Thread-3): 17:36:54  Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:36:54.688847 (Thread-3): 17:36:54  finished collecting timing info
2022-02-23 17:36:54.688948 (Thread-3): 17:36:54  Began executing node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:36:54.720961 (Thread-1): 17:36:54  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:36:54.726895 (Thread-2): 17:36:54  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:36:54.737995 (Thread-3): 17:36:54  Opening a new connection, currently in state init
2022-02-23 17:36:54.743242 (Thread-2): 17:36:54  finished collecting timing info
2022-02-23 17:36:54.743390 (Thread-2): 17:36:54  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:36:54.748513 (Thread-1): 17:36:54  finished collecting timing info
2022-02-23 17:36:54.748647 (Thread-1): 17:36:54  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:36:54.784521 (Thread-1): 17:36:54  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:36:54.785844 (Thread-2): 17:36:54  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:36:54.800653 (Thread-2): 17:36:54  Opening a new connection, currently in state init
2022-02-23 17:36:54.802218 (Thread-1): 17:36:54  Opening a new connection, currently in state closed
2022-02-23 17:36:54.804945 (Thread-2): 17:36:54  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'
;


2022-02-23 17:36:54.806474 (Thread-1): 17:36:54  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'
;


2022-02-23 17:36:55.454448 (Thread-267): handling poll request
2022-02-23 17:36:55.454848 (Thread-267): 17:36:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c675970>]}
2022-02-23 17:36:55.456106 (Thread-267): sending response (<Response 17631 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:36:55.487074 (Thread-1): 17:36:55  finished collecting timing info
2022-02-23 17:36:55.487512 (Thread-1): 17:36:55  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773a456e50>]}
2022-02-23 17:36:55.487870 (Thread-1): 17:36:55  1 of 17 OK created view model dbt_orukosueva.stg_green_tripdata................. [OK in 0.81s]
2022-02-23 17:36:55.487996 (Thread-1): 17:36:55  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:36:55.488838 (Thread-4): 17:36:55  Began running node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
2022-02-23 17:36:55.489024 (Thread-4): 17:36:55  4 of 17 START test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ [RUN]
2022-02-23 17:36:55.489287 (Thread-4): 17:36:55  Acquiring new bigquery connection "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
2022-02-23 17:36:55.489377 (Thread-4): 17:36:55  Began compiling node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
2022-02-23 17:36:55.489463 (Thread-4): 17:36:55  Compiling test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
2022-02-23 17:36:55.494009 (Thread-1): 17:36:55  Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
2022-02-23 17:36:55.494159 (Thread-1): 17:36:55  5 of 17 START test not_null_stg_green_tripdata_tripid........................... [RUN]
2022-02-23 17:36:55.494387 (Thread-1): 17:36:55  Acquiring new bigquery connection "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"
2022-02-23 17:36:55.494471 (Thread-1): 17:36:55  Began compiling node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
2022-02-23 17:36:55.494550 (Thread-1): 17:36:55  Compiling test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
2022-02-23 17:36:55.504223 (Thread-4): 17:36:55  Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
2022-02-23 17:36:55.510725 (Thread-1): 17:36:55  Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"
2022-02-23 17:36:55.524487 (Thread-4): 17:36:55  finished collecting timing info
2022-02-23 17:36:55.524628 (Thread-4): 17:36:55  Began executing node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
2022-02-23 17:36:55.529836 (Thread-1): 17:36:55  finished collecting timing info
2022-02-23 17:36:55.530007 (Thread-1): 17:36:55  Began executing node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
2022-02-23 17:36:55.562545 (Thread-1): 17:36:55  Writing runtime SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"
2022-02-23 17:36:55.563067 (Thread-4): 17:36:55  Writing runtime SQL for node "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
2022-02-23 17:36:55.582157 (Thread-1): 17:36:55  Opening a new connection, currently in state closed
2022-02-23 17:36:55.585643 (Thread-4): 17:36:55  Opening a new connection, currently in state init
2022-02-23 17:36:55.586691 (Thread-1): 17:36:55  On test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
where tripid is null



      
    ) dbt_internal_test
2022-02-23 17:36:55.590067 (Thread-4): 17:36:55  On test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
2022-02-23 17:36:55.856856 (Thread-2): 17:36:55  finished collecting timing info
2022-02-23 17:36:55.857300 (Thread-2): 17:36:55  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7739bb7df0>]}
2022-02-23 17:36:55.857640 (Thread-2): 17:36:55  2 of 17 OK created view model dbt_orukosueva.stg_yellow_tripdata................ [OK in 1.17s]
2022-02-23 17:36:55.857757 (Thread-2): 17:36:55  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:36:55.857894 (Thread-2): 17:36:55  Began running node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
2022-02-23 17:36:55.858057 (Thread-2): 17:36:55  6 of 17 START test unique_stg_green_tripdata_tripid............................. [RUN]
2022-02-23 17:36:55.858301 (Thread-2): 17:36:55  Acquiring new bigquery connection "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"
2022-02-23 17:36:55.858389 (Thread-2): 17:36:55  Began compiling node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
2022-02-23 17:36:55.858471 (Thread-2): 17:36:55  Compiling test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
2022-02-23 17:36:55.865305 (Thread-2): 17:36:55  Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"
2022-02-23 17:36:55.876475 (Thread-2): 17:36:55  finished collecting timing info
2022-02-23 17:36:55.876642 (Thread-2): 17:36:55  Began executing node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
2022-02-23 17:36:55.878474 (Thread-2): 17:36:55  Writing runtime SQL for node "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"
2022-02-23 17:36:55.889283 (Thread-2): 17:36:55  Opening a new connection, currently in state closed
2022-02-23 17:36:55.893652 (Thread-2): 17:36:55  On test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select tripid as unique_field
  from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  where tripid is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
2022-02-23 17:36:56.683849 (Thread-4): 17:36:56  finished collecting timing info
2022-02-23 17:36:56.684471 (Thread-4): 17:36:56  4 of 17 PASS accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_ [PASS in 1.20s]
2022-02-23 17:36:56.684661 (Thread-4): 17:36:56  Finished running node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
2022-02-23 17:36:56.684870 (Thread-4): 17:36:56  Began running node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
2022-02-23 17:36:56.685053 (Thread-4): 17:36:56  7 of 17 START test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_ [RUN]
2022-02-23 17:36:56.685395 (Thread-4): 17:36:56  Acquiring new bigquery connection "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
2022-02-23 17:36:56.685532 (Thread-4): 17:36:56  Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
2022-02-23 17:36:56.685665 (Thread-4): 17:36:56  Compiling test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
2022-02-23 17:36:56.695659 (Thread-4): 17:36:56  Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
2022-02-23 17:36:56.707012 (Thread-4): 17:36:56  finished collecting timing info
2022-02-23 17:36:56.707151 (Thread-4): 17:36:56  Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
2022-02-23 17:36:56.708834 (Thread-4): 17:36:56  Writing runtime SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
2022-02-23 17:36:56.720266 (Thread-4): 17:36:56  Opening a new connection, currently in state closed
2022-02-23 17:36:56.723577 (Thread-1): 17:36:56  finished collecting timing info
2022-02-23 17:36:56.723884 (Thread-1): 17:36:56  5 of 17 PASS not_null_stg_green_tripdata_tripid................................. [PASS in 1.23s]
2022-02-23 17:36:56.723995 (Thread-1): 17:36:56  Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
2022-02-23 17:36:56.724120 (Thread-1): 17:36:56  Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
2022-02-23 17:36:56.724225 (Thread-1): 17:36:56  8 of 17 START test not_null_stg_yellow_tripdata_tripid.......................... [RUN]
2022-02-23 17:36:56.724441 (Thread-1): 17:36:56  Acquiring new bigquery connection "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"
2022-02-23 17:36:56.724527 (Thread-1): 17:36:56  Began compiling node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
2022-02-23 17:36:56.724605 (Thread-1): 17:36:56  Compiling test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
2022-02-23 17:36:56.728157 (Thread-1): 17:36:56  Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"
2022-02-23 17:36:56.729261 (Thread-4): 17:36:56  On test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
2022-02-23 17:36:56.738853 (Thread-1): 17:36:56  finished collecting timing info
2022-02-23 17:36:56.739049 (Thread-1): 17:36:56  Began executing node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
2022-02-23 17:36:56.741764 (Thread-1): 17:36:56  Writing runtime SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"
2022-02-23 17:36:56.751900 (Thread-1): 17:36:56  Opening a new connection, currently in state closed
2022-02-23 17:36:56.756379 (Thread-1): 17:36:56  On test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
where tripid is null



      
    ) dbt_internal_test
2022-02-23 17:36:56.938104 (Thread-268): handling poll request
2022-02-23 17:36:56.938475 (Thread-268): 17:36:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c675970>]}
2022-02-23 17:36:56.939736 (Thread-268): sending response (<Response 36795 bytes [200 OK]>) to 10.0.10.118
2022-02-23 17:36:57.233164 (Thread-2): 17:36:57  finished collecting timing info
2022-02-23 17:36:57.233620 (Thread-2): 17:36:57  6 of 17 PASS unique_stg_green_tripdata_tripid................................... [PASS in 1.38s]
2022-02-23 17:36:57.233777 (Thread-2): 17:36:57  Finished running node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
2022-02-23 17:36:57.233963 (Thread-2): 17:36:57  Began running node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
2022-02-23 17:36:57.234099 (Thread-2): 17:36:57  9 of 17 START test unique_stg_yellow_tripdata_tripid............................ [RUN]
2022-02-23 17:36:57.234356 (Thread-2): 17:36:57  Acquiring new bigquery connection "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
2022-02-23 17:36:57.234445 (Thread-2): 17:36:57  Began compiling node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
2022-02-23 17:36:57.234531 (Thread-2): 17:36:57  Compiling test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
2022-02-23 17:36:57.238925 (Thread-2): 17:36:57  Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
2022-02-23 17:36:57.250076 (Thread-2): 17:36:57  finished collecting timing info
2022-02-23 17:36:57.250216 (Thread-2): 17:36:57  Began executing node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
2022-02-23 17:36:57.251991 (Thread-2): 17:36:57  Writing runtime SQL for node "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
2022-02-23 17:36:57.262944 (Thread-2): 17:36:57  Opening a new connection, currently in state closed
2022-02-23 17:36:57.267300 (Thread-2): 17:36:57  On test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (
  
  select tripid as unique_field
  from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  where tripid is not null
  
)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
2022-02-23 17:36:58.530367 (Thread-269): handling poll request
2022-02-23 17:36:58.530740 (Thread-269): 17:36:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c675e80>]}
2022-02-23 17:36:58.531357 (Thread-269): sending response (<Response 7332 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:36:58.904669 (Thread-4): 17:36:58  finished collecting timing info
2022-02-23 17:36:58.905155 (Thread-4): 17:36:58  7 of 17 PASS accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_ [PASS in 2.22s]
2022-02-23 17:36:58.905294 (Thread-4): 17:36:58  Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
2022-02-23 17:36:59.164553 (Thread-1): 17:36:59  finished collecting timing info
2022-02-23 17:36:59.165043 (Thread-1): 17:36:59  8 of 17 PASS not_null_stg_yellow_tripdata_tripid................................ [PASS in 2.44s]
2022-02-23 17:36:59.165181 (Thread-1): 17:36:59  Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
2022-02-23 17:36:59.383361 (Thread-3): 17:36:59  Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
2022-02-23 17:36:59.401282 (Thread-3): 17:36:59  finished collecting timing info
2022-02-23 17:36:59.401729 (Thread-3): 17:36:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f773835bca0>]}
2022-02-23 17:36:59.402030 (Thread-3): 17:36:59  3 of 17 OK loaded seed file dbt_orukosueva.taxi_zone_lookup..................... [INSERT 265 in 4.71s]
2022-02-23 17:36:59.402150 (Thread-3): 17:36:59  Finished running node seed.taxi_rides_ny.taxi_zone_lookup
2022-02-23 17:36:59.403068 (Thread-4): 17:36:59  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:36:59.403332 (Thread-4): 17:36:59  10 of 17 START table model dbt_orukosueva.dim_zones............................. [RUN]
2022-02-23 17:36:59.403597 (Thread-4): 17:36:59  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:36:59.403693 (Thread-4): 17:36:59  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:36:59.403782 (Thread-4): 17:36:59  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:36:59.406836 (Thread-4): 17:36:59  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:36:59.407077 (Thread-1): 17:36:59  Began running node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
2022-02-23 17:36:59.407275 (Thread-1): 17:36:59  11 of 17 START test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ [RUN]
2022-02-23 17:36:59.407506 (Thread-1): 17:36:59  Acquiring new bigquery connection "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
2022-02-23 17:36:59.407593 (Thread-1): 17:36:59  Began compiling node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
2022-02-23 17:36:59.407673 (Thread-1): 17:36:59  Compiling test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
2022-02-23 17:36:59.410470 (Thread-3): 17:36:59  Began running node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
2022-02-23 17:36:59.410618 (Thread-3): 17:36:59  12 of 17 START test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ [RUN]
2022-02-23 17:36:59.410848 (Thread-3): 17:36:59  Acquiring new bigquery connection "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
2022-02-23 17:36:59.410935 (Thread-3): 17:36:59  Began compiling node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
2022-02-23 17:36:59.411013 (Thread-3): 17:36:59  Compiling test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
2022-02-23 17:36:59.419174 (Thread-3): 17:36:59  Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
2022-02-23 17:36:59.488723 (Thread-1): 17:36:59  Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
2022-02-23 17:36:59.490292 (Thread-4): 17:36:59  finished collecting timing info
2022-02-23 17:36:59.490448 (Thread-4): 17:36:59  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:36:59.494952 (Thread-3): 17:36:59  finished collecting timing info
2022-02-23 17:36:59.495102 (Thread-3): 17:36:59  Began executing node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
2022-02-23 17:36:59.496907 (Thread-3): 17:36:59  Writing runtime SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
2022-02-23 17:36:59.502157 (Thread-4): 17:36:59  Opening a new connection, currently in state closed
2022-02-23 17:36:59.519491 (Thread-3): 17:36:59  Opening a new connection, currently in state closed
2022-02-23 17:36:59.519834 (Thread-1): 17:36:59  finished collecting timing info
2022-02-23 17:36:59.519975 (Thread-1): 17:36:59  Began executing node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
2022-02-23 17:36:59.521892 (Thread-1): 17:36:59  Writing runtime SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
2022-02-23 17:36:59.526109 (Thread-3): 17:36:59  On test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2022-02-23 17:36:59.539254 (Thread-1): 17:36:59  Opening a new connection, currently in state closed
2022-02-23 17:36:59.543627 (Thread-1): 17:36:59  On test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2022-02-23 17:36:59.720049 (Thread-4): 17:36:59  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:36:59.741651 (Thread-4): 17:36:59  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:36:59.980330 (Thread-270): handling poll request
2022-02-23 17:36:59.980703 (Thread-270): 17:36:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c607250>]}
2022-02-23 17:36:59.981593 (Thread-270): sending response (<Response 24090 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:37:00.619489 (Thread-3): 17:37:00  finished collecting timing info
2022-02-23 17:37:00.619947 (Thread-3): 17:37:00  12 of 17 PASS relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ [PASS in 1.21s]
2022-02-23 17:37:00.620097 (Thread-3): 17:37:00  Finished running node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
2022-02-23 17:37:00.620234 (Thread-3): 17:37:00  Began running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
2022-02-23 17:37:00.620351 (Thread-3): 17:37:00  13 of 17 START test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ [RUN]
2022-02-23 17:37:00.620580 (Thread-3): 17:37:00  Acquiring new bigquery connection "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
2022-02-23 17:37:00.620686 (Thread-3): 17:37:00  Began compiling node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
2022-02-23 17:37:00.620775 (Thread-3): 17:37:00  Compiling test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
2022-02-23 17:37:00.626443 (Thread-3): 17:37:00  Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
2022-02-23 17:37:00.637578 (Thread-3): 17:37:00  finished collecting timing info
2022-02-23 17:37:00.637720 (Thread-3): 17:37:00  Began executing node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
2022-02-23 17:37:00.639507 (Thread-3): 17:37:00  Writing runtime SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
2022-02-23 17:37:00.650222 (Thread-3): 17:37:00  Opening a new connection, currently in state closed
2022-02-23 17:37:00.654680 (Thread-3): 17:37:00  On test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2022-02-23 17:37:00.885142 (Thread-1): 17:37:00  finished collecting timing info
2022-02-23 17:37:00.885571 (Thread-1): 17:37:00  11 of 17 PASS relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ [PASS in 1.48s]
2022-02-23 17:37:00.885698 (Thread-1): 17:37:00  Finished running node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
2022-02-23 17:37:00.885835 (Thread-1): 17:37:00  Began running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
2022-02-23 17:37:00.885986 (Thread-1): 17:37:00  14 of 17 START test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ [RUN]
2022-02-23 17:37:00.886216 (Thread-1): 17:37:00  Acquiring new bigquery connection "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
2022-02-23 17:37:00.886302 (Thread-1): 17:37:00  Began compiling node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
2022-02-23 17:37:00.886387 (Thread-1): 17:37:00  Compiling test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
2022-02-23 17:37:00.894009 (Thread-1): 17:37:00  Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
2022-02-23 17:37:00.917217 (Thread-1): 17:37:00  finished collecting timing info
2022-02-23 17:37:00.917442 (Thread-1): 17:37:00  Began executing node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
2022-02-23 17:37:00.919322 (Thread-1): 17:37:00  Writing runtime SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
2022-02-23 17:37:00.938057 (Thread-1): 17:37:00  Opening a new connection, currently in state closed
2022-02-23 17:37:00.942374 (Thread-1): 17:37:00  On test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
2022-02-23 17:37:01.194554 (Thread-2): 17:37:01  finished collecting timing info
2022-02-23 17:37:01.195009 (Thread-2): 17:37:01  9 of 17 PASS unique_stg_yellow_tripdata_tripid.................................. [PASS in 3.96s]
2022-02-23 17:37:01.195141 (Thread-2): 17:37:01  Finished running node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
2022-02-23 17:37:01.407169 (Thread-271): handling poll request
2022-02-23 17:37:01.407582 (Thread-271): 17:37:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c617100>]}
2022-02-23 17:37:01.408445 (Thread-271): sending response (<Response 18938 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:37:01.647614 (Thread-4): 17:37:01  finished collecting timing info
2022-02-23 17:37:01.648074 (Thread-4): 17:37:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77380c9eb0>]}
2022-02-23 17:37:01.648579 (Thread-4): 17:37:01  10 of 17 OK created table model dbt_orukosueva.dim_zones........................ [CREATE TABLE (265.0 rows, 14.2 KB processed) in 2.24s]
2022-02-23 17:37:01.648697 (Thread-4): 17:37:01  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:37:02.949814 (Thread-272): handling poll request
2022-02-23 17:37:02.950429 (Thread-272): 17:37:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c607f40>]}
2022-02-23 17:37:02.950966 (Thread-272): sending response (<Response 2123 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:37:03.118214 (Thread-3): 17:37:03  finished collecting timing info
2022-02-23 17:37:03.118667 (Thread-3): 17:37:03  13 of 17 PASS relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_ [PASS in 2.50s]
2022-02-23 17:37:03.118792 (Thread-3): 17:37:03  Finished running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
2022-02-23 17:37:03.153223 (Thread-1): 17:37:03  finished collecting timing info
2022-02-23 17:37:03.153657 (Thread-1): 17:37:03  14 of 17 PASS relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_ [PASS in 2.27s]
2022-02-23 17:37:03.153785 (Thread-1): 17:37:03  Finished running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
2022-02-23 17:37:03.154849 (Thread-2): 17:37:03  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:37:03.155143 (Thread-2): 17:37:03  15 of 17 START table model dbt_orukosueva.fact_trips............................ [RUN]
2022-02-23 17:37:03.155434 (Thread-2): 17:37:03  Acquiring new bigquery connection "model.taxi_rides_ny.fact_trips"
2022-02-23 17:37:03.155533 (Thread-2): 17:37:03  Began compiling node model.taxi_rides_ny.fact_trips
2022-02-23 17:37:03.155622 (Thread-2): 17:37:03  Compiling model.taxi_rides_ny.fact_trips
2022-02-23 17:37:03.160708 (Thread-2): 17:37:03  Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:37:03.176697 (Thread-2): 17:37:03  finished collecting timing info
2022-02-23 17:37:03.176992 (Thread-2): 17:37:03  Began executing node model.taxi_rides_ny.fact_trips
2022-02-23 17:37:03.180393 (Thread-2): 17:37:03  Opening a new connection, currently in state closed
2022-02-23 17:37:03.819455 (Thread-2): 17:37:03  Writing runtime SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:37:03.846886 (Thread-2): 17:37:03  On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.fact_trips"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
  
  
  OPTIONS()
  as (
    

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
--    select * from green_data
--    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
  );
  
2022-02-23 17:37:04.460146 (Thread-273): handling poll request
2022-02-23 17:37:04.460511 (Thread-273): 17:37:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c617670>]}
2022-02-23 17:37:04.461193 (Thread-273): sending response (<Response 9936 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:37:05.976801 (Thread-274): handling poll request
2022-02-23 17:37:05.977196 (Thread-274): 17:37:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c617820>]}
2022-02-23 17:37:05.977692 (Thread-274): sending response (<Response 316 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:37:07.819585 (Thread-275): handling poll request
2022-02-23 17:37:07.819996 (Thread-275): 17:37:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c617a60>]}
2022-02-23 17:37:07.820507 (Thread-275): sending response (<Response 316 bytes [200 OK]>) to 10.0.43.66
2022-02-23 17:37:09.346656 (Thread-276): handling poll request
2022-02-23 17:37:09.347102 (Thread-276): 17:37:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6b5e20>]}
2022-02-23 17:37:09.347592 (Thread-276): sending response (<Response 316 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:37:10.931054 (Thread-277): handling poll request
2022-02-23 17:37:10.931447 (Thread-277): 17:37:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6240a0>]}
2022-02-23 17:37:10.931949 (Thread-277): sending response (<Response 316 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:37:12.404872 (Thread-278): handling poll request
2022-02-23 17:37:12.405247 (Thread-278): 17:37:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c624250>]}
2022-02-23 17:37:12.428024 (Thread-278): sending response (<Response 316 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:37:14.056653 (Thread-279): handling poll request
2022-02-23 17:37:14.057052 (Thread-279): 17:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c624670>]}
2022-02-23 17:37:14.057558 (Thread-279): sending response (<Response 316 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:37:15.472802 (Thread-280): handling poll request
2022-02-23 17:37:15.473179 (Thread-280): 17:37:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c624640>]}
2022-02-23 17:37:15.473673 (Thread-280): sending response (<Response 316 bytes [200 OK]>) to 10.0.36.42
2022-02-23 17:37:16.899118 (Thread-281): handling poll request
2022-02-23 17:37:16.899489 (Thread-281): 17:37:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6244c0>]}
2022-02-23 17:37:16.899969 (Thread-281): sending response (<Response 316 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:37:18.368239 (Thread-282): handling poll request
2022-02-23 17:37:18.368637 (Thread-282): 17:37:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c6245b0>]}
2022-02-23 17:37:18.369152 (Thread-282): sending response (<Response 316 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:37:19.813143 (Thread-283): handling poll request
2022-02-23 17:37:19.813515 (Thread-283): 17:37:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c624fa0>]}
2022-02-23 17:37:19.814047 (Thread-283): sending response (<Response 316 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:37:21.351766 (Thread-284): handling poll request
2022-02-23 17:37:21.352121 (Thread-284): 17:37:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c62e4f0>]}
2022-02-23 17:37:21.352589 (Thread-284): sending response (<Response 316 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:37:22.207841 (Thread-2): 17:37:22  finished collecting timing info
2022-02-23 17:37:22.208383 (Thread-2): 17:37:22  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77227e9cd0>]}
2022-02-23 17:37:22.208766 (Thread-2): 17:37:22  15 of 17 OK created table model dbt_orukosueva.fact_trips....................... [CREATE TABLE (55.4m rows, 14.0 GB processed) in 19.05s]
2022-02-23 17:37:22.208899 (Thread-2): 17:37:22  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:37:22.210141 (Thread-3): 17:37:22  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:37:22.210414 (Thread-3): 17:37:22  16 of 17 START table model dbt_orukosueva.dm_monthly_zone_revenue............... [RUN]
2022-02-23 17:37:22.210677 (Thread-3): 17:37:22  Acquiring new bigquery connection "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:37:22.210772 (Thread-3): 17:37:22  Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:37:22.210859 (Thread-3): 17:37:22  Compiling model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:37:22.214087 (Thread-3): 17:37:22  Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:37:22.226637 (Thread-3): 17:37:22  finished collecting timing info
2022-02-23 17:37:22.226784 (Thread-3): 17:37:22  Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:37:22.228540 (Thread-3): 17:37:22  Opening a new connection, currently in state closed
2022-02-23 17:37:22.431431 (Thread-3): 17:37:22  Writing runtime SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:37:22.443689 (Thread-3): 17:37:22  On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dm_monthly_zone_revenue`
  
  
  OPTIONS()
  as (
    

with trips_data as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    --date_trunc('month', pickup_datetime) as revenue_month, 
    date_trunc(pickup_datetime, month) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,
    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_montly_passenger_count,
    avg(trip_distance) as avg_montly_trip_distance

    from trips_data
    group by 1,2,3
  );
  
2022-02-23 17:37:22.941864 (Thread-285): handling poll request
2022-02-23 17:37:22.942271 (Thread-285): 17:37:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c62eeb0>]}
2022-02-23 17:37:22.942966 (Thread-285): sending response (<Response 8039 bytes [200 OK]>) to 10.0.10.118
2022-02-23 17:37:24.526450 (Thread-286): handling poll request
2022-02-23 17:37:24.526826 (Thread-286): 17:37:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5ba070>]}
2022-02-23 17:37:24.527338 (Thread-286): sending response (<Response 316 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:37:26.008146 (Thread-287): handling poll request
2022-02-23 17:37:26.008523 (Thread-287): 17:37:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5ba220>]}
2022-02-23 17:37:26.009007 (Thread-287): sending response (<Response 316 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:37:26.156185 (Thread-3): 17:37:26  finished collecting timing info
2022-02-23 17:37:26.156661 (Thread-3): 17:37:26  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b245c1b6-3da6-4bd3-a16a-6c9c81e488fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7722763340>]}
2022-02-23 17:37:26.157191 (Thread-3): 17:37:26  16 of 17 OK created table model dbt_orukosueva.dm_monthly_zone_revenue.......... [CREATE TABLE (6.3k rows, 12.2 GB processed) in 3.95s]
2022-02-23 17:37:26.157314 (Thread-3): 17:37:26  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:37:26.158314 (Thread-4): 17:37:26  Began running node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
2022-02-23 17:37:26.158495 (Thread-4): 17:37:26  17 of 17 START test not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount [RUN]
2022-02-23 17:37:26.158753 (Thread-4): 17:37:26  Acquiring new bigquery connection "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
2022-02-23 17:37:26.158845 (Thread-4): 17:37:26  Began compiling node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
2022-02-23 17:37:26.158944 (Thread-4): 17:37:26  Compiling test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
2022-02-23 17:37:26.163111 (Thread-4): 17:37:26  Writing injected SQL for node "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
2022-02-23 17:37:26.179971 (Thread-4): 17:37:26  finished collecting timing info
2022-02-23 17:37:26.180140 (Thread-4): 17:37:26  Began executing node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
2022-02-23 17:37:26.183448 (Thread-4): 17:37:26  Writing runtime SQL for node "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
2022-02-23 17:37:26.200161 (Thread-4): 17:37:26  Opening a new connection, currently in state closed
2022-02-23 17:37:26.204555 (Thread-4): 17:37:26  On test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from `dtc-de-339117`.`dbt_orukosueva`.`dm_monthly_zone_revenue`
where revenue_monthly_total_amount is null



      
    ) dbt_internal_test
2022-02-23 17:37:27.471141 (Thread-288): handling poll request
2022-02-23 17:37:27.471510 (Thread-288): 17:37:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c624a60>]}
2022-02-23 17:37:27.472198 (Thread-288): sending response (<Response 8252 bytes [200 OK]>) to 10.0.22.63
2022-02-23 17:37:27.740660 (Thread-4): 17:37:27  finished collecting timing info
2022-02-23 17:37:27.741109 (Thread-4): 17:37:27  17 of 17 PASS not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount..... [PASS in 1.58s]
2022-02-23 17:37:27.741237 (Thread-4): 17:37:27  Finished running node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
2022-02-23 17:37:27.742918 (MainThread): 17:37:27  Acquiring new bigquery connection "master"
2022-02-23 17:37:27.743286 (MainThread): 17:37:27  
2022-02-23 17:37:27.743389 (MainThread): 17:37:27  Finished running 2 view models, 11 tests, 1 seed, 3 table models in 33.92s.
2022-02-23 17:37:27.743472 (MainThread): 17:37:27  Connection 'master' was properly closed.
2022-02-23 17:37:27.743541 (MainThread): 17:37:27  Connection 'test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631' was properly closed.
2022-02-23 17:37:27.743608 (MainThread): 17:37:27  Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
2022-02-23 17:37:27.743668 (MainThread): 17:37:27  Connection 'model.taxi_rides_ny.dm_monthly_zone_revenue' was properly closed.
2022-02-23 17:37:27.743727 (MainThread): 17:37:27  Connection 'test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' was properly closed.
2022-02-23 17:37:27.813452 (MainThread): 17:37:27  
2022-02-23 17:37:27.813640 (MainThread): 17:37:27  Completed successfully
2022-02-23 17:37:27.813759 (MainThread): 17:37:27  
2022-02-23 17:37:27.813858 (MainThread): 17:37:27  Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
2022-02-23 17:37:28.948768 (Thread-289): handling poll request
2022-02-23 17:37:28.949165 (Thread-289): 17:37:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c624ca0>]}
2022-02-23 17:37:28.951805 (Thread-289): sending response (<Response 76044 bytes [200 OK]>) to 10.0.25.65
2022-02-23 17:37:30.876922 (Thread-290): handling status request
2022-02-23 17:37:30.877288 (Thread-290): 17:37:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5c5610>]}
2022-02-23 17:37:30.877799 (Thread-290): sending response (<Response 1585 bytes [200 OK]>) to 10.0.8.111
2022-02-23 17:37:31.262743 (Thread-291): handling status request
2022-02-23 17:37:31.263118 (Thread-291): 17:37:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c57b2b0>]}
2022-02-23 17:37:31.263600 (Thread-291): sending response (<Response 1585 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:37:46.471946 (Thread-292): handling status request
2022-02-23 17:37:46.472322 (Thread-292): 17:37:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c583190>]}
2022-02-23 17:37:46.472805 (Thread-292): sending response (<Response 1585 bytes [200 OK]>) to 10.0.26.218
2022-02-23 17:37:46.908023 (Thread-293): handling status request
2022-02-23 17:37:46.908398 (Thread-293): 17:37:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c583730>]}
2022-02-23 17:37:46.908878 (Thread-293): sending response (<Response 1585 bytes [200 OK]>) to 10.0.19.0
2022-02-23 17:37:46.919303 (Thread-294): handling cli_args request
2022-02-23 17:37:46.919567 (Thread-294): 17:37:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5839a0>]}
2022-02-23 17:37:49.080579 (Thread-294): sending response (<Response 138 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:37:49.336099 (MainThread): 17:37:49  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:37:49.336542 (MainThread): 17:37:49  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:37:49.343566 (MainThread): 17:37:49  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '423281f4-e6ac-4100-ada8-85f32d3925e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee02347bb0>]}
2022-02-23 17:37:49.376021 (MainThread): 17:37:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '423281f4-e6ac-4100-ada8-85f32d3925e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee02c6eb50>]}
2022-02-23 17:37:49.376305 (MainThread): 17:37:49  Found 5 models, 11 tests, 0 snapshots, 0 analyses, 376 macros, 0 operations, 1 seed file, 2 sources, 0 exposures, 0 metrics
2022-02-23 17:37:49.377906 (MainThread): 17:37:49  
2022-02-23 17:37:49.378266 (MainThread): 17:37:49  Acquiring new bigquery connection "master"
2022-02-23 17:37:49.379321 (ThreadPoolExecutor-0_0): 17:37:49  Acquiring new bigquery connection "list_dtc-de-339117"
2022-02-23 17:37:49.379472 (ThreadPoolExecutor-0_0): 17:37:49  Opening a new connection, currently in state init
2022-02-23 17:37:49.598186 (Thread-295): handling poll request
2022-02-23 17:37:49.598639 (Thread-295): 17:37:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5e3670>]}
2022-02-23 17:37:49.599513 (Thread-295): sending response (<Response 3375 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:37:50.030557 (ThreadPoolExecutor-1_0): 17:37:50  Acquiring new bigquery connection "list_dtc-de-339117_dbt_orukosueva"
2022-02-23 17:37:50.030738 (ThreadPoolExecutor-1_0): 17:37:50  Opening a new connection, currently in state closed
2022-02-23 17:37:50.728366 (MainThread): 17:37:50  Concurrency: 4 threads (target='default')
2022-02-23 17:37:50.728545 (MainThread): 17:37:50  
2022-02-23 17:37:50.731212 (Thread-1): 17:37:50  Began running node model.taxi_rides_ny.dim_zones
2022-02-23 17:37:50.731506 (Thread-1): 17:37:50  1 of 5 START table model dbt_orukosueva.dim_zones............................... [RUN]
2022-02-23 17:37:50.731773 (Thread-1): 17:37:50  Acquiring new bigquery connection "model.taxi_rides_ny.dim_zones"
2022-02-23 17:37:50.731869 (Thread-1): 17:37:50  Began compiling node model.taxi_rides_ny.dim_zones
2022-02-23 17:37:50.731965 (Thread-1): 17:37:50  Compiling model.taxi_rides_ny.dim_zones
2022-02-23 17:37:50.734968 (Thread-1): 17:37:50  Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:37:50.735212 (Thread-2): 17:37:50  Began running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:37:50.735446 (Thread-2): 17:37:50  2 of 5 START view model dbt_orukosueva.stg_green_tripdata....................... [RUN]
2022-02-23 17:37:50.735696 (Thread-2): 17:37:50  Acquiring new bigquery connection "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:37:50.735779 (Thread-2): 17:37:50  Began compiling node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:37:50.735858 (Thread-2): 17:37:50  Compiling model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:37:50.738877 (Thread-3): 17:37:50  Began running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:37:50.739093 (Thread-3): 17:37:50  3 of 5 START view model dbt_orukosueva.stg_yellow_tripdata...................... [RUN]
2022-02-23 17:37:50.739344 (Thread-3): 17:37:50  Acquiring new bigquery connection "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:37:50.739430 (Thread-3): 17:37:50  Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:37:50.739511 (Thread-3): 17:37:50  Compiling model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:37:50.759391 (Thread-3): 17:37:50  Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:37:50.763227 (Thread-2): 17:37:50  Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:37:50.768145 (Thread-1): 17:37:50  finished collecting timing info
2022-02-23 17:37:50.768294 (Thread-1): 17:37:50  Began executing node model.taxi_rides_ny.dim_zones
2022-02-23 17:37:50.781721 (Thread-1): 17:37:50  Opening a new connection, currently in state closed
2022-02-23 17:37:50.786698 (Thread-2): 17:37:50  finished collecting timing info
2022-02-23 17:37:50.786838 (Thread-2): 17:37:50  Began executing node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:37:50.791813 (Thread-3): 17:37:50  finished collecting timing info
2022-02-23 17:37:50.791957 (Thread-3): 17:37:50  Began executing node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:37:50.821542 (Thread-3): 17:37:50  Writing runtime SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
2022-02-23 17:37:50.822875 (Thread-2): 17:37:50  Writing runtime SQL for node "model.taxi_rides_ny.stg_green_tripdata"
2022-02-23 17:37:50.837179 (Thread-3): 17:37:50  Opening a new connection, currently in state init
2022-02-23 17:37:50.837469 (Thread-2): 17:37:50  Opening a new connection, currently in state init
2022-02-23 17:37:50.842122 (Thread-3): 17:37:50  On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(tpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1

-- dbt build --m <model.sql> --var 'is_test_run: false'
;


2022-02-23 17:37:50.843184 (Thread-2): 17:37:50  On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dtc-de-339117`.`trips_data_all`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as 
    string
), '') || '-' || coalesce(cast(lpep_pickup_datetime as 
    string
), '') as 
    string
))) as tripid,
    cast(vendorid as integer) as vendorid,
    cast(ratecodeid as integer) as ratecodeid,
    cast(pulocationid as integer) as  pickup_locationid,
    cast(dolocationid as integer) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    cast(passenger_count as integer) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    cast(trip_type as integer) as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    cast(payment_type as integer) as payment_type,
    case payment_type
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
    end as payment_type_description, 
    cast(congestion_surcharge as numeric) as congestion_surcharge
from tripdata
where rn = 1


-- dbt build --m <model.sql> --var 'is_test_run: false'
;


2022-02-23 17:37:51.050624 (Thread-1): 17:37:51  Writing runtime SQL for node "model.taxi_rides_ny.dim_zones"
2022-02-23 17:37:51.064872 (Thread-1): 17:37:51  On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dim_zones"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
  
  
  OPTIONS()
  as (
    


select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone
from `dtc-de-339117`.`dbt_orukosueva`.`taxi_zone_lookup`
  );
  
2022-02-23 17:37:51.140405 (Thread-296): handling poll request
2022-02-23 17:37:51.140784 (Thread-296): 17:37:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c591850>]}
2022-02-23 17:37:51.141669 (Thread-296): sending response (<Response 19391 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:37:51.409390 (Thread-3): 17:37:51  finished collecting timing info
2022-02-23 17:37:51.409839 (Thread-3): 17:37:51  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423281f4-e6ac-4100-ada8-85f32d3925e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee001fbc70>]}
2022-02-23 17:37:51.410232 (Thread-3): 17:37:51  3 of 5 OK created view model dbt_orukosueva.stg_yellow_tripdata................. [OK in 0.67s]
2022-02-23 17:37:51.410357 (Thread-3): 17:37:51  Finished running node model.taxi_rides_ny.stg_yellow_tripdata
2022-02-23 17:37:52.293251 (Thread-2): 17:37:52  finished collecting timing info
2022-02-23 17:37:52.293729 (Thread-2): 17:37:52  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423281f4-e6ac-4100-ada8-85f32d3925e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee002ab640>]}
2022-02-23 17:37:52.294104 (Thread-2): 17:37:52  2 of 5 OK created view model dbt_orukosueva.stg_green_tripdata.................. [OK in 1.56s]
2022-02-23 17:37:52.294219 (Thread-2): 17:37:52  Finished running node model.taxi_rides_ny.stg_green_tripdata
2022-02-23 17:37:52.656144 (Thread-297): handling poll request
2022-02-23 17:37:52.656514 (Thread-297): 17:37:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c591dc0>]}
2022-02-23 17:37:52.657076 (Thread-297): sending response (<Response 3939 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:37:52.729449 (Thread-1): 17:37:52  finished collecting timing info
2022-02-23 17:37:52.729894 (Thread-1): 17:37:52  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423281f4-e6ac-4100-ada8-85f32d3925e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0234e7f0>]}
2022-02-23 17:37:52.730293 (Thread-1): 17:37:52  1 of 5 OK created table model dbt_orukosueva.dim_zones.......................... [CREATE TABLE (265.0 rows, 14.2 KB processed) in 2.00s]
2022-02-23 17:37:52.730410 (Thread-1): 17:37:52  Finished running node model.taxi_rides_ny.dim_zones
2022-02-23 17:37:52.731414 (Thread-4): 17:37:52  Began running node model.taxi_rides_ny.fact_trips
2022-02-23 17:37:52.731671 (Thread-4): 17:37:52  4 of 5 START table model dbt_orukosueva.fact_trips.............................. [RUN]
2022-02-23 17:37:52.731944 (Thread-4): 17:37:52  Acquiring new bigquery connection "model.taxi_rides_ny.fact_trips"
2022-02-23 17:37:52.732035 (Thread-4): 17:37:52  Began compiling node model.taxi_rides_ny.fact_trips
2022-02-23 17:37:52.732121 (Thread-4): 17:37:52  Compiling model.taxi_rides_ny.fact_trips
2022-02-23 17:37:52.735727 (Thread-4): 17:37:52  Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:37:52.748461 (Thread-4): 17:37:52  finished collecting timing info
2022-02-23 17:37:52.748600 (Thread-4): 17:37:52  Began executing node model.taxi_rides_ny.fact_trips
2022-02-23 17:37:52.751801 (Thread-4): 17:37:52  Opening a new connection, currently in state init
2022-02-23 17:37:52.947316 (Thread-4): 17:37:52  Writing runtime SQL for node "model.taxi_rides_ny.fact_trips"
2022-02-23 17:37:52.960899 (Thread-4): 17:37:52  On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.fact_trips"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
  
  
  OPTIONS()
  as (
    

with green_data as (
    select *, 
        'Green' as service_type 
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_green_tripdata`
), 

yellow_data as (
    select *, 
        'Yellow' as service_type
    from `dtc-de-339117`.`dbt_orukosueva`.`stg_yellow_tripdata`
), 

trips_unioned as (
--    select * from green_data
--    union all
    select * from yellow_data
), 

dim_zones as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`dim_zones`
    where borough != 'Unknown'
)
select 
    trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description, 
    trips_unioned.congestion_surcharge
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
  );
  
2022-02-23 17:37:54.157861 (Thread-298): handling poll request
2022-02-23 17:37:54.158277 (Thread-298): 17:37:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b0640>]}
2022-02-23 17:37:54.158938 (Thread-298): sending response (<Response 8443 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:37:55.650953 (Thread-299): handling poll request
2022-02-23 17:37:55.651387 (Thread-299): 17:37:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b07f0>]}
2022-02-23 17:37:55.651911 (Thread-299): sending response (<Response 313 bytes [200 OK]>) to 10.0.30.15
2022-02-23 17:37:57.098998 (Thread-300): handling poll request
2022-02-23 17:37:57.099403 (Thread-300): 17:37:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b0a60>]}
2022-02-23 17:37:57.099897 (Thread-300): sending response (<Response 314 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:37:58.675182 (Thread-301): handling poll request
2022-02-23 17:37:58.675588 (Thread-301): 17:37:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b0cd0>]}
2022-02-23 17:37:58.676366 (Thread-301): sending response (<Response 314 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:38:00.093949 (Thread-302): handling poll request
2022-02-23 17:38:00.094306 (Thread-302): 17:38:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c587490>]}
2022-02-23 17:38:00.094770 (Thread-302): sending response (<Response 314 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:38:01.557388 (Thread-303): handling poll request
2022-02-23 17:38:01.557789 (Thread-303): 17:38:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c587880>]}
2022-02-23 17:38:01.558310 (Thread-303): sending response (<Response 313 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:38:02.991270 (Thread-304): handling poll request
2022-02-23 17:38:02.991655 (Thread-304): 17:38:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c587d90>]}
2022-02-23 17:38:02.992215 (Thread-304): sending response (<Response 314 bytes [200 OK]>) to 10.0.10.118
2022-02-23 17:38:04.423133 (Thread-305): handling poll request
2022-02-23 17:38:04.423537 (Thread-305): 17:38:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c58c370>]}
2022-02-23 17:38:04.424058 (Thread-305): sending response (<Response 314 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:38:05.908582 (Thread-306): handling poll request
2022-02-23 17:38:05.908957 (Thread-306): 17:38:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c58caf0>]}
2022-02-23 17:38:05.909449 (Thread-306): sending response (<Response 313 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:38:07.938053 (Thread-307): handling poll request
2022-02-23 17:38:07.938437 (Thread-307): 17:38:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b0130>]}
2022-02-23 17:38:07.938910 (Thread-307): sending response (<Response 314 bytes [200 OK]>) to 10.0.30.15
2022-02-23 17:38:09.953515 (Thread-308): handling poll request
2022-02-23 17:38:09.953897 (Thread-308): 17:38:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b08e0>]}
2022-02-23 17:38:09.978398 (Thread-308): sending response (<Response 314 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:38:10.470073 (Thread-4): 17:38:10  finished collecting timing info
2022-02-23 17:38:10.470596 (Thread-4): 17:38:10  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423281f4-e6ac-4100-ada8-85f32d3925e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee00254ac0>]}
2022-02-23 17:38:10.470962 (Thread-4): 17:38:10  4 of 5 OK created table model dbt_orukosueva.fact_trips......................... [CREATE TABLE (55.4m rows, 14.0 GB processed) in 17.74s]
2022-02-23 17:38:10.471082 (Thread-4): 17:38:10  Finished running node model.taxi_rides_ny.fact_trips
2022-02-23 17:38:10.471952 (Thread-2): 17:38:10  Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:38:10.472186 (Thread-2): 17:38:10  5 of 5 START table model dbt_orukosueva.dm_monthly_zone_revenue................. [RUN]
2022-02-23 17:38:10.472424 (Thread-2): 17:38:10  Acquiring new bigquery connection "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:38:10.472514 (Thread-2): 17:38:10  Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:38:10.472602 (Thread-2): 17:38:10  Compiling model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:38:10.475540 (Thread-2): 17:38:10  Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:38:10.488318 (Thread-2): 17:38:10  finished collecting timing info
2022-02-23 17:38:10.488455 (Thread-2): 17:38:10  Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:38:10.490216 (Thread-2): 17:38:10  Opening a new connection, currently in state closed
2022-02-23 17:38:10.691934 (Thread-2): 17:38:10  Writing runtime SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
2022-02-23 17:38:10.707524 (Thread-2): 17:38:10  On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.0.1", "profile_name": "user", "target_name": "default", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */


  create or replace table `dtc-de-339117`.`dbt_orukosueva`.`dm_monthly_zone_revenue`
  
  
  OPTIONS()
  as (
    

with trips_data as (
    select * from `dtc-de-339117`.`dbt_orukosueva`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    --date_trunc('month', pickup_datetime) as revenue_month, 
    date_trunc(pickup_datetime, month) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,
    sum(congestion_surcharge) as revenue_monthly_congestion_surcharge,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_montly_passenger_count,
    avg(trip_distance) as avg_montly_trip_distance

    from trips_data
    group by 1,2,3
  );
  
2022-02-23 17:38:11.904987 (Thread-309): handling poll request
2022-02-23 17:38:11.905397 (Thread-309): 17:38:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b0910>]}
2022-02-23 17:38:11.906217 (Thread-309): sending response (<Response 8036 bytes [200 OK]>) to 10.0.10.60
2022-02-23 17:38:13.931746 (Thread-310): handling poll request
2022-02-23 17:38:13.932110 (Thread-310): 17:38:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c53dcd0>]}
2022-02-23 17:38:13.932585 (Thread-310): sending response (<Response 314 bytes [200 OK]>) to 10.0.6.248
2022-02-23 17:38:14.164122 (Thread-2): 17:38:14  finished collecting timing info
2022-02-23 17:38:14.164585 (Thread-2): 17:38:14  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '423281f4-e6ac-4100-ada8-85f32d3925e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee0021a280>]}
2022-02-23 17:38:14.165133 (Thread-2): 17:38:14  5 of 5 OK created table model dbt_orukosueva.dm_monthly_zone_revenue............ [CREATE TABLE (6.3k rows, 12.2 GB processed) in 3.69s]
2022-02-23 17:38:14.165258 (Thread-2): 17:38:14  Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
2022-02-23 17:38:14.166905 (MainThread): 17:38:14  Acquiring new bigquery connection "master"
2022-02-23 17:38:14.167232 (MainThread): 17:38:14  
2022-02-23 17:38:14.167332 (MainThread): 17:38:14  Finished running 2 view models, 3 table models in 24.79s.
2022-02-23 17:38:14.167412 (MainThread): 17:38:14  Connection 'master' was properly closed.
2022-02-23 17:38:14.167479 (MainThread): 17:38:14  Connection 'model.taxi_rides_ny.dim_zones' was properly closed.
2022-02-23 17:38:14.167541 (MainThread): 17:38:14  Connection 'model.taxi_rides_ny.dm_monthly_zone_revenue' was properly closed.
2022-02-23 17:38:14.167602 (MainThread): 17:38:14  Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
2022-02-23 17:38:14.167661 (MainThread): 17:38:14  Connection 'model.taxi_rides_ny.fact_trips' was properly closed.
2022-02-23 17:38:14.221549 (MainThread): 17:38:14  
2022-02-23 17:38:14.221753 (MainThread): 17:38:14  Completed successfully
2022-02-23 17:38:14.221854 (MainThread): 17:38:14  
2022-02-23 17:38:14.221973 (MainThread): 17:38:14  Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-02-23 17:38:15.924778 (Thread-311): handling poll request
2022-02-23 17:38:15.925140 (Thread-311): 17:38:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c5b05b0>]}
2022-02-23 17:38:15.926816 (Thread-311): sending response (<Response 40479 bytes [200 OK]>) to 10.0.12.68
2022-02-23 17:38:17.339652 (Thread-312): handling status request
2022-02-23 17:38:17.340033 (Thread-312): 17:38:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c58c2b0>]}
2022-02-23 17:38:17.340588 (Thread-312): sending response (<Response 1585 bytes [200 OK]>) to 10.0.7.232
2022-02-23 17:38:17.459271 (Thread-313): handling status request
2022-02-23 17:38:17.459647 (Thread-313): 17:38:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c58c4c0>]}
2022-02-23 17:38:17.460138 (Thread-313): sending response (<Response 1585 bytes [200 OK]>) to 10.0.44.46
2022-02-23 17:41:57.727600 (Thread-314): handling status request
2022-02-23 17:41:57.728001 (Thread-314): 17:41:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c587d30>]}
2022-02-23 17:41:57.728490 (Thread-314): sending response (<Response 1585 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:42:11.901222 (Thread-315): 17:42:11  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-02-23 17:42:11.901460 (Thread-315): 17:42:11  Partial parsing enabled, no changes found, skipping parsing
2022-02-23 17:42:11.907894 (Thread-315): 17:42:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c426fd0>]}
2022-02-23 17:42:12.704287 (Thread-316): handling status request
2022-02-23 17:42:12.704670 (Thread-316): 17:42:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c4eb070>]}
2022-02-23 17:42:12.705156 (Thread-316): sending response (<Response 1244 bytes [200 OK]>) to 10.0.31.140
2022-02-23 17:42:12.805958 (Thread-317): handling status request
2022-02-23 17:42:12.806345 (Thread-317): 17:42:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c4f4df0>]}
2022-02-23 17:42:12.806822 (Thread-317): sending response (<Response 1244 bytes [200 OK]>) to 10.0.38.29
2022-02-23 17:42:44.815107 (Thread-318): handling status request
2022-02-23 17:42:44.815478 (Thread-318): 17:42:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '6d613d21-f568-4f8e-a5f1-6ef896a01cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c6c4f4c10>]}
2022-02-23 17:42:44.815938 (Thread-318): sending response (<Response 1244 bytes [200 OK]>) to 10.0.7.232
